
Непрерывное скелетное представление изображения с контролируемой точностью Леонид Местецкий, Иван Рейер Тверской Государственный Университет Тверь, Россия L.Mest@ru.net Аннотация В работе рассматривается задача "стрижки" непрерывного скелетного представления изображения с контролируемой точностью. Скелет чрезвычайно чувствителен к локальным свойствам границы образа. Поэтому при построении скелетного представления большое внимание уделяется выделению в скелете части, отражающей фундаментальные структурные свойства образа, и удалению элементов, появление которых обусловлено шумовыми эффектами. В основе существующих методов "стрижки" лежат разного рода эвристические правила. Строгое определение "существенной" части скелета в этих методах отсутствует, и оценка точности и адекватности полученного скелетного представления не проводится. В работе предлагается корректный критерий выделения существенных элементов скелета, а также метод, реализующий такое выделение. Метод основан на формализации понятия "фундаментальной" части скелета и выделении в скелете аппроксимирующей изображение многоугольной фигуры "базового" скелета, аппроксимирующего "фундаментальную" часть с заданной точностью. Ключевые слова: растровое изображение, непрерывный скелет, стрижка, базовый скелет. 1. ВВЕДЕНИЕ Математически строгое понятие скелета определено для замкнутой плоской области: это множество тех ее точек, для которых существует не менее двух равноудаленных ближайших точек границы области. Из этого следует, что каждая точка скелета является центром окружности, лежащей в области и касающейся ее границы в двух или более точках (так называемой максимальной пустой окружности). Для того чтобы распространить понятие скелета на дискретные растровые образы, используется другое определение, основанное на метафоре "пожара в прерии" [1]. Предполагается, что по границе области одновременно вспыхивает огонь, который распространяется внутри нее по всем направлениям с постоянной скоростью. Те точки области, в которых сходятся два или более огненных фронта, являются по определению точками скелета. Эквивалентность этих определений, очевидно, следует из того соображения, что точка схода фронтов равноудалена от ближайших точек возгорания на границе. "Пожар в прерии" служит основой для определения и построения скелета в терминах растровых бинарных изображений. Подмножество черных точек растра рассматривается как дискретный образ некоторой замкнутой области, граничные точки растрового пятна - как образ границы области, а непрерывное распространение огня моделируется дискретным процессом последовательного "сжигания" соседних черных точек растра. Процесс построения скелета дискретного образа реализуется в различных алгоритмах "утончения" [2], в алгоритме "дистанционных карт" [3]. Следует отметить, однако, что получаемые при этом дискретные скелеты обладают следующими недостатками. Во-первых, расстояние между точками растра при их построении измеряется не в евклидовой метрике, а в зависимости от используемого понятия 4-или 8-соседства точек растра, в метрике l1 или l?. Это значит, в качестве вписанной в область окружности выступает квадрат. Во-вторых, сам скелет при этом вычисляется неоднозначно и зависит от последовательности анализа граничных точек образа. Другой путь к построению скелета растрового образа состоит в аппроксимации его некоторой "непрерывной" замкнутой областью и построении скелета этой области в соответствии с формальным его определением, данным выше [4]. Полезность понятия скелета давно и хорошо известна, методам вычисления и использования скелетов посвящено огромное количество работ, начиная с первой работы Блама [5]. Однако все, кто так или иначе пытался применить скелеты в практических исследованиях, сталкиваются с проблемой неоднозначности их вычисления и, соответственно, толкования. Действительно, как видно из рассмотренных определений, форма скелета чрезвычайно чувствительна к локальным свойствам границы образа. Особую роль при этом играет кривизна границы. С каждой точкой локального максимума кривизны (в частности с точкой излома) границы, связана отдельная ветвь скелета. Получается, что две области, имеющие несущественные для глаз различия границы, например, за счет шумов, имеют принципиально различные в смысле топологической структуры скелеты. Вместе с тем, сравнительный анализ этих различающихся скелетов показывает, что в них присутствуют общие ветви, которые и определяют фундаментальные свойства структуры образа. Задача состоит в том, чтобы отделить эти существенные элементы скелета от несущественных, определяемых шумовыми эффектами. Решение этой задачи обычно осуществляется путем "стрижки" скелета, т.е. отсечения несущественных ветвей. При этом явные критерии определения существенных и несущественных элементов скелета не формулируются, и отсечение осуществляется на основе эвристических правил [6]. В результате не может быть оценена точность вычисленных скелетов, что затрудняет их дальнейшее использование, например, в задачах распознавания изображений. Целью нашей работы является построение корректного критерия выделения существенных элементов скелета, а также метода, реализующего такое выделение. International Conference Graphicon 2003, Moscow, Russia, http://www.graphicon.ru/
Идея решения этой задачи состоит в следующем. Определим для каждой замкнутой области некоторую ?-окрестность - множество всех замкнутых областей, отличающихся от исходной не больше чем на заданную величину ? в некоторой метрике (используется хаусдорфова метрика [7]). Далее элемент скелета области будем считать существенным, если он присутствует (т.е. имеет близкие элементы) в скелетах всех областей, входящих в эту окрестность. Практический результат, который мы хотим получить - это метод определения существенных элементов в скелете области, составляющих так называемый базовый скелет этой области. Таким образом, мы рассчитываем найти ту скелетную структуру, которая характеризует фундаментальную структуру исходного объекта (изображения), инвариантную относительно способа аппроксимации этого объекта. Метод получения этой информативной части скелета будем называть стрижкой с контролируемой точностью. Получение такого метода даст возможность построения информативного скелета по следующей схеме. 1. Для растрового изображения построить аппроксимирующую замкнутую область. Точность аппроксимации при этом задается (например, равной размеру одного пикселя растрового образа). А вид аппроксимирующей области в этом случае не имеет решающего значения. Проще всего воспользоваться многоугольной фигурой, поскольку для построения ее скелета существуют эффективные алгоритмы [8, 9, 4]. 2. Построить скелет аппроксимирующей области. 3. Провести стрижку скелета с контролируемой точностью c помощью предлагаемого метода. Точность стрижки при этом задать в соответствии с точностью аппроксимации растрового изображения. Работа выполнена при поддержке Российского Фонда фундаментальных исследований (РФФИ), проект 02-01-00667. 2. БАЗОВЫЙ СКЕЛЕТ ПОЛИГОНАЛЬНОЙ ОБЛАСТИ. ЕГО СВОЙСТВА Пусть P - некоторая полигональная область, а ? - некоторое положительное число. Рисунок 1: ?-расширение и ?-сужение полигональной области. Определение 1: Будем называть область ?, имеющую кусочно-гладкую гарницу, ?-близкой области с кусочно-гладкой границей ?', если выполнены следующие условия: 1) хаусдорфово расстояние между областями ? и ?' H(?,?') ? ? 2) хаусдорфово расстояние между границами областей H(??,??') ? ?. Определение 2: ?-коридором области P будем называть замкнутую ?-окрестность границы области. Определение 3: ?-расширением P? + полигональной области P (рис. 1) будем называть объединение P и ?-коридора P. P? + = P U{? ? коридор P} . Рисунок 2: Шип выпуклого угла. Рассмотрим ? i - выпуклый угол полигональной области P. pi - вершина этого угла, Bi - биссектриса этого угла. Рассмотрим a - точку на Bi, удаленную от вершины угла pi на ?, и b - точку пересечения прямых, параллельных сторонам угла и находящихся на расстоянии ? от сторон угла (рис. 2). Определение 4: отрезок ab будем называть шипом i S? выпуклого угла ? i. Определение 5: ?-сужением P? - полигональной области P (рис. 1) будем называть объединение разности области P и ?-коридора P с шипами всех выпуклых углов P. ? ? ?? ? ? ?? = ? ? ? U U ( ) ( \ { коридор }) Conc P P P P S ? ? ? ? , где Conc(P) - множество всех выпуклых углов P. Рисунок 3: Максимальные ?-допустимые круги для полигональной области. International Conference Graphicon 2003, Moscow, Russia, http://www.graphicon.ru/
Определение 6: круг C будем называть ?-допустимым кругом для P, если: 1) H(P, P UC) ? ? ; 2) H(?P,?(P U C)) ? ? Определение 7: круг C будем называть максимальным ?-допустимым кругом для P (рис. 3), если: 1) C является ?-допустимым кругом для P; 2) C не содержится целиком ни в каком другом ?-допустимом для P круге. Справедливы следующие утверждения. Утверждение 1: Если C=(p,r) - максимальный ?-допустимый круг для P, то C'=(p,r-?) - максимальный пустой круг для P. Утверждение 2: Если C=(p,r) - максимальный пустой круг для P, то C'=(p,r+?) - максимальный ?-допустимый круг для P. Следствием этих утверждений является следующая Теорема 1: Множество центров максимальных ?-допустимых кругов для P совпадает со множеством центров максимальных пустых кругов для P. Определение 8: круг C будем называть базовым кругом для полигональной области P, если выполнено следующее: 1) C является максимальным ?-допустимым кругом для P; 2) Пересечение C с P? - не содержится целиком ни в одном максимальном ?-допустимом для P круге, не совпадающем с кругом C. Определение 9: множество центров всех базовых кругов для P будем называть базовым скелетом P и обозначать MAbase(P). Отметим, что согласно Теореме 1 базовый скелет P является подмножеством скелета P. Рисунок 4: К Теореме 2. Рассмотрим C=(p,r) - произвольный базовый круг для P радиуса r с центром в точке p. Как было показано выше, с этим кругом связан круг C'=(p,r-?), который является максимальным для P и касается границы P по крайней мере в двух точках (рис. 4). Пусть круг C' касается границы P в точках A и B. Рассмотрим проходящие через A и B радиусы круга С, pA+ и pB+ . Справедлива следующая Теорема 2: Скелет произвольной ?-близкой P области ? пересекает хотя бы один из радиусов pA+ и pB+. Точка этого пересечения удалена от центра круга p не более чем на ?/cos 2(? /2), где ? - угол между сторонами полигональной области, которых касается круг C'=(p,r-?). Теорема 2 позволяет сделать следующие выводы о свойствах базового скелета. Для каждого ребра базового скелета существует некоторое ? >?, такое, что в ?-окрестности ребра находятся точки скелета любой ?-близкой P области. Кроме того, через ?-окрестность каждого ребра базового скелета для любой ?-близкой P области ? будет проходить ветвь скелета этой области, максимальные пустые круги которой касаются сегментов границы ?, проходящих через ?-окрестности сайтов границы P, бисектором которых является данное ребро. Таким образом, можно говорить, что каждое ребро базового скелета аппроксимирует некоторую ветвь скелета любой ?-близкой P области с точностью ?. Если же взять ?max - максимальное из всех таких ?, то базовый скелет можно рассматривать как аппроксимацию существенной части скелета любой ?-близкой P области с точностью ?max. 3. ПОСТРОЕНИЕ БАЗОВОГО СКЕЛЕТА Теперь рассмотрим, каким образом можно выделить в скелете аппроксимирующей полигональной области базовый скелет. Рисунок 5: Круг C не является базовым. Базовый круг C с центром на бисекторе пары сайтов, образующей выпуклый угол, не должен иметь пересечений с ?-окрестностью вершины угла, то есть должен пересекать соответствующий шип. В противном случае он не был бы базовым, так как нашелся бы другой ?-допустимый для P круг, содержащий пересечение C с P?- (рис. 5). Соответственно, возникает следующая идея построения базового скелета. Выберем одну из терминальных вершин скелета и начнем движение по инцидентному этой вершине ребру вглубь области, "стирая" ребро. При этом мы рассматриваем поведение максимального ?-допустимого круга, центр которого совпадает с точкой скелета, в которой p A A+ C B B+ C' D C International Conference Graphicon 2003, Moscow, Russia, http://www.graphicon.ru/
мы находимся. Если при движении по ребру этот круг пересекает шип соответствующего выпуклого угла, мы прекращаем движение. Такую операцию проведем с каждым терминальным ребром. Остановка происходит и в том случае, если мы дошли до противоположной вершины скелета и стерли ребро целиком, а пересечения с шипом не произошло. При этом степень противоположной вершины понижается и в дальнейшем может стать равной 1. Из такой вершины мы тоже начнем движение, проверяя круг на пересечение уже не с одним шипом, а с двумя. Рисунок 6: Скелет полигональной области. Процедура построения заканчивается, когда в скелете не останется ни одной терминальной вершины, из которой можно начать движение. Оставшиеся ребра образуют базовый скелет (рис. 6-7). Рисунок 7: Базовый скелет полигональной области. 4. ЗАКЛЮЧЕНИЕ Данная работа, в отличие от существующих методов, предоставляет теоретическую основу для "стрижки" скелета с контролируемой точностью. Применение базового скелета в качестве "существенной" части дает практический метод такой "стрижки". Тем самым появляется возможность построения информативного непрерывного скелетного представления для бинарного растрового изображения. При этом непосредственное построение скелета аппроксимирующей полигональной области может быть осуществлено любым из известных методов, а дальнейшая стрижка с контролируемой точностью - с помощью предложенного метода. 5. ЛИТЕРАТУРА [1] U. Montanari. A method for obtaining skeletons using a quasi-Euclidean distance. J. ACM, 15(4), pp. 600-624, 1968. [2] L. Lam, S.-W. Lee, C. Y. Suen. Thinning methodologies: A comprehensive survey. IEEE Trans. PAMI, 14(9), Sept 1992. [3] R. L. Ogniewicz, O. Kubler. Hierachic Voronoi skeletons. Pattern Recognition, 28, pp. 343-359, 1995. [4] Л. М. Местецкий. Непрерывный скелет бинарного растрового изображения. Труды межд. конф. "Графикон-98", Москва, 1998. [5] H. Blum. A transformation for extracting new descriptors of shape. Models for the Perception of Speech and Visual Form, pp. 362--380. MIT Press, 1967. [6] D. Shaked, A. M. Bruckstein. Pruning medial axes. Computer Vision and Image Understanding, Vol. 69, No. 2, 1998, pp. 156-169. [7] А. Н. Колмогоров, С. В. Фомин. Элементы теории функций и функционального анализа. - М.: Наука, 1981. [8] D. G. Kirkpatrik. Efficient computation of continuous skeletons. In 20th Annu. Symp. Found. Computer Sci., pp. 18-27, 1979. [9] D. T. Lee Medial axis transformation of a planar shape. IEEE Trans. PAMI, PAMI-4, No. 4, Jul 1982. Авторы Местецкий Леонид Моисеевич - зав. кафедрой информационных систем и технологий ТвГУ E-mail: L.Mest@ru.net Рейер Иван Александрович - аспирант ВЦ РАН. E-mail: reyer@forecsys.ru Abstract In the paper the problem of construction of continuous skeletal representation of an image is considered. The skeleton is extremely sensitive to local features of the image outline. Therefore at construction of skeletal representation particular attention is paid to allocation of skeletal part presenting fundamental structural features of an image and removal of elements caused by noise. Existing methods of such "pruning" use heuristic rules of various sorts. There is no strict definition of the "fundamental" part of a skeleton in these methods and estimation of accuracy and adequacy of the obtained skeletal representation is also not carried out. We suggest correct criterion for identification of essential elements of a skeleton and a method realizing such identification. The method is based on formalization of concept of the "fundamental" skeleton part and allocation of the "base skeleton" approximating the "fundamental" part with given accuracy in the skeleton of a polygonal figure approximating the image. Keywords: raster image, continuous skeleton, pruning, base skeleton. International Conference Graphicon 2003, Moscow, Russia, http://www.graphicon.ru/