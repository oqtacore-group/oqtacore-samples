
ТРИАНГУЛЯЦИЯ ДЕЛОНЕ: РЕКУРСИЯ БЕЗ ПРОСТРАНСТВЕННОГО РАЗДЕЛЕНИЯ ТОЧЕК Местецкий Л.М., Царик Е.В. Тверской государственный университет Тверь, Россия l.mest@ru.net tsarik_elena@mail.ru Реферат Рассматривается метод построения триангуляции Делоне конечного множества точек на плоскости с использованием алгоритма слияния пространственно неразделенных триангуляций Делоне его подмножеств. Традиционные методы построения триангуляции Делоне, использующие пространственное разбиение работают неустойчиво из-за образования вырожденных треугольников на промежуточных этапах рекурсии. Предлагаемое решение позволяет существенно снизить число вырожденных треугольников. Проведенные эксперименты показывают, что общее число вырожденных треугольников сокращается на два порядка, для множеств из 10000 точек. При этом вычислительная эффективность алгоритма составляет O(n log n) в худшем случае. Ключевые слова: триангуляция Делоне, слияние триангуляций, неразделенные триангуляции. 1. ВВЕДЕНИЕ Триангуляция Делоне (ТД) на плоскости представляет собой геометрическую конструкцию, чрезвычайно популярную в компьютерной графике, обработке и анализе изображений, геоинформационных технологиях, кристаллографии, вычислительной геометрии. Методам построения ТД посвящено много работ (см. например, обзор [1]). Известна оценка O(n log n) для худшего случая вычислительной сложности задачи построения ТД n точек [1,2,3]. Существует несколько эффективных алгоритмов, реализующих эту оценку, основанных на алгоритмической парадигме "разделяй и властвуй". Алгоритмы используют идею пространственного разделения исходного множества точек некоторой прямой линией (обычно вертикальной или горизонтальной) на два подмножества приблизительно равной мощности. Далее для этих подмножеств рекурсивно строятся триангуляции Делоне, которые затем "сшиваются" в одну триангуляцию [2]. При таком подходе в триангуляциях подмножеств появляется большое число "почти вырожденных" тупоугольных треугольников, вытянутых вдоль разделяющей прямой, в которых один из углов имеет величину, близкую к 1800. Как показывают эксперименты, доля треугольников с углом больше 1790, при n∼103÷104 составляет до 1-2% общего числа треугольников. Появление таких треугольников существенно снижает надежность алгоритмов при решении практических задачах большой размерности (см. [1]). Предлагаемое в настоящей статье решение задачи основывается на другом принципе разделения исходного множества точек, позволяющем существенно уменьшить число вырожденных треугольников. Данная работа выполнена при поддержке Российского фонда фундаментальных исследований (грант 02-01-00667) 2. ТРИАНГУЛЯЦИЯ ДЕЛОНЕ Пусть на евклидовой плоскости задано S - множество из n ≥ 3 точек, не все из которых лежат на одной прямой. Триангуляцией конечного множества точек S называется плоский прямолинейный граф с вершинами из S, имеющий наибольшее возможное число ребер. Окружность называется пустой, если она не содержит внутри себя вершин триангуляции. Несобственная пустая окружность - это прямая линия, по одну сторону от которой нет вершин триангуляции. Окружность, проходящая через вершину, называется инцидентной этой вершине. Ребро триангуляции, концевые вершины которого имеют общую пустую инцидентную окружность, называется ребром Делоне. Грань триангуляции, у которой вершины имеют общую пустую инцидентную окружность, называется гранью Делоне. Триангуляцией Делоне конечного множества точек называется такая триангуляция, у которой все ее грани являются гранями Делоне. Другое эквивалентное определение - это триангуляция, у которой все ребра являются ребрами Делоне. 3. РЕКУРСИЯ С ПРОСТРАНСТВЕННЫМ РАЗДЕЛЕНИЕМ ТОЧЕК Эффективные алгоритмы построения ТД, имеющие сложность O(n log n) основываются на алгоритмической парадигме рекурсивной декомпозиции (разделяй и властвуй) [3]: разделении исходного множества точек на два подмножества, рекурсивном построении триангуляций этих подмножеств и слиянии полученных таким образом разделенных триангуляций (рис.1). Рекурсия прекращается при разбиении всего множества на достаточно маленькие части (из 2 или 3 точек), триангуляции которых строятся непосредственно. Все известные алгоритмы слияния предполагают разбиение исходного множества точек на пространственно разделенные подмножества, т.е. разделенные прямыми линиями, например, вертикалью или горизонталью [1]. Эффективность O(n log n) при этом достигается за счет того, что слияние двух разделенных триангуляций может быть выполнено за время O(n). Недостаток таких алгоритмов, который проявляется лишь при больших n, состоит в следующем: вдоль разделяющей прямой образуются многочисленные треугольники с "очень тупыми" углами, т.е. близкими к 180о (рис.1b). Появление таких треугольников является причиной неустойчивости в International Conference Graphicon 2004, Moscow, Russia, http://www.graphicon.ru/
работе алгоритмов из-за неизбежных ошибок вычисления тригонометрических функций этих углов. Предлагаемое нами решение также основано на идее рекурсивного построения ТД, но с использованием не пространственного, а другого принципа разделения исходного множества. В рамках предлагаемого подхода сам принцип разделения может выбираться достаточно произвольно. Становится возможным поиск такого разделения, при котором будет минимизировано число вырожденных треугольников. 4. СЛИЯНИЕ НЕРАЗДЕЛЕННЫХ ТРИАНГУЛЯЦИЙ ДЕЛОНЕ В основе предлагаемого подхода лежит идея слияния двух ТД, для которых допускается пересечение их выпуклых оболочек и полное "перемешивание" их вершин. Такие триангуляции мы будем называть неразделенными. Задача слияния двух неразделенных ТД ставится следующим образом (рис.2). Даны два конечных множества точек B и W и их ТД Del(B) и Del(W). Нужно построить ТД Del(B∪W), которая представляет собой объединение двух линейно неразделенных триангуляций Del(B) и Del(W). (a) Как это принято будем называть точки исходного множества S сайтами. Предположим также для удобства, что сайты раскрашены в два цвета: точки множества B - черные, а множества W - белые. Пучком сайта V∈S назовем множество ребер триангуляции (V,Vi), i=1,.,k, инцидентных сайту V. Следуя [2], будем представлять пучок структурой данных в виде двунаправленного циклического списка сайтов V1,.Vk, смежных с V в триангуляции. Функция V.pred(Vi) обозначает сайт, следующий за Vi в направлении по часовой стрелке, а функция V.succ(Vi) - против часовой стрелки относительно V. 4.1 Общая структура алгоритма В объединенной ТД имеются ребра двух типов: одноцветные и разноцветные, в зависимости от цвета сайтов, которые эти ребра соединяют. Одноцветные ребра - это ребра, переходящие в Del(B∪W) из Del(B) и Del(W), а разноцветные - новые ребра, которых не было в Del(B) и Del(W). (б) В триангуляции будем различать два типа связности ее элементов. Множество вершин и ребер называется связным, если для любой пары входящих в него вершин существует соединяющая цепь из попарно инцидентных вершин и ребер. Множество ребер и граней называется связным, если для любой пары входящих в него элементов существует соединяющая цепочка из попарно инцидентных ребер и граней. В объединенной триангуляции Del(B∪W) определены одноцветные компоненты - максимальные связные подмножества вершин и ребер одного цвета, которые мы будем называть лоскутами. Эти компоненты без изменения переходят в Del(B∪W) из Del(B) и Del(W). Остальные ребра и грани исходных триангуляций, не вошедшие в лоскуты, должны быть разрушены. Максимальные связные подмножества одноцветных ребер и граней исходных триангуляций, не вошедших в объединенную триангуляцию, будем называть разрезами. В результате разрушения граней для некоторых оставшихся ребер исходных ТД число инцидентных граней становится меньше двух, т.е. эти ребра становятся открытыми. Связная цепочка вершин и открытых ребер называется краем. Каждый край состоит из ребер одного цвета. (в) Рис. 1: Рекурсивное построение триангуляцииДелоне на основе пространственного разделенияточек (а - линейное разделение исходногомножества точек, б - рекурсивное построениетриангуляций подмножеств, в - объединениеразделенных триангуляций). Процесс формирования Del(B∪W) можно рассматривать, как построение разрезов и выделение лоскутов в Del(B) и Del(W) и "сшивание" лоскутов с помощью разноцветных ребер и International Conference Graphicon 2004, Moscow, Russia, http://www.graphicon.ru/
граней. Максимальные связные подмножества разноцветных ребер и граней объединенной триангуляции будем называть швами. При такой метафоре оправдано называть разноцветные ребра стежками. Легко видеть, что каждый стежок имеет в объединенной триангуляции не более двух инцидентных разноцветных граней и каждая разноцветная грань имеет два инцидентных стежка. Отсюда следует, что шов - это связная цепочка разноцветных ребер и граней. Таким образом, рассмотренные свойства лоскутов, разрезов и швов позволяют организовать процесс объединения исходных триангуляций в виде последовательного построения разрезов, выделения краев и построения швов между разноцветными краями. Этот процесс начинается, когда краев два, а завершится, когда число краев станет равным единице. Шов может быть разомкнутым или циклическим (рис.3). В разомкнутом шве существуют два стежка, являющиеся граничными ребрами Del(B∪W), т.е. ребрами выпуклой оболочки Conv(B∪W). В циклическом шве все стежки являются внутренними ребрами Del(B∪W). Поскольку и разрезы, и швы представляют собой связные множества ребер и граней, процесс построения каждого разреза и шва включает два этапа: поиск первого элемента (ребра или грани), принадлежащего этому разрезу или шву, а затем последовательное присоединение остальных элементов. Будем называть пару сайтов, с которой начинается построение разреза и шва, стартером. Стартер - это разноцветная пара сайтов, образующая ребро Делоне, которое еще не включено в объединенную триангуляцию. Стартер инициализирует оба процесса: разрезания и сшивания: он разрушает грани и ребра исходных триангуляций, что дает начало разреза, и образует первый стежок, от которого начинается шов. Рис. 2: Исходные неразделенные (вверху) иобъединенная (внизу) триангуляции Делоне Построение смежных стежков для стартера можно вести в двух направлениях: по одну или по другую сторону от него. Для того чтобы различать эти направления, условимся, что стежок имеет левый и правый сайты, а поиск очередного смежного стежка осуществляется в направлении перед ним (рис.3). Для разомкнутого шва процесс поиска смежных стежков, начавшись от стартера, выявит часть цепочки по одну сторону от стартера. Затем нужно вернуться к стартеру, "развернуть" его, т.е. переопределить в нем левый и правый сайты и построить вторую половину цепочки. Для циклического шва последовательное построение смежных стежков приведет к замыканию цепочки, т.е. к присоединению шва к стартеру с другой стороны (шов 2 на рис.3). Процессы разрезания и сшивания триангуляций не обязательно должны быть устроены строго последовательно. В предлагаемом алгоритме они идут одновременно по мере построения новых стежков: очередной стежок используется для увеличения разреза и расширения краев и тут же осуществляется локальная сшивка этих краев, приводящая, в свою очередь, к образованию нового стежка. Алгоритм включает в себя процедуры поиска начального стартера, построения разреза и шва и поиска очередного стартера: Шов 3 Шов 1 Шов 4 Шов 2 Рис.3: Лоскуты и швы в объединеннойтриангуляции (циклический шов 2 и разомкнутыешвы 1, 3, 4). Пунктир - стежки, двойной пунктир- стартеры, стрелки - направления швов. 1). Найти начальный стартер; 2). Построить разрез и шов от найденного стартера; 3). Провести поиск очередного стартера; 4). Если очередной стартер найден, то перейти к 1, иначе закончить. 5. ВЫЧИСЛИТЕЛЬНЫЙ ЭКСПЕРИМЕНТ Алгоритм реализован в среде Delphi и проверен на практических задачах средней размерности (n ∼ 104). Для оценки предложенного подхода была поставлена серия вычислительных экспериментов по построению триангуляций Делоне средней размерности (500÷10000 точек). Общий массив точек получен путем случайного выбора в круге с равномерным распределением вероятности. При рекурсивном построении триангуляции использовались International Conference Graphicon 2004, Moscow, Russia, http://www.graphicon.ru/
4 различных способа разбиения множества точек на две части. В первых двух способах выполнена лексикографическая сортировка точек по координатам (x,y). В третьем способе точки отсортированы лексикографически в двух отдельных массивах - по (x,y) (горизонтальное упорядочение) и по (y,x) (вертикальное упорядочение). В четвертом способе сортировка не проводилась. Способ I. Упорядоченный массив разбивается на две равные части. Первая половина массива - черные точки, вторая - белые. Этот способ эквивалентен традиционному пространственному разделению множества точек вертикальной прямой. Способ II. В упорядоченном массиве точки с нечетными номерами объявляются черными, а с четными - белыми. Способ III. Отбираются две крайние (первая и последняя) точки сначала из "горизонтального" массива и две из "вертикального" и объявляются черными. Затем из оставшихся таким же образом выбираются четыре точки, которые объявляются белыми. Далее снова четыре черные и т.д. Способ IV. Неупорядоченный массив точек делится пополам. Первая половина массива - черные точки, вторая - белые. Получается чисто случайное разбиение. Для каждого алгоритма оценивалось количество образующихся в процессе рекурсивного построения триангуляций Делоне "плохих" треугольников относительно их общего числа. Плохими считались треугольники, имеющие угол больше 1790 . Результаты экспериментов приведены в таблице. Таблица. Доля треугольников с углами большими 1790. Способ разделения точек при рекурсии Число точек (n) I II III IV 500 0,55% 0,14% 0,05% 0,019% 1000 0,78% 0,35% 0,05% 0,020% 2000 1,22% 0,58% 0,12% 0,021% 5000 1,96% 1,10% 0,22% 0,017% 10000 2,43% 1,57% 0,35% 0,014% Как видно из таблицы, все три варианта построения с неразделенными триангуляциями (способы II-IV) дают существенно лучший результат (на 1-2 порядка), чем традиционный способ с пространственным разделением. При этом изощренные способы разделения точек (II и III) оказались хуже, чем простой случайный выбор цвета точек. 6. ЗАКЛЮЧЕНИЕ Проведенное исследование показывает, что пространственное разделение множества точек прямой линией является необязательным при рекурсивном построении триангуляции Делоне. Использование предложенного алгоритма рекурсивного слияния неразделенных триангуляций Делоне позволяет существенно снизить долю вырожденных треугольников в промежуточных триангуляциях. Общее число плохих треугольников с углами, близкими к 1800 сокращается на два порядка для задач размерности 1000-10000. Это позволяет предположить, что предложенный алгоритм более устойчив по сравнению с традиционными алгоритмами, использующими пространственное разделение точек. Заметим, что этот результат получен без снижения вычислительной эффективности, поскольку асимптотическая сложность предложенного алгоритма составляет O(n log n) в худшем случае. Эксперименты показали, что выбор способа разделения исходного множества точек при рекурсивном построении триангуляции также влияет на качество получаемых промежуточных триангуляций. Поэтому задача построения оптимальных в различном смысле разбиений исходного множества точек вполне правомерна и ждет своего исследования. 7. ЛИТЕРАТУРА [1] Скворцов А.В. Обзор алгоритмов построения триангуляции Делоне //Вычислительные методы и программирование. 2002. Т.3.. [2] Lee D.T., Schachter B.J. Two algorithms for constructing a Delaunay triangulation //International Journal of Computer and Information Science. 1980. V.9. № 3. P. 219-242. [3] Препарата Ф., Шеймос М. Вычислительная геометрия: введение //M.: Мир, Москва, 1989. [4] Kirkpatrick D.G. Efficient computation of continuous skeletons //Proceedings of the 20th Annual IEEE Symposium on FOCS. 1979. P. 18-27. DELAUNAY TRIANGULATION: RECOURSION WITHOUT SPATIAL SEPARATION Leonid Mestetskiy, Elena Tsarik Abstract We consider Delaunay triangulation design method with the use of special divide algorithm, its subsets. Traditional Delaunay triangulation merging technics methods which use spatial division, narrow angle triangle appearance on the stage of recursion. Our method solves this problem by set of points division control. Experiments shows, that number of degenerated triangles decreases to about 100-150 times for 10000 points. In the worst case the estimation computing complexity of the algorithm is O(n log n). Keywords: Delaunay triangulation, merging of triangulation, nonspatial-separated triangulations. Авторы Местецкий Леонид Моисеевич - доктор технических наук, профессор кафедры информационных систем и технологий Тверского государственного университета. Царик Елена Владимировна - студентка магистратуры кафедры информационных систем и технологий Тверского государственного университета. International Conference Graphicon 2004, Moscow, Russia, http://www.graphicon.ru/