
Statistical Inference for Stochastic Processes 5: 199-228, 2002. c 2002 Kluwer Academic Publishers. Printed in the Netherlands. 199 Rates in the Empirical Central Limit Theorem for Stationary Weakly Dependent Random Fields PAUL DOUKHAN1 and GABRIEL LANG2 1University Cergy Pontoise, UPRES A 8088 Mathematics, Dept. of Economy 33 Bd. du Port, 95011, Cergy-Pontoise Cedex, France. e-mail: doukhan@ensae.fr 2GRESE, ENGREF, 19 av du Maine 75732 Paris Cedex 15, France. e-mail: lang@engre.fr Abstract. A weak dependence condition is derived as the natural generalization to random fields on notions developed in Doukhan and Louhichi (1999). Examples of such weakly dependent fields are defined. In the context of a weak dependence coefficient series with arithmetic or geometric decay, we give explicit bounds in Prohorov metric for the convergence in the empirical central limit theorem. For random fields indexed by Zd , in the geometric decay case, rates have the form n?1/(8d+24)L(n), where L(n) is a power of log(n). AMS 1991 Subject Classification: 60F05, 60F17, 60G10, 60G60, 62E20. Key words: stationary sequences, inequalities, Rosenthal inequality, positive dependence, mixing, central limit theorem. 1. Introduction We propose a new weak dependence condition for random fields, extending on Doukhan and Louhichi (1999), who considered the case of time series. This definition makes explicit the asymptotic independence of finite-dimensional distributions with separated index sets (see :2 for formal definitions); the convergence is not assumed to hold uniformly on the dimension of the distributions involved. As a special case of such a definition, Rosenblatt (1956) introduced strong mixing conditions but such conditions refer rather to ? -algebras than to random variables. A difficulty of mixing is that checking for it is usually hard (see e.g. Doukhan, 1994). Also, recall an important property of associated random variables: non correlation implies independence (see e.g. Newman, 1984); the only alternative frame for this to hold is the Gaussian one. This means that one may hope that dependence will appear in this case only through the covariance structure of the initial process. This also justifies the study of such Gaussian or associated processes: indeed their covariance is much easier to compute than a mixing coefficient sequence. Weak dependence of random fields unifies those radically distinct dependent behaviours.
200 PAUL DOUKHAN AND GABRIEL LANG For i.i.d sequences, this empirical repartition function Fn relative to an n-sample with repartition function F satisfies vn (Fn(x) ? F(x)) D ?>n>? X(x), where X(x)=B(F(x)) for some Brownian bridge (B(t))t?[0,1]. For weakly dependent sequences, the limiting process X(x) is more complicated; it is still a centered Gaussian process but its covariance writes cov(X(x),X(y)) = [F(x) ? F(y) ? F(x)F(y)] +t =0 cov(1?0 x, 1?t y ), where the additional sum is easily proved to be quite a regular function of (x, y). In this paper, we extend on a previous result by Doukhan and Portal (1983, see also 1987) which provides explicit convergence rates n?? in the empirical CLT for strongly mixing sequences. The rate depends here on the weak dependence sequence (?r )r>0 defined below in definition 1 (e.g. ? = ?(a) if ?r = O(n?a)). We include association, Gaussian sequences and Bernoulli shifts. Methods are essentially those from Doukhan and Portal (1983), using extension of the tools provided in Doukhan and Louhichi (1999). After perhaps redefining those processes on different probability spaces, it is possible to construct a sequence of processes X(n)(x) with same distribution as X(x) and such that sup x vn (Fn(x) ? F(x)) ? X(n)(x)= O(n?? ) a.s. The empirical repartition function is decisive for statistics. First, this yields an unbiased estimator of the repartition function of a stationary process. This result may be used to study the convergence of Kolmogorov-Smirnov statistic sup x vn |Fn(x) ? F(x)| D ?> sup x |X(x)| as n>?. The computation of the levels of tests based on this statistic is discussed after the main result. Another application of such limit theorems concerns the functional estimation; a kernel density estimate fn,hn may be built on a sample of the random field. Recall that under suitable assumptions on the random field and on the window width h ? hn, one proves that finite dimensional repartitions of the estimation process Zn(x) = vnhn(fn,hn(x) ? Efn,hn(x)) converge to Gaussian vectors with independent marginals (Doukhan and Louhichi, 1998). In particular such results imply the divergence of this estimation process in the space C of continuous functions. Using the previous rate result in such an empirical CLT allows to approximate the estimation process by a sequence of Gaussian processes in a sense which is made precise after the statement of the main result.
EMPIRICAL CENTRAL LIMIT THEOREM 201 2. Weak Dependence of a Spatial Process 2.1. DEFINITIONS Define the Lipschitz modulus of a real function h on a space Rn as Lip (h) = supx=y |h(x) ? h(y)| ||x ? y||1 , where ||(x1, . . . , xn)||1 = ni=1 |xi |. Define L as the set of functions that are bounded by 1 and have a finite Lipschitz modulus. We consider a real process ? defined over T = Zd . We say that i = (i1, . . . , iu) and j = (j1, . . . , jv) are r-distant if min(||(is?jt ||1, s = 1, . . . , u, t = 1, . . . , v) = r. Let ? = (?r )r 0 be a real positive sequence tending to zero. Let f and g be two functions of L defined on Ru and Rv, respectively. Let (?w)w=1,2 be the functions defined on L2 ? N2 by ?1(f, g, u, v) = (u + v)(Lip (f ) ? Lip (g)), ?2(f, g, u, v) = (u + v)2Lip (f )Lip (g). DEFINITION 1. We say that ? is (?,L,?w)-dependent if for any r-distant finite sequences i = (i1, . . . , iu) and j = (j1, . . . , jv), for any functions f and g of L, defined on Ru and Rv: |cov(f (?i1, . . . , ?iu ), g(?j1, . . . , ?jv ))|?w(f, g, u, v)?r . (1) Note that if ? is (?,L,?w)-dependent and if f and g are only bounded Lipschitz function, this covariance is bounded by f ?g??w(f, g, u, v)?r . 2.2. EXAMPLES All the examples in this section are defined with respect to a centered unit variance i.i.d field (?i )i?T . 2.2.1. Linear fields Define (?i)i?T as ?i =k bk?i?k , (2) where the series bk is square summable. Then ? is (?,L,?1)-dependent, where ?2 2r = k1>r b2k . (3) 2.2.1.1. Markovian fields. As a special case, we present the well-known example of linear Markovian fields (e.g. the four neighbours model). For v ? T, define
202 PAUL DOUKHAN AND GABRIEL LANG a shift operator Bv in the fields on T as (Bv.? )t = ?t?v; consider a finite sequence of reals (aj )(j=1,...,D) and a finite sequence (vj )(j=1,...,D) of elements of T . A Markovian field is defined by the neighbour regression formula: ?i =D j=1 aj ?i?vj + ?i = (A.? )i + ?i , (4) where A=Dj=1 ajBvj . Assume that a = Dj=1 |aj |<1, then there exists a stationary solution to (4) in L1: ?i = ?p=0(Ap.?)i = ?p=0 0j1,...,jD j1+---+jD=p p! j1! - - - jD!aj1 1 - - - ajD D ?i?(j1v1+---+jDvD). It is enough to notice that 0j1,...,jD j1+---+jD=p p! j1! - - - jD! |aj1 1 - - - ajD D | = ap, so that the process has the representation (2) with absolutely summable coefficients: ?i =k bk?i?k . Now, we prove that the series (bk) is also square summable. By definition, |bk |p (j1,...,jD)?Vk,p p! j1! - - - jD! |aj1 1 - - - ajD D |, where Vk,p = {(j1, . . . , jD) ? IND, j1+- - -+jD = p, j1v1+- - -+jDvD = k}. Denote v = max(v1?, . . . , vD?). Note that Vk,p is empty if p < k?/v. Then |bk|(1?a)?1ak?/v, so that (bk) is square summable and the weak dependence property follows from (3). 2.2.2. Chaotic Volterra fields The linear field may be generalised to sums of fields of any polynomial order. Assume that (?i)i?T has finite moments of any order. Define (?i)i?T as ?i = ?s=1 ? (s) i , where ? (s) i = j1,...,js?T a(s) j1,...,js?i?j1 - - - ?i?js .
EMPIRICAL CENTRAL LIMIT THEOREM 203 The real series a(s) j1,...,js are absolutely summable. These fields are (?,L,?1)-dependent where ?2r ?s=1s l=1 jl1 > r j1, . . . , js ? T a(s) j1,...,js E |?0|s . Note: if the field is causal, that is, if the indices jl are taken in Nd , then the bound holds for ?r . 2.2.2.1. Definition in L2. If the coefficients a(s) satisfy a(s) j1,...,js = 0 if any two of the indices are equal, we may define the preceding field in L2, only assuming that the field ? has a finite variance. 2.2.2.2. ARCH(?)?fields. As an example of the chaotic Volterra fields, ARCH (?)?fields are generalised from Giraitis et al. (preprint): given a positive a ? R, a nonnegative sequence (bj )j?T + ? R and an i.i.d nonnegative random field (?j )j?T + for T + = Nd \ {0}, we define ? through the recurrence relation ?i = ??a + j?T + bj ?i?j???i . Under the simple assumption that c=E(?0)j?T + bj <1, such models are proved to have a stationary representation with the chaotic expansion ?i = a?i + a ?2=1 ? 2 i , where ? 2 i = j1?T + - - - j2?T + bj1 - - - bj2?i?j1 - - - ?i?(j1+---+j2). The convergence of the series over 2 comes from E|? 2 i |cl. Define ? L,m i = a?i + a L l=1 j1?[0,m]d - - - j2?[0,m]d bj1 - - - bj2?i?j1 - - - ?i?(j1+---+j2). This field is an approximation of ? , such that E|?i ? ? L,m i |2>L c2 + ?(m), where ?(m) = j ?[0,m]d |bj |. Then we use the relation: |cov(f (?i1, . . . , ?iu ), g(?j1, . . . , ?jv ))| (uLip (f ) + vLip (g))E|?0 ? ? L,m 0 | + +|cov(f (? L,m i1 , . . . , ?L,m iu ), g(? L,m j1 , . . . , ?L,m jv ))|.
204 PAUL DOUKHAN AND GABRIEL LANG If (i1, . . . , iu) and (j1, . . . , jv) are r-distant and if Lmr, the last covariance is zero, because ? L,m is Lm-dependent. Then ? is (?,L,?1)-dependent, with ?r = minLmr(cL+1/1 ? c + ?(m)). For example, for standard ARCH models with delay p (i.e. bj = 0 if j > p), this yields ?r = cr/p/1 ? c. In the arithmetic decay case, bj = C|j |?a, ?r = const. r log r 1?a. In the geometric case, bj = Ce?b|j |, one obtains ?r = const.? vr for ? = e?v?b log c. 2.2.3. Bernoulli shifts More generally, we consider a function H from IRT to IR and define (?i)i?T as ?i = H((?j?i)j?T ). In order to check the weak dependence properties of such random fields, note that ?i,r = H((?j?i )j1 r ) satisfies ?s = E|?i,s ? ?i | does not depend on i. If f , g, i and j are as in definition 1, then ?i,s = (?i1,s, . . . , ?iu,s) and ?j,s are independent if 2s < r. Define also ?i = (?i1, . . . , ?iu), then cov(f (?i), g(?j)) = cov(f (?i) ? f (?i,s), g(?j)) + cov(f (?i,s), g(?j) ? g(?j,s)). Hence|cov(f (?i), g(?j))| g?E|f (?i) ? f (?i,s| + f ?E|g(?j) ? g(?j,s)| (5) Lip fu t=1 E|?it ,s ? ?it| + Lip g v t=1 E|?jt ,s ? ?jt | (6) (vLip f + uLip g)?s . (7) We thus conclude that this random field is (?,L,?1)-dependent with ?r = ?r/2?1. Note also that if T = Z and the random field is causal ?i = H((?i?j )j 0) then ?i and ?j,r?1 are independent thus weak dependence holds with ?r = ?r?1 and the weak dependence function takes the simpler form ? = vLip g. In this case, we do not need g to be bounded by 1. In the general shift case, for functions f and g not bounded by 1, one has to multiply the function ?1 by the factor f ? +g? (and not by the product of these terms). 2.2.4. Associated random field Associated fields are proved to be (?,L,?2)-dependent, with ?r = j1>r cov (?0, ?j ) (see Doukhan and Louhichi (1999)). 2.2.5. Compound weakly dependent fields New weakly dependent fields may be derived, substituting weak dependent fields to the independent noise ?:
EMPIRICAL CENTRAL LIMIT THEOREM 205 : the sum of p mutually independent weakly dependent fields is weakly dependent with a sequence ? that is the sum of the respective sequences of the fields. : more generally, one may replace the preceding sum by a Lipschitz function h, to generate a weakly dependent random field. : a weakly dependent field may be defined by formula (2) with respect to a weakly dependent field ?. 2.2.6. A non trivial example of non-mixing weakly dependent linear field Consider two independent i.i.d Bernoulli sequences (?i)i?T and (?j )j?T with the same parameter p = 1/2. Define (Ui)i?T and (Vj )j?T as Ui = k0 2?k?i?k , Vj = k0 2?k?j?k. Then Ui and Vj are two uniform processes that are weakly dependent (Doukhan and Louhichi, 1999) and non-mixing (because V0 is a deterministic function of Vj for any j >0). We consider the random field ?i,j = UiVj . Note that ?i,j is a stationary linear field with respect to the innovation ?i?j . Define ?r = k+l>r,k0,l0 4?(k+l)1/2. An easy computation shows that ?r v2r2?r and (3) gives that ? is (?,L,?1)-dependent, where ?r = vr2?r/2. Let us show that this field is non mixing. Define the events A0 = {?0,0 1/2} and Bn = {?0,n1/2}. Then P(A0) = P(Bn) = P(U0 1/2) + P(U0 > 1/2, V0 (2U0)?1) = 1/2 + 1 1/2(2u)?1du = (1 + log(2))/2, P(A0 ? Bn) = P(U0 1/2) + +P(U0 > 1/2, V0 (2U0)?1, Vn (2U0)?1). Recall that Vn = Dn + 2?nV0, where Dn = 0ln?1 2?l?j?l . Note that Dn = kn2?n, where kn is a discrete random variable equidistributed over {0, 1, . . . , 2n?1} and independent of V0. Then {Dn 1/(2U0) ? 2?n} ? {Vn 1/(2U0)}, so that P(A0 ? Bn) 1/2 + P(U0 > 1/2, V0 (2U0)?1,Dn (2U0)?1 ? 2?n) 1/2 + 1 1/2 P(V0 (2u)?1)(P(Dn (2u)?1) ? 2?n) du 1/2 + 1 1/2(2u)?1((2u)?1 ? 21?n) du 1/2 + 1 1/2(2u)?2 du ? 21?n 3/4 ? 21?n.
206 PAUL DOUKHAN AND GABRIEL LANG We conclude that P(A0 ? Bn) ? P(A0)P(Bn)(3 ? (1 + log(2))2)/4 ? 21?n and does not converge to zero as n tends to infinity. The events A0 and Bn are not asymptotically independent so that the field (?i)i?T is not mixing. 2.2.7. Weakly dependent processes As in paragraph 2.2.5, it is possible to define weakly dependent fields generalizing the weakly dependent processes of Doukhan and Louhichi (1999), namely: : Markovian Lipschitz processes (Dufflo, 1990) that are (?,L,?1)-dependent (Doukhan and Louhichi, 1999); the sequence ?r decays geometrically. : Instantaneous functions of Gaussian processes, that are (?,L,?2)-dependent. The function of Lare not only Lipschitz, but have bounded derivatives. : Bilinear processes, defined in Tong (1981): ?i = (a + b?i?1)?i?1 + ?i . 3. Main Result We recall the definition of the empirical process for real valued fields. DEFINITION2. For N in N, let BN be the closed ball of radius N for the 2?-norm on T = Zd and n = #BN = (2N + 1)d. Let (?t )t?T be a real valued random field. We consider the empirical process Fn(t) = 1n k?BN 1?k t and we define Xn(t) = vn(Fn(t) ? F(t)). For the sake of simplicity, we shall assume that the process takes its values in [0, 1]. This may be achieve by using the quantile transform. NOTATIONS. Let (S, | - |S) be the space of c`adl`ag functions D([0, 1]) with the Skorohod metric. Let ? denote the Prohorov distance between distribution functions on (S, | - |S). If X and Y are two processes on S, we also denote ?(X, Y) the Prohorov distance between their distributions. Denote gs,t(u) = 1s<ut ? F(t) + F(s) the interval counting functions. For a sequence k = (k1, . . . , kq) of elements of T , define ?k = (?k1, . . . , ?kq ) and when s and t are fixed, =k = qi=1 gs,t (?ki ). Denote xi (t) = g0,t (?i). Assume that the density of the variable ?i is bounded by C? . 3.1. CENTRAL LIMIT THEOREM FOR THE EMPIRICAL PROCESS THEOREM 1. Let w = 1 or 2. Assume that (?n)n?T is a centered and (?,L,?w)-dependent process. Assume that the density of the variable ?i is bounded by C?. Let
EMPIRICAL CENTRAL LIMIT THEOREM 207 X(t) be the centered normal process with variance >s,t = j?T cov(x0(s), xj (t)). Define ?w,r = 2(4C? )w/w+1?1/(w+1) r . Arithmetic decay. Assume that there exist C > 0 and a > 3d such that ?w,r Cr?a, then ?(Xn,X) = O(n??wlog(n)?w), where?1 = (a ? 3d/2)(1 ? 2? )/v1, ?1 = (2ad + 6a ? 3d)(1 ? 2? )/v1, ?2 = (a ? 2d)(1 ? 2? )/v2, ?2 = (ad + 3a ? d/2)(1 ? 2? )/v2, for ? = (d2+2ad +2a ?d)/2(a2 +2ad +a), v1 = 8ad +24a +12d ?? (6ad + 16a + 8d) and v2 = 8ad + 24a ? 10d/3 ? ? (6ad + 16a ? 8d/3). Geometric decay. Assume that there existC > 0 andb > 0 such that ?w,r Ce?br , then ?(Xn,X) = O(n??0log(n)??0 ), where?0 = 1 8d + 24, ?0 = 10d2 + 39d + 28 8d + 24 . Note that 0 < ? 1/3 and that ? tends to zero when a tends to infinity, so that ?w tends to ?0. Remark: test of Kolmogorov & Smirnov. This provides a way to study the Kolmogorov-Smirnov statistic and build a test F = F0 against F = F0; one rejects this hypothesis F = F0 if supx vn|Fn(x) ? F0(x)| > ?. General case. In the following we shall select sequences m = m(n) ^ ? of integers such that mn > 0 and p = p(n) ^ ?. The probability of this event can be evaluated in the following way: P sup x vn |Fn(x) ? F0(x)| >?= P{max i | ?X(m)(xi )| >?} + ?1 + ?2 + ?3, where xi =i/p for 0 < i p; moreover ?X(m) and ?X(m) denote the Gaussian process with covariance function cov( ?X(m)(x), ?X(m)(y)) = [F(x) ? F(y) ? F(x)F(y)] + + 0<i1 m cov(1?0 x, 1?i y).
208 PAUL DOUKHAN AND GABRIEL LANG Note also that cn,i = #{j ? T ; i + j ? BN, ?s x, ?s+t y}/#{j ? T ; i + j ? BN} is an unbiased estimate of cov(1?0 x , 1?t y) with variance O(n) uniformly w.r.t. t m(n) under the assumptions in theorem 1. If T = Z this is the classical empirical estimate of a covariance. The probability in the left-hand term may thus be tabulated, because ( ?X(m)(xi)) is a Gaussian vector whose covariance may be estimated empirically from the data. The three error terms ?j are defined as ?1 = P sup x |vn (Fn(x) ? F0(x)) | > ?? P sup x |X(x)| > ?, ?2 = P sup x |X(x)| > ?? P max i |X(xi )| > ?, ?3 = P max i |X(xi )| > ?? P max i | ?X(m)(xi )| > ?. Now the result of Theorem 1 gives a bound for ?1 (constants have to be computed) and ?2 is related to the oscillations of order ? = 1/p for the process X bounded in Proposition 3. The problem is to bound ?3 by an adaptation of the Normal comparison lemma (see Leadbetter et al., 1983, p. 81) because the minoration conditions in this lemma on the covariance function do not hold in general. We thus have to choose the sequence (xi ) and m depending on n in order to keep the error term small, so that P{maxi | ?X(m)(xi )| > ?} is a good approximation of the level of the test based on the Kolmogorov-Smirnov statistic. If we consider a reasonable counter-hypothesis (such as supx |F(x) ? F0(x))|C), we may, along the same line, precise the power of this test. The extension to sequences of contiguous alternatives is straightforward. Associated case. In this case, the process X is also associated because its covariance is defined by a nonnegative series (see Doukhan and Louhichi, 1999). From Corollary 4.2.3 (Leadbetter et al., 1983), we get an explicit bound for the level of the test if F is known (recall that B denotes the Brownian bridge) P sup x |X(x)|?P sup x |B(F(x))|?. In the general case, one first uses an a priori estimate of the repartition function. Remark: functional estimation. Another application of such limit theorems concerns the functional estimation; a kernel density estimator built on a sample of the random field writes fn,hn(x) = h?1 n K(x ? y/hn)dFn(y) (Tran, 1990; Tran and Yakowitz, 1993). Recall that under suitable assumptions on the random field and on the window width h ? hn, one proves that finite dimensional repartitions of the estimation process Zn(x) = vnhn(fn,hn(x) ? Efn,hn(x)) converge to Gaussian r.v's with independent marginals (Doukhan and Louhichi, 1998). Indeed this process writes as Zn(x) = h?1/2 n K(x ? y/hn)dXn(y). Hence, an integration by parts implies Zn ? Z(n)? h?1/2 n KT V Xn ? X(n)? if Z(n)(x) =
EMPIRICAL CENTRAL LIMIT THEOREM 209 h?1/2 n K(x ? y/hn) dX(n)(y) and where we denote KT V = |K(x)| dx the variation of the kernel K. This approximation of the estimation processes by the sequence (Z(n))n1 of Gaussian process is thus consistent if hnn2? >?. The sequence Z(n) is not convergent, however asymptotic results derive for Znp, if p ? [1,?], similar to those associated to i.i.d samples (Rosenblatt, 1991). Low convergence rates also hold under the previous restrictive window width assumptions. The proof of Theorem 1 is based on the well-known results on the convergence in distribution and the Prohorov distance. LEMMA 1. Let ? be a positive real and D be a finite subset {x1, . . . , xm} ? [0, 1], such that every x in [0, 1] is in a ?-neighbourhood of some xi. Let X and Y be two distribution functions on S. Then the Prohorov distance between X and Y is bounded by: ?(X, Y)?X(?) + ?Y (?) + ?(XD, YD), where ?X(?) = inf(? ? R, P(wX(?) > ?)?); wX(?) = supx?y<?(X(x) ? X(y)) is the ?-oscillation of X. We need to compute bounds for the ?-oscillations and distance between laws. These are based on moment inequalities for the process Xn. 4. Preliminary Computations First we establish an inequality for the even order moments of the increments of Xn. PROPOSITION 1. Arithmetic decay. Assume that ?w,r Cr?a with a such that a > d. For l < (a + d)/2d and (s, t) such that C? |t ? s| < C: E(Xn(t) ? Xn(s))2l (4l ? 2)! (2l ? 1)!32dl((2dkl(C? |t ? s|/C)1?d/a)l + +(2l)!dkln1?l(C? |t ? s|/C)1?(2l?1)d/a), (8) wherekl = C + Cd2a a ? d(2l ? 1). Geometric decay. Assume that ?w,r Ce?br , with b > 0. For (s, t) such that |t ? s| < C? e?4b/C and |t ? s| < Ce3b/C? : E(Xn(t) ? Xn(s))2l (4l ? 2)! (2l ? 1)! (6(1 ? b?2) log(1/|t ? s|))2dl ? ?((2d (2d)!C? |t ? s|)l+ (2l)!d (2ld)!n1?lC? |t ? s|). (9)
210 PAUL DOUKHAN AND GABRIEL LANG Note that Xn(t)?Xn(s) = v1n k?BN gt,s(?k). The proposition is a consequence of the bound of the covariance of quantities depending on the functions gt,s(?k), that is a slight modification of Lemma 1 of Doukhan and Louhichi (1999). LEMMA 2. Consider ? , i, j, u and v as in Definition 1. Let G and H be two bounded Lipschitz functions on Ru and Rv, respectively. Then |cov(G(?i),H(?j))|?w(G,H, u, v)?w,r , (10) where, setting ? = uH?Lip (G) + vG?Lip (H), we define ?1(G,H, u, v) = [(u + v)(H?Lip (G) ? G?Lip (H))?]1/2, (11) ?2(G,H, u, v) = (u + v)2/3(Lip (G)Lip (H))1/3?2/3. (12) Applying this lemma to the particular case where F and G are products. COROLLARY 1. If (?n) is (?,L,?w)-dependent, then |cov(=i,=j)|(u + v)2?w,r . (13) 4.1. OSCILLATIONS OF THE EMPIRICAL PROCESS Using Proposition 1, we establish bounds for the modulus of continuity of Xn. PROPOSITION 2. Arithmetic decay. If ?w,r Cr?a with a such that a > d and forp < (a + d + 1)/2d, and for ? 1/n, ?Xn(?)K0(p, a, d)?p(1?d/a)/(2p+1) ? 8C?n?1/2, (14) where (K0(p, a, d))2p+1 = 2 2p(1?d/a) 2p(1?d/a)?1 (4p?2)!32dp (2p?1)! (2dkp(C? |t ? s|/C)1?d/a)p. Geometric decay. If ?w,r Ce?br , with b > 0, for ? 1/n: ?Xn(?)K1(C?, b, d)?1/2 logd+1(1/?), (15) where K1(C?, b, d) = 32(6(1 ? b?2))d (2d(2d)!C? )1/2. 4.2. OSCILLATIONS OF THE LIMIT PROCESS We use the fact that the limit process X is Gaussian to establish that: PROPOSITION 3. Arithmetic decay. If ?w,r Cr?a with a such that a > d and if 0 < ? < 1 ? d/a, ?X(?)K2(?, a, d)??/2 log1/2(1/?), (16) where K2(?, a, d) = 26((4 + ?)?r=0(2r + 1)d?1r?a(1??))1/2.
EMPIRICAL CENTRAL LIMIT THEOREM 211 Geometric decay. If ?w,r Ce?br , with b > 0: ?X(?)K3(C?, b, d)?1/2 log(d+1)/2(1/?), (17) where K3(C?, b, d) = (C?d!(2d + 7))1/22d (1 ? b?1)d . 4.3. DISTANCE BETWEEN THE FINITE DIMENSIONAL LAWS Let m ? N. Let D = {t1, . . . , tm} ? [0, 1]. We denote zi the m-vector (xi (t1) , . . . , xi (tm)). Define the partial sum sn: sn = 1 vn i?BN zi . Let Y be a centered Gaussian m-vector, whose covariance matrix is >D = (>s,t)s,t?D. We bound the Prohorov distance between sn and Y using the method of Doukhan et al. (1985). For a real ? such that 0? 1, we define the class of functions F? F? = {f ? C3(Rm); 0f 1, ||f (i)||? 2m?1/2??i for i = 1,2 or 3}, (18) where f (i) is the differential of ith order of f and the norm || - ||? is the operator sup-norm w.r.t to the norm - 1: ||f (1)||? = sup x sup ||h||1 1 |f (1)(x) - h|, ||f (2)||? = sup x sup ||h1||1,||h2||1 1 |f (2)(x) - (h1, h2)|, ||f (3)||? = sup x sup ||h1||1,||h2||1,||h3||1 1 |f (3)(x) - (h1, h2, h3)|. A bound of the Prohorov distance between sn and Y is given by: ?(sn, Y)4m1/2?(1 + log1/2(?)) + 2 sup F? |E(f (sn) ? f (Y)|). (19) PROPOSITION 4. Define m, p and q as functions of n that converge to infinity with n, negligible with respect to n, and ? as a function of n that converges to zero as n tends to infinity. In the arithmetic case, assume moreover that a > 3d. For a sufficiently large n, if w = 1 ?(sn, Y) 4m1/2?(1 + log1/2(1/?)) + +K1??1m1/2q1/2p?1/2 + +2K5m3/2??2p?d/2?1,qn3/2 + +2K6m5/2??3pd?1,qn + +2K7m7/2pd/2??3n?1/2 + +2K8m3/2??2p?1q.
212 PAUL DOUKHAN AND GABRIEL LANG If w = 2, the terms involving K5 and K6 are replaced by + 2K5m5/2??2p?d/3?2,qn11/6 + + 2K6m17/6??3p2d/3?2,qn4/3. The values of the constants Ki are given in the proof section. 5. Proofs 5.1. PROOF OF THE PROPOSITIONS 5.1.1. Proof of Proposition 1 We adapt Lemma 14 in Doukhan and Louhichi (1999) to the series (gt,s(?k))k?BN . For any integer q 1, set: Aq(N) = k?BqN |E(=k)|, (20) then,|E(Xn(s) ? Xn(t))2l |(2l)!n?lA2l(N). (21) For a finite sequence k = (k1, . . . , kq ) of elements of T , the gap is defined by the max of the integers r such that the sequence may be split into two nonempty subsequences k1 and k2 ? Zd whose mutual distance equals r (d(k1, k2) = min{i ?j1; i ? k1, j ? k2} = r). If the sequence is constant, its gap is 0. Define the set Gr(q,N) = {k ? BqN and the gap of k is r}. Sorting the sequences of indices by their gap: Aq(N) k1?BN E|gs,t(?k1)|q +2N r=1 k?Gr (q,N) |cov(=k1,=k2)| + (22) + 2N r=1 k?Gr (q,N) |E(=k1)E(=k2)|. (23) Define Vq(N) as the sum of the right-hand side of (22). In order to prove that the expression (23) is bounded by the productm Am(N)Aq?m(N)wemake a first summation over such k's with #k1 = m. Hence, Aq(N)Vq(N) + q?1 m=1Am(N)Aq?m(N). To build a sequence k belonging to Gr(q,N), we first fix one of the n points of BN. We choose a second point on the 21-sphere of radius r centered on the first point. The third point is in a ball of radius r centered on one of the preceding points, and so on. Thus
EMPIRICAL CENTRAL LIMIT THEOREM 213 #Gr(q,N) n2d(2r + 1)d?1(2r + 1)d - - - (2(q ? 2)r + 1)d nd(q!)d (3r)d(q?1)?1. We use Corollary 1 to deduce Vq(N)nC? |t ? s| + d(q!)d2N r=1(3r)d(q?1)?1 min(?w,r,C? |t ? s|). Arithmetic decay. Assume that ?w,r Cr?a with a > d. Denote R the integer such thatR < (C?|t ? s|/C)?1/a R + 1. For any 2q 2l Vq(N) 3d(q?1)nd(q!)d C? |t ? s| R?1 r=0 rd(q?1)?1 + C ?r=R rd(q?1)?1?a3d(q?1)nd(q!)d C? |t ? s| d(q ? 1)Rd(q?1) + C a ? d(q ? 1)Rd(q?1)?a3d(q?1)n(q!)d(C? |t ? s|/C)?d(q?1)/a ? ? C? |t ? s| q ? 1 + Cd a ? d(q ? 1)R?a. But R 1, so that (C? |t ? s|/C)?1/a 2R, and Vq(N)3d(q?1)n(q!)d(C? |t ? s|/C)1?d(q?1)/a C + Cd2a a ? d(2l ? 1). We find that Vq(N)3dqn(q!)dkl(C? |t ? s|/C)1?d(q?1)/a, (24) and Vq(N) is a function of q that satisfies condition (H0) of Doukhan and Louhichi (1999): if 2p q, V q?2 p (N)V p?2 q (N)V q?p 2 (N). ThenA2l(N) (4l ? 2)! (2l)!(2l ? 1)!32dl((2dkln(C? |t ? s|/C)1?d/a)l + +(2l)!dkln(C? |t ? s|/C)1?(2l?1)d/a), and (8) is proved. Geometric decay. Assume that ?w,r Ce?br. Then Vq(N)nd3d(q?1)(q!)d ? ? C? |t ? s| R?1 r=0(r + 1)d(q?1)?1 + C ?r=R(r + 1)d(q?1)?1e?br.
214 PAUL DOUKHAN AND GABRIEL LANG Comparing those summations with integrals and using the relation: ?t ? [r + 1, r + 2], (r + 1)d(q?1)?1e?br td(q?1)?1e?b(t?2), we find that Vq(N) n3d(q?1) (q!)d q ? 1 ? ? C? |t ? s|Rd(q?1) + Cd(q ? 1)e2b ? R td(q?1)?1e?btdt; but ? R td(q?1)?1e?btdt Rd(q?1) ? 1 xd(q?1)?1e?bRxdx Rd(q?1)e?b(R?1) ? 1 xd(q?1)?1e?bxdx, henceVq(N) n3d(q?1)(q!)d Rd(q?1) (q ? 1)(C? |t ? s| + +Ce4be?b(R+1)b?d(q?1)(d(q ? 1))!) n(3(1 ? b?1))d(q?1)(q!)d(d(q ? 1))!Rd(q?1)C? |t ? s| ? ? 1 + Ce4b C? |t ? s| e?b(R+1). Choose R as the integer part of 1/b log(Ce4b/C? |t ?s|) and assume that (s, t) ? T are such that |t ? s|e?4bC?/C and |t ? s|e3bC/C?. Then R 1 and Vq(N)nC? |t ? s|(6(1 ? b?2))dq(q!)d(dq)! logdq(1/|t ? s|), (25) so that Vq(N) is a function of q that satisfies condition (H0) of Doukhan and Louhichi (1999). Then A2l(N) (4l ? 2)! (2l)!(2l ? 1)! (6(1 ? b?2) log(1/|t ? s|))2dl((2d (2d)!nC? |t ? s|)l + +(2l)!d (2ld)!nC? |t ? s|), and (9) is proved. 5.1.2. Proof of Proposition 2 Arithmetic decay. We use this moment inequality and the techniques of Doukhan and Portal (1983) to compute the oscillation of the process. Using the fact that
EMPIRICAL CENTRAL LIMIT THEOREM 215 Xn is the difference between two monotone functions, Doukhan and Portal show that sup s t<s+m/n |Xn(t) ? Xn(s)|3 max 0i mXn(s) ? Xn s + in+ 2vC? n . (26) Define M(m, s) = max0im(|Xn(s) ?Xn(s +i/n)| ? |Xn(s +m/n)?Xn(s + i/n)|). Following Billingsley (1968), max 0im Xn(s) ? Xn s + inM(m, s) + Xn s + mn ? Xn(s). (27) As in Doukhan and Portal (1983), we bound the tail distribution of M(m, s). LEMMA 3. Assume that E(Xn(t) ? Xn(s))2p Cp(|t ? s|p(1?d/a)). Then P(M(m, s)?)Cp 2p(1?d/a) ? 1 mn p(1?d/a) ??2p. (28) Let ?>0 and assume that n? 1. We compute the ?-oscillation of Xn. Let ? > 0. Let n be such that 2C? /vn < ?/4. Let m be the first integer larger than n?. Because of relation (26): Psup s t<s+m/n |Xn(t) ? Xn(s)|?P max 0i m Xn(s) ? Xn s + in?/4. Because of relation (27) P max 0im Xn(s) ? Xn s + in?/4P M(m, s)|?/8+ P |Xn(s) ? Xn s + mn |?/8Cp 2p(1?d/a) ? 1 mn p(1?d/a) 82p ?2p + Cp mn p(1?d/a) 82p ?2p K0(p, a, d)2p+1 ?p(1?d/a) ?2p , where K0(p, a, d)2p+1 = 2(2p(1?d/a)/2p(1?d/a) ? 1)((4p ? 2)!32dp/(2p ? 1)!) (2dkp(C? |t ? s|/C)1?d/a)p. Choosing ?? = K0(p, a, d)?p(1?d/a)/(2p+1), we see that ?Xn(?)?? . Note that ?? must be larger than 8C? /vn. Geometric decay. We show that some exponential moment of Xn(t)?Xn(s) is finite and use Stroock's method to find the oscillation.
216 PAUL DOUKHAN AND GABRIEL LANG LEMMA 4. Denote f (u) = |u|1/2 logd (1/u). Assume that X satisfies the geometric decay assumption of Lemma 1 and that n? 1. Then there exists a constant c0 such that for every c < c0 and every (s, t) such that |t ? s|?: E exp c |Xn(t) ? Xn(s)| f (t ? s) B(c) < +?. We apply a lemma of Garsia et al. (Stroock, 1984, (2.8) p. 8). Let c = c0/2, B(c) as in Lemma 4, ?(u) = exp(cu) ? 1 and 0 < ? < e?2d . The lemma says that if Y(?) = ? 0 ? 0 ?(|Xn(t,?) ? Xn(s, ?)|/f (|t ? s|))dsdt < ?, then |Xn(t,?) ? Xn(s,?)| 8 t?s 0 ??1(4Y(?)/u2)f (u)du 8 ? 0 ??1(4Y(?)/u2)f (u)du 8??1(4Y(?)/?2)f (?). Using Markov inequality and the fact that E(Y )B(c)?2: P(|Xn(t) ? Xn(s)|?) P Y ?2 4 ? ? 8f (?)4B(c) ? ? 8f (?). Choose ? = 4f (?) log(1/?)/c. Then P(|Xn(t) ? Xn(s)|?)4B(c)?1/2/(1 ? ?1/2). For ? sufficiently small, this term is less than ?, so that ?Xn(?)K1?1/2 logd (1/?) with K1 = 4/c. 5.1.3. Proof of Proposition 3 We use a chaining argument to bound the ?-oscillations of the Gaussian limit process X. This non-stationary process is centered and defined by its covariance function. Define a semi-metric ??on [0, 1] by ??(s, t)2 = var(X(t) ? X(s)). As a Gaussian process, X satisfies the exponential inequality: P(|X(t) ? X(s)|???(s, t))exp??2/2. By definition, ??(s, t)2 = j?T cov(x0(t) ? x0(s), xj (t) ? xj (s)). Using the Cauchy-Schwarz inequality: cov(x0(t) ? x0(s), xj (t) ? xj (s))var(x0(t) ? x0(s))C? |t ? s|, and from (1), cov(x0(t) ? x0(s), xj (t) ? xj (s))?w,j .
EMPIRICAL CENTRAL LIMIT THEOREM 217 For a metric ? over [0, 1], we denote N?(?) the covering number (see Pollard (1984), p. 143). It is the size of the smallest set S of points of [0, 1], so that for any t , ?(t, S)?. The corresponding covering integral is J?(?) = ? 0 (2 log(N?(u)2/u))1/2du. Arithmetic decay. Assume that ?w,r Cr?a witha > d. Let 0 < ? < 1?d/a. Then??(s, t)2 ?r=0 (2r + 1)d?1?1?? w,r |t ? s|? K2?|t ? s|?. Let ? > 0. The inclusion of the balls of the two metrics implies that N??(K???/2)N|-|(?). The covering number N|-|(?) for the uniform metric is less than 2??1. Thus N??(u)2(K?/u)2/?. The corresponding covering integral is: J??(?) ? 0 (4 log(2K2/? ? ) + (8/? + 2) log(1/u))1/2du 2? log1/2(2K2/? ? ) + (8/? + 2)1/2 log?1/2(1/?) ? 0 log(u)du 2? log1/2(2K2/? ? ) + (8/? + 2)1/2? log1/2(1/?). The chaining lemma (Pollard, 1984) implies that for 0 < ? < 1: P max ??(s,t )<? |X(t) ? X(s)| 26J ? ?(?)?. Taking ? = K???/2, the set {(s, t); |t ? s|?} is included in the set {(s, t); ? ?(s, t) ?}, so that P max |t?s|? |X(t) ? X(s)| 26J ? ?(K???/2)K???/2. Then J??(?)(8/? + 2)1/2? log1/2(1/?) for a sufficiently small ? and ?X(?)26K?(4 + ?)1/2??/2 log(1/?)1/2. Geometric decay. Assume that ?w,r Ce?br . Computing as in (25), it is easy to show that ??(s, t)2 = ?r=0(2r + 1)d?1?w,r ? C? |t ? s|K2|t ? s| logd (1/|t ? s|), where K = 2dC?d!(1 ? b?1)d. Let ? > 0. The inclusion of the balls of the two metrics implies that N??(K?1/2 logd/2(1/?))N|-|(?). Thus N??(u)2d+1(K/u)2 logd+1(K/u)2d+1(K/u)d+3. The corresponding covering integral is
218 PAUL DOUKHAN AND GABRIEL LANG J??(?) ? 0 (4 log(2d+1(K/u)d+3) + 2 log(1/u))1/2du 2? log1/2(2d+1Kd+3) + (4d + 14)1/2 log?1/2(1/?) ? 0 log(u)du 2? log1/2(2d+1Kd+3) + (4d + 14)1/2? log1/2(1/?). Taking ? = K?1/2 logd/2(1/?) P max |t?s|? |X(t) ? X(s)| 26J ? ?(K?1/2 logd/2(1/?))K?1/2 logd/2(1/?). For a sufficiently small ?, ?X(?)J??(K?1/2 logd/2(1/?))K(2d + 7)1/2?1/2 log(d+1)/2(1/?). 5.1.4. Proof of Proposition 4 We use the Bernstein blocking technique (Bernstein, 1939), as described for random fields by Doukhan et al. (1984). Assume that the Euclidean division of N by (p+q) gives a quotient a and a remainder r. For l = ?a+1, . . . , a, we define the index set Il = {(p+q)(l?1)+q+1, . . . , (p+q)l}.We order the set [?a+1; a]d by the lexicographic order. To any integer i such that 1i k = (2a)d , corresponds an element j of this set; we define the block Pi =dl=1 Ijl and Q the set of indices that are not in one of the Pi . Note that the cardinal of Q is not equal to qd as could be generalised from the one dimensional situation, but of order pd?1q. For each block Pi and Q, we define the partial sums: ui = 1 vnj?Pi zj, v= 1 vnj?Q zj . Consider an independent sequence of centered Gaussian vectors (yi )i=1,...,k, such that each yi has the same covariance matrix as ui. Let ? > 0 and f ? F? defined by (18). We decompose f (sn) ? f (Y) = f (sn) ? f k i=1 ui+ (29) +f k i=1 ui? f k i=1 yi+ (30) +f k i=1 yi? f (Y). (31)
EMPIRICAL CENTRAL LIMIT THEOREM 219 Consider the left-hand side of (29). Using Proposition 1: Ef (sn) ? f k i=1 uiEf k i=1 ui + v? f k i=1 ui2m?1/2??1 m s=1 E(|vs |) 2m1/2??1E(|v1|2)1/2. There exists a contracting injective mapping from Q to BN(q) with N(q) = 1/2 (dnq/p)1/d. Because ?w,r is strictly decreasing, this shows that E(|v1|2) = 1n i,j?Q cov xi (t1), xj (t1)1n i,j?BN(q) ?w,i?j(2N(q) + 1)q n 2N(q) r=0 (2r + 1)d?1?w,r K?N(q)d n , where K? is a constant depending on the sequence ?w,r . Thus, for K1 = 21?d/2 (K?d)1/2, Ef (sn) ? f k i=1 uiK1 mq p 1/2 ??1. (32) Substituting the ui one by one, the difference (30) may be written f ?? k j=1 uj?? ? f ?? k j=1 yj?? = k j=1 ?j , where ?j = f (u1+- - -+uj +yj+1+- - -+yk)?f (u1+- - -+uj?1+yj+- - -+yk). Each term ?j has the general form f (A+uj )?f (A+yj ), where A = (u1+- - -+ uj?1 +yj+1+- - - + yk). Using a Taylor expansion and the independence of yj and A: E(|f (A + uj ) ? f (A+ yj )|) E f (1)(A) - uj + (33) + 12 m s,t=1 E ?2f (A) ?xs?xt (ujs ujt )? E ?2f (A) ?xs?xt E yjs yjt + (34) + 13m?1/2??3(E(|u1|31) + E(|y1|31)). (35)
220 PAUL DOUKHAN AND GABRIEL LANG Because u1 is centered, the right-hand side of (33) may be considered as m s=1 E ?f (A) ?xs usj= m s=1 cov ?f (A) ?xs , usj. Assume that w = 1. The fact that ?f (A)/?xs depends on some variables yi does not change the bound of the covariance because the yi are independent of the ui. Define G = ?f (A)/?xs and H = ujs . We apply Lemma 2 for umn, v = pd, Lip (G)2m?1/2??2, Lip (H)n?1/2, G? 2m?1/2??1 and H? pdn?1/2. Because of the respective order of the parameters, we simplify (11) cov ?f (A) ?xjs , ujs2uLip (G)H??1,q 4m1/2??2pd/2n1/2?1,q . Summing over j and s k j=1 |E(f (1)(A) - uj )|4m3/2??2p?d/2?1,qn3/2. The term (34) is equal to 1/2ms,t=1 cov ?2f (A) ?xs?xt , ujs ujt . Define G = ?2f (A)/?xsj?xtj and H = ujs ujt . We apply Lemma (2) for umn, v = 2pd, Lip (G)2m?1/2??3, Lip (H)pdn?1, G? 2m?1/2??2 and H? p2dn?1.We apply the simplified formula cov ?2f (A) ?xs?xt , ujs ujt 2uLip (G)H??1,q 4m1/2??3p2d?1,q . Summing over j , s and t k j=1 12 m s,t=1 E ?2f (A) ?xs?xt ujs ujt ? E ?2f (A) ?xs?xt E(yjs yjt )2m5/2??3pd?1,qn. Assume that w = 2. Using a simplified version of (12) k j=1 |E(f (1)(A) - uj )|4m15/6??2p?d/3?2,qn11/6, k j=1 12 m s,t=1 E ?2f (A) ?xs?xt ujs ujt ? E ?2f (A) ?xs?xt E(yjs yjt )2m17/6??3p2d/3?2,qn4/3.
EMPIRICAL CENTRAL LIMIT THEOREM 221 The last term (35) is bounded using Jensen and Cauchy Schwartz inequalities |u1|31m3 max s (|u1s |4)3/4. The same bound is used for yi . Because it is Gaussian and has the same covariance structure as ui : E(|y1s |4) = 4E(|y1s |2)2 = 4E(|u1s |2)2 4E(|u1s |4). Arithmetic decay. We adapt the proof of Proposition 1 to the computation of the 4-order moment of ui . Assume that a > 3d. Substituting 1 to the bound C? |t ? s| and choosing R = 1 ? [C1/a], Equation (24) becomes Vq(N)3dqpd(q!)dk2(1 ? [C1/a])1?d(q?1)/a. Then, for a large p E|u1s |4 240 34d4d(1 ? [C1/a])2(k2)2p2d n2 , so that, after summation over j , the term (35) is less than 102 43d/433dk3/2 2 (1 ? [C1/a])3/2??3m5/2p3d/2n?3/2. (36) Geometric decay. Substituting 1 to the bound C? |t ? s| and choosing R = 1 ? (4 + b?1 log(C)), Equation (25) becomes Vq(N)pd 3(1 ? (4 + b?1 log(C)))(1 ? b?2)dq (q!)d(dq)! Then, for a large p E|u1s |4 240 34d4d(2d)!2(3(1 ? (4 + b?1 log(C)))(1 ? b?2))4 p2d n2 , so that, after summation overj , the term (35) is less than 102 43d/433d (2d)!3/2(1 ? [C1/a])3/2 ? ?(3(1 ? (4 + b?1 log(C)))(1 ? b?2))3??3m5/2p3d/2n?3/2. (37) We conclude that, if w=1: E??f ??k j=1 uj?? ? f ?? k j=1 yj????K5m3/2??2p?d/2?1,qn3/2 + +K6m5/2??3pd?1,qn + +K7m5/2pd/2??3n?1/2, (38)
222 PAUL DOUKHAN AND GABRIEL LANG where K5 = 4, K6 = 2 and K7 is the constant in (36). If w = 2: E??f ??k j=1 uj?? ? f ?? k j=1 yj????K5m15/6??2p?d/3?2,qn11/6 + +K6m17/6??3p2d/3?2,qn4/3 + +K7m5/2pd/2??3n?1/2, (39) where K7 is the constant in (37). Now we have to bound the difference (31). We use the following lemma. LEMMA 5. Let X and Y be two centered Gaussian vector of length m, with respective covariance matrix M and N. Let 0 < ? < 1 be a real, and f ? F?. Then|E(f (X) ? f (Y))|m?1/2??2M ? N1, where A1 = i,j |Ai,j |. Recall that var(yi ) = var(ui ) = pd n >D,p, where >D,p(s, t) = |j |<p h(j)cov (x0(s), xj (t)), where h(j) = dl=1(1 ? jl/p). Note that yi is a centered Gaussian vector with covariance k pd n >D,p and Y a centered Gaussian vector with covariance >D. For (s, t) ? D2, define the matrix M with coefficients M(s, t) = |j |<p cov(x0(s), xj (t)), then: kpd n >D,p ? >D1 kqpd?1 n ||>D,p||1 + ||>D,p ?M||1 + ||M ? >D||1. Because of the convergence of the series defining >, >D,p? is uniformly bounded in m and p. Because 1?h(j)d|j |/p, >D,p?M? = O(1/p) and gives the main contribution. In the case of arithmetic decay with a > d + 1, M ? >D is the remainder of the series so that M ? >D? = O(pd?a). In the case of geometric decay, M ?>D? is even smaller. We conclude that the difference (31) satisfies: Ef k i=1 yi? f (Y)K8m3/2??2qp?1. (40) Thus collecting the bounds (32), (33) or (39) and (40) implies that the distance between the finite dimensional distributions of size m is such that, if w = 1: ?(sn, Y) 4m1/2?(1 + log1/2(1/?)) + (41) +K1??1m1/2q1/2p?1/2 + (42) +2K5m3/2??2p?d/2?1,qn3/2 + (43) +2K6m5/2??3pd?1,qn + (44) +2K7m7/2pd/2??3n?1/2 + (45) +2K8m3/2??2p?1q. (46)
EMPIRICAL CENTRAL LIMIT THEOREM 223 If w = 2, (43) and (44) are replaced by + 2K5m5/2??2p?d/3?2,qn11/6 + (47) + 2K6m17/6??3p2d/3?2,qn4/3. (48) This concludes the proof of Proposition 4. Proof of Theorem 1. Let D be the set of real (i/n)i=1,...,n. The corresponding ? is m?1.We collect the results of Proposition 2 (oscillation of the empirical process), Proposition 3 (oscillation of the Gaussian limit process) and Proposition 4 (distance between fidi repartitions). We shall use the Lemma 1 to conclude. Arithmetic decay. Assume thata > 3d. Taking the larger l, the (1/m)-oscillation of Xn is less than K9m?1/2+?, where ? = (d2+2da+2a?d)/2(a2+2ad+a). We choose ? > 2l(1 ? d/a)/(2l + 1) so that the (1/m)-oscillation of X is negligible with respect to m?1/2+? . If the main term is of order m?1/2+? , the term (42) is always less than the term (46). After a complete study, the terms (44) and (48) are also greater than the terms (43) and (47), respectively. If w = 1, the minimum rate is obtained for parameters such that the following quantities are of same order with respect to n. m?1/2+? , (49) m1/2? log1/2(n), (50) m5/2??3pdq?an, (51) m5/2??3pd/2n?1/2, (52) m3/2??2p?1q. (53) The solution is mv1 = n2a?4d(log(n))?2ad?6a+3d, ?v1 = n(?2a+4d)(1?? )(log(n))?2ad?6a+3d+? (ad+2a?d), pv1 = n8a+36?? (6a+24)(log(n))2a? , qv1 = n12d+36?? (12d+24)(log(n))d? , with v1 = 8ad + 24a + 12d ? ? (6ad + 16a ? 8d). The corresponding rate is n(2??1)(a?2d)/v1(log(n))(1?2? )(ad+3a?3d/2)/v1. If w = 2, the only change is in quantity (51), that should be replaced by m17/6??3p2d/3q?an4/3. The solution is mv2 = n2a?4d(log(n))?2ad?6a+d, ?v2 = n(?2a+4d)(1?? )(log(n))?2ad?6a+2d/3+? (ad+2a?d/3), pv2 = n8a+134/3?? (6a+88/3)(log(n))2?2?a, qv2 = n16d+134/3?6? (12d+88/3)(log(n))?2d/3?2+?d/3,
224 PAUL DOUKHAN AND GABRIEL LANG with v2 = 8ad +24a ?10d/3?? (6ad +16a ?8d/3). The corresponding rate is n(2??1)(a?2d)/v2(log(n))(1?2? )(ad+3a?d/2)/v2. Geometric decay. The (1/m)-oscillation of Xn is less than K10m?1/2 log2d+1 (m). The (1/m)-oscillation of X is negligible with respect to m?1/2 log2d+1(m). We choose q = log(n). The terms (42), (43) and (44) are negligible. The minimum rate is obtained for parameters such that the following quantities are of same order with respect to n. m?1/2 log2d+1(n), m1/2? log1/2(n), m5/2??3pd/2n?1/2, m3/2??2p?1 log(n). The solution is m = n1/4d+12(log(n))6d2+17d+5/4d+12, p = n1/d+3(log(n))?2d+2/d+3, ? = n?1/4d+12(log(n))?(2d2+9d+1/4d+12). For this choice, the rate of convergence is n1/8d+24(log(n))10d2+39d+29/8d+24. 5.2. PROOFS OF THE LEMMAS 5.2.1. Proof of Lemma 2 Let ? 0 and define ?-approximations gt,s,? of functions gt,s by gt,s,?(x) = s ? x ? 1[s??,s[(x) + 1[s,t ](x) + 1 ? t ? x ? 1]t,t+?](x), such that gt,s,? is 1/?-Lipschitz. Then, i=1,...,q gt,s,?(yi ) is also in L and its Lipschitz modulus is equal to 1/?. Define G?(?i) = G(gt,s,?(?i1), . . . , gt,s,?(?iu)). |cov(G(xi),H(xj)) ? cov(G?(?i),H?(?j))| |E(G(xi)H(xj)) ? E(G?(?i)H?(?j))| + (54) +|E(G(xi))E(H(xj)) ? E(G?(?i))E(H?(?j))|. (55) After substitution of the variables one by one, the term (54) is bounded by |E(G(xi)H(xj)) ? E(G?(?i)H?(?j))| u k=1 H?Lip (G)E|gs,t (?ik ) ? gs,t,?(?ik )| + + v k=1 G?Lip (H)E|gs,t(?jk ) ? gs,t,?(?jk )|.
EMPIRICAL CENTRAL LIMIT THEOREM 225 But E(|gs,t(?i)?gs,t,?(?i)|)2C? ? because the density of the variable ?i is bounded by C? and the two functions are equal except on two intervals of length ?, so that |E(G(xi)H(xj)) ? E(G?(?i)H?(?j))| 2C? (uH?Lip (G) + vG?Lip (H))?. The bound of the term (55) is the same. Now G? is a (Lip (G)/?)-Lipschitz function, so that |cov(G?(?i),H?(?j))|G?H??w(u, v,G?/G?,H?/H?)?r . Hence, |cov(G?(?i),H?(?j))| 4C? (uH?Lip (G) + vG?Lip (H))? + +(u + v)(G?Lip (H) ? H?Lip (G))?r ? , if w = 1, 4C? (uH?Lip (G) + vG?Lip (H))? + +(u + v)2(Lip (G)Lip (H)) ?r ?2 , if w = 2. Choosing the optimal ?, minimising the sum of the two terms, relation (10) is proved. 5.2.2. Proof of Lemma 3 Note that M(2, s) =Xn(s) ? Xn s + 1n?Xn s + 2n? Xn s + 1n, so that P(M(2, s)?)P(|Xn(s) ? Xn(s + 1n )|?) and (28) is true for m = 2. Let m be fixed and such that for every i < m and every s, the lemma is true for M(i, s). Define h = [m/2] + 1. If i < h, then |Xn(s) ? Xn(s + i/n)| ? |Xn(s + m/n) ? Xn(s + i/n)| M(h, s) + |Xn(s + m/n) ? Xn(s + (h ? 1)/n)|. If hi m, then |Xn(s) ? Xn(s + i/n)| ? |Xn(s + m/n) ? Xn(s + i/n)| M(m ? h, s + h/n) + |Xn(s + h/n) ? Xn(s)|. Because of the moment inequality P Xn s + mn ? Xn s + h ? 1 n ?cp mp(1?d/a) (2n)p(1?d/a)?2p , P Xn s + hn? Xn(s)?Cp mp(1?d/a) (2n)p(1?d/a)?2p .
226 PAUL DOUKHAN AND GABRIEL LANG Because of the recurrence P(M(h, s)?)Cp 2p(1?d/a) ? 1 mp(1?d/a) (2n)p(1?d/a)?2p , P M(m ? h, s + h/m)?Cp 2p(1?d/a) ? 1 mp(1?d/a) (2n)p(1?d/a)?2p . ThenP(M(m, s)?) Cp/(2p(1?d/a) ? 1) + Cp 2p(1?d/a) mp(1?d/a) np(1?d/a)?2p Cp 2p(1?d/a) ? 1 mp(1?d/a) np(1?d/a)?2p . 5.2.3. Proof of Lemma 4 Using the moment inequality (9) and Stirling's formula E |Xn(t) ? Xn(s)| f (t, s) 2p (4p)4p(2p)?2pe2p((6(1 ? b?2))2d2d (2d)!C? )p p2p((6(1 ? b?2))2d2d(2d)!4e2C? )p. E exp c |Xn(t) ? Xn(s)| f (t ? s) ?k=0 ck k!E |Xn(t) ? Xn(s)| f (t, s) k ?k=0 ck k! E |Xn(t) ? Xn(s)| f (t, s) 2k1/2 ?k=0 ckkk k! (4e2(6(1 ? b?2))2d2d (2d)!C? )k/2. For c0 = 1 4e 6(1 ? b?2)?d 2d(2d)!C? ?1/2, the lemma is true. 5.2.4. Proof of Lemma 5 Because X is Gaussian, the distribution of X equals that of 1/vn(X1,n +- - - + Xn,n), where the Xk,n are independent copies of X. The same is done for Y . E(f (X) ? f (Y)) =n k=1 f Zk + Xk,n/vn? f Zk + Yk,n/vn, with Zk = (X1,n + - - - + Xk?1,n + Yk+1,n + - - - + Yn,n)/vn. Using the Taylor expansion
EMPIRICAL CENTRAL LIMIT THEOREM 227 E(f (X) ? f (Y)) = n k=1 1 2nE(f (2)(0) - (Xk,n,Xk,n) ? f (2)(0) - (Yk,n, Yk,n)) + (56) + 1 6n3/2E(f (3)(Vk,n) - (Xk,n,Xk,n,Xk,n) ? ?f (3)(Wk,n) - (Yk,n, Yk,n, Yk,n)), (57) where Vk,n and Wk,n are two random vectors. The term (57) tends to 0, as n tends to infinity, because f (3) is uniformly bounded. E(f (2)(0) - (Xk,n,Xk,n) ? f (2)(0) - (Yk,n, Yk,n)) = m i,j=1 E ?2f (0) ?xi?xj (XiXj ? Y iY j )= m i,j=1 ?2f (0) ?xi?xj (Mi,j ? Ni,j ), so that |E(f (X) ? f (Y))| m?1/2??2M ? N1. References Bernstein, S.: Quelques remarques sur le th?eor`eme limite Liapounoff, C. R. (Dokl.) Acad. Sci. URSS, Ser. 24 (1939), 3-8. Billingsley, P.: Probability and Measure, Wiley, 1968. Doukhan, P. and Portal, F.: Moments de variables al?eatoires m?elangeantes, C.R. Acad. Sci. Paris, S?erie I, 297 (1983), 129-132. Doukhan, P. and Portal, F.: Principe d'invariance faible pour la fonction de r?epartition empirique dans un cadre multidimensionnel et m?elangeant, Probab. Math. Stat. 8 (1987), 117-132. Doukhan, P., Le?on, J. and Portal, F.: Vitesse de convergence dans le th?eor`eme central limite pour des variables al?eatoires m?elangeantes dans un espace de Hilbert. Note C.R.A.S., S?erie 1, t.298 (1984), 305-308. Doukhan, P., Le?on, J. and Portal, F.: Calcul de la vitesse de convergence dans le th?eor`eme central limite vis a vis des distances de Prohorov, Dudley et L?evy dans le cas de variables al?eatoires d?ependantes, Probab. Math. Stat. 6 (1985), 19-27. Doukhan, P. and Louhichi, S.: A new weak dependence condition and application to moment inequalities, Stoch. Proc. Appl. 84 (1999), 313-342. Doukhan, P. and Louhichi, S.: Estimation de la densit?e d'une suite faiblement d?ependante, C. R. Acad. Sci. Paris, S?erie I 327 (12) (1998), 989-992. Doukhan, P.: Mixing: Properties and Examples, Lecture Notes in Statist. 85, Springer Verlag, New York, 1994. Duflo, M.: M?ethodes r?ecursives al?eatoires, Masson, Paris, 1990. Leadbetter, M. R., Lindgren, G. and Rootz?en, H.: Extremes and Related Properties of Random Sequences and Processes, Springer-Verlag, New York, 1983. Newman, C. M.: Asymptotic independence and limit theorems for positively and negatively dependent random variables. In: Y. L. Tong (ed.), Inequalities in Statistics and Probability, I.M.S. Lecture Notes-Monograph Series 5, 1984, pp. 127-140.
228 PAUL DOUKHAN AND GABRIEL LANG Pollard, D.: Convergence of Stochastic Processes, Springer-Verlag, New York, 1984. Rosenblatt, M.: A central limit theorem and a strong mixing condition, Proc. Nat. Acad. Sci. U.S.A. 42 (1956), 43-47. Rosenblatt, M.: Stochastic Curve Estimation, NSF-CBMS Regional Conference Series in Probability and Statistics, 3, IMS ASA, 1991. Stroock, D.W.: An Introduction to the Theory of Large Deviations, Springer-Verlag, New York, 1984. Tong, H.: A note on a Markov bilinear stochastic process in discrete time, J. Time Series Anal. 2 (1981), 279-284. Tran, L. T.: Kernel density estimation on random fields, J. Multivar. Anal. 34 (1990), 37-53. Tran, L. T. and Yakowitz, S.: Nearest neighbor estimators for random fields, J. Multivar. Anal. 44 (1993), 23-46.