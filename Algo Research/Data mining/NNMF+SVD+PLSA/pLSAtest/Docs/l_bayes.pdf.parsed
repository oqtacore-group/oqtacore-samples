
Â. Â. Ñòðèæîâ. ¾Èíôîðìàöèîííîå ìîäåëèðîâàíèå?. Êîíñïåêò ëåêöèé, ÷åðíîâèê. Äâóõóðîâíåâûé Áàéåñîâñêèé âûâîä è ñðàâíåíèå ìîäåëåé Áàéåñîâñêèé âûâîä, êðàòêàÿ ñïðàâêà Óñëîâíàÿ âåðîÿòíîñòü P(DjH) åñòü âåðîÿòíîñòü ñîáûòèÿ D ïðè óñëîâèè íàñòóïëå-íèÿ ñîáûòèÿ H. Èç âñåõ ýëåìåíòîâ ìíîæåñòâà ýëåìåíòàðíûõ ñîáûòèé, ïðèíàäëå-æàùèõ H âõîäÿò â D ëèøü òå ñîáûòèÿ, êîòîðûå ïðèíàäëåæàò ïåðåñå÷åíèþ H è D. Ýòè ýëåìåíòû îïðåäåëÿþò P(DjH). Íî, åñëè áû H áûëî íîðìèðîâàíî, òî P(DjH) ðàâíÿëîñü áû P(HD). Ïîýòîìó, ÷òîáû óñëîâíàÿ âåðîÿòíîñòü îòâå÷àëà óñëîâèÿì íîð-ìèðîâêè, èñïîëüçóþò íîðìèðóþùèé ìíîæèòåëü: P(DjH) = P(HD) P(H) : Ôîðìóëà óìíîæåíèÿ âåðîÿòíîñòåé P(HD) = P(DjH)P(H): Ðàçáèåíèå ìíîæåñòâà íà ïîëíóþ ãðóïïó íåñîâìåñòèìûõ ñîáûòèé H1; : : : ;Hn ïîçâî-ëÿåò ëþáîå ñîáûòèå D çàïèñàòü â âèäå D = DH1 + + DHn; îòêóäà P(D) = P(DjH1)P(H1) + + P(DjHn)P(Hn) (1) Ïóñòü P(H); P(D) > 0. Òîãäà èç P(HD) = P(HjD)P(D) = P(DjH)P(H) âûòåêàåò P(HjD) = P(DjH)P(H) P(D) ; ÷òî ïîñëå ó÷åòà (1) ïðè âîäèò ê ôîðìóëå Áàéåñà P(HijD) = P(DjHi)P(Hi) Pn j=1 P(DjHj)P(Hj) : 1
Ñðàâíåíèå ìîäåëåé îòíîøåíèå àïîñòåðèîðíûõ âåðîÿòíîñòåé Áðèòâà Îêêàìà1 ïðèíöèï ïðåäïî÷òåíèÿ ïðîñòûõ ìîäåëåé (òåîðèé) ñëîæíûì. Åñ-ëè íåñêîëüêî ìîäåëåé îäèíàêîâî õîðîøî îïèñûâàþò íàáëþäåíèÿ, ïðèíöèï Îêêàìà ðåêîìíåäóåò âûáîð ïðîñòåéøåé ìîäåëè. Ìû áóäåì ïîëüçîâàòüñÿ ñëåäóþùåé ôîðìóëèðîâêîé ïðàâèëà áðèòâû Îêêàìà: Ñîâ- ìåñòíûé Áàéåñîâñêèé âûâîä àâòîìàòè÷åñêè êîëè÷åñòâåííî âûïîëíÿåò ïðàâèëî Îê- êàìà. Ðèñóíîê 1 äàåò èíòóèòèâíîå ïðåäñòàâëåíèå î òîì, ïî÷åìó áîëåå ñëîæíûå ìîäå-ëè ÿâëÿþòñÿ ìåíåå ïðàâäîïîäîáíûìè. Îñü àáñöèññ ÿâëÿåòñÿ ïðåäïîëàãàåìûì ïðî-ñòðàíñòâîì äàííûõ D. Òåîðåìà Áàéåñà ãîâîðèò î òîì, ÷òî íàèáîëåå âåðîÿòíûìè áó-äóò òå ìîäåëè, êîòîðîå íàèáîëåå òî÷íî ïðåäñêàçûâàþò ïîÿâëåíèå íåêîòîðûõ äàííûõ. Ýòà âåðîÿòíîñòü îïðåäåëÿåòñÿ íîðìàëèçîâàííîé ôóíêöèåé ðàñïðåäåëåíèÿ âåðîÿòíî-ñòè íà ïðîñòðàíñòâå D. Âåðîÿòíîñòü P(DjHi) ïîÿâëåíèÿ äàííûõ D ïðè ôèêñèðîâàí-íîé ìîäåëè Hi íàçûâàåòñÿ ïðàâäîïîäîáèåì ìîäåëè Hi. Ïðîñòàÿ ìîäåëü H1 îïèñûâà-Ðèñ. 1. Ïðàâäîïîäîáèå äâóõ ìîäåëåé åò îãðàíè÷åííîå ìíîæåñòâî äàííûõ, ÷òî ïîêàçàíî íà ðèñóíêå ôóíêöèåé ðàñïðåäåëå-íèÿ P(DjH1). Áîëåå ñëîæíàÿ ìîäåëü H2, èìåþùàÿ, íàïðèìåð, áîëüøåå êîëè÷åñòâî ïàðàìåòðîâ, îïèñûâàåò (èíà÷å ãîâîðÿ, ïðèáëèæàåò ñ íåêîòîðîé òî÷íîñòüþ, íå õóæå çàäàííîé) áîëüøåå ìíîæåñòâî äàííûõ. Ýòî, ñîãëàñíî íîðìèðîâàíèþ, îçíà÷àåò, ÷òî â íåêîòîðîé îáëàñòè C1 ïðîñòàÿ ìîäåëü H1 áóäåò áîëåå âåðîÿòíîé ïðè óñëîâèè, ÷òî îáå ìîäåëè èìåþò îäèíàêîâóþ àïðèîðíóþ âåðîÿòíîñòü. Íàéäåì ïðàâäîïîäîáèå äâóõ àëüòåðíàòèâíûõ ìîäåëåé H1 è H2, îïèñûâàþùèõ äàí-íûå D. Ïî òåîðåìå Áàéåñà ìû ñâÿçûâàåì ïðàâäîïîäîáèå P(H1jD) ìîäåëè H1 ïðè ôèêñèðîâàííûõ äàííûõ, âåðîÿòíîñòü P(DjH1) ïîëó÷åíèÿ äàííûõ ñ ýòîé ìîäåëüþ è àïðèîðíîå ïðàâäîïîäîáèå P(H1) ìîäåëè H1. Òàê êàê çíà÷åíèå íîðìèðóþùåãî ìíîæè-òåëÿ P(D) = Pn j=1 P(DjHj)P(Hj) äëÿ îáîèõ ìîäåëåé îäèíàêîâî, òî îòíîøåíèå ïðàâäî-ïîäîáèÿ ìîäåëåé H1 è H2 èìååò âèä P(H1jD) P(H2jD) = P(H1)P(DjH1) P(H2)P(DjH2) : (2) Îòíîøåíèå P(H1) P(H2) â ïðàâîé ÷àñòè óêàçûâàåò íà òî, íàñêîëüêî âåëèêî àïðèîðíîå ïðåä-ïî÷òåíèå ìîäåëè P(H1) ìîäåëè P(H2). Îòíîøåíèå P(DjH1) P(DjH2) óêàçûâàåò íàñêîëüêî ìî-äåëü H1 ñîîòâåòñòâóåò íàáëþäàåìûì äàííûì ëó÷øå, ÷åì ìîäåëü H2. Âûðàæåíèå (2) ââîäèò ïðàâèëî Îêêàìà ñëåäóþùèì îáðàçîì. Âî-ïåðâûõ, âîçìîæ-íî çàäàòü îòíîøåíèå P(H1) P(H2) òàê, ÷òîáû îíî îòðàæàëî ñëîæíîñòü ìîäåëåé íà îñíîâàíèè 1Óèëüÿì Îêêàì àíãëèéñêèé ôèëîñîô-ñõîëàñò, ëîãèê è öåðêîâíî-ïîëèòè÷åñêèé ïèñàòåëü (îê. 12851349), àâòîð ïðèíöèïà: ¾íå óìíîæàé ñóùíîñòè áåç íåîáõîäèìîñòè?. 2
íåêîòîðîé äîïîëíèòåëüíîé èíôîðìàöèè èëè èç äðóãèõ ñîîáðàæåíèé. Âî-âòîðûõ, íåçà-âèñèìî îò ïðåäûäóùåãî ñïîñîáà çàäàíèÿ êðèòåðèÿ îòáîðà ìîäåëåé, ýòî îòíîøåíèå àâòîìàòè÷åñêè âûïîëíÿåò ïðàâèëî Îêêàìà. Äåéñòâèòåëüíî, åñëè H2 áîëåå ñëîæ-íàÿ ìîäåëü, åå ïëîòíîñòü ðàñïðåäåëåíèÿ P(DjH2) èìååò ìåíüøèå çíà÷åíèÿ, ïðè òîì óñëîâèè, ÷òî åå äèñïåðñèÿ áîëüøå. Åñëè äàííûå ñîîòâåñòâóþò ðàñïðåäåëåíèÿì îáå-èõ ìîäåëåé (èíà÷å, íåâÿçêè, äîñòàâëÿåìûå îáåèìè ìîäåëÿìè ñðàâíèìû), ïðîñòàÿ ìî-äåëü H1 áóäåò áîëåå âåðîÿòíà, ÷åì ñëîæíàÿ ìîäåëü H2. Òàêèì îáðàçîì, íåçàâèñèìî îò àïðèîðíûõ ïðåäïî÷òåíèé, ââîäèòñÿ ïðàâèëî Îêêàìà, ñîãëàñíî êîòîðîìó ïðè ðàâíûõ àïðèîðíûõ ïðåäïî÷òåíèÿõ è ðàâíîì ñîîòâåòñòâèè ïðåäïîëàãàåìûõ ìîäåëåé èçìåðÿå-ìûì äàííûì, ïðîñòàÿ ìîäåëü áîëåå âåðîÿòíà, ÷åì ñëîæíàÿ. Ïðèìåð âû÷èñëåíèÿ ïðàâäîïîäîáèÿ ïðîñòûõ ìîäåëåé Ðàññìîòðèì ïîñëåäîâàòåëüíîñòü 􀀀1; 3; 7; 11: Òðåáóåòñÿ ïðåäñêàçàòü ñëåäóþùèå äâà ÷èñëà è íàéòè çàêîíîìåðíîñòü ïîñëåäîâà-òåëüíîñòè. Ïåðâûé âàðèàíò: 15; 19. Çàêîíîìåðíîñòü Ha åñòü ïîñëåäóþùåå ÷èñëî åñòü ïðåäûäóùåå ïëþñ 4, èíà÷å xi+1 = xi + 4. Âòîðîé âàðèàíò: 􀀀19:9; 1043:8. Çàêîíîìåð-íîñòü Hc åñòü xi+1 = 􀀀x3i=11 + 9=11x2i+ 23=11. Ñ îäíîé ñòîðîíû, âîçìîæíî íåïîñðåäñòâåííî íàçíà÷èòü àïðèîðíûå âåðîÿòíîñòè äëÿ îáåèõ ìîäåëåé òàê, ÷òîáû øòðàôîâàòü áîëåå ñëîæíóþ ìîäåëü. Ñ äðóãîé ñòîðî-íû, âîçìîæíî âû÷èñëèòü èõ ïðàâäîïîäîáèå, P(DjHa) è P(DjHc) ÷òîáû îïðåäåëèòü, íàñêîëüêî õîðîøî îáå ôóíêöèè îïèñûâàþò äàííûå. Ìîäåëü Ha çàâèñèò îò äâóõ ïàðàìåòðîâ: äîáàâëÿåìîãî ÷èñëà n è îò ïåðâîãî ÷èñ-ëà â ïîñëåäîâàòåëüíîñòè. Ïóñòü êàæäûé èç ýòèõ ïàðàìåòðîâ ïðèíàäëåæèò ìíîæå-ñòâó f􀀀50; :::; 50g Z. Òàê êàê òîëüêî ïàðà çíà÷åíèé (n = 4; x1 = 􀀀1) äîñòàâëÿþò ôóíêöèþ, ñîîòâåòñòâóþùóþ äàííûì D = f􀀀1; 3; 7; 11g, òî âåðîÿòíîñòü ïîÿâëåíèÿ äàííûõ D ïðè çàäàííîé ìîäåëè Ha ðàâíà P(DjHa) = 1 101 1 101 = 0:00010: Äëÿ òîãî, ÷òîáû âû÷èñëèòü P(DjHc), òðåáóåòñÿ âû÷èñëèòü âåðîÿòíîñòü ïàðàìåòðîâ c; d; e â êóáè÷åñêîì ìíîãî÷ëåíå Hc. Ýòè ïàðàìåòðû ïðåäñòàâëåíû ñ âèäå ðàöèîíàëüíûõ ÷èñåë (â ïðîòèâíîì ñëó÷àå îáå ýòè ìîäåëè áûëè áû íåñðàâíèìû). Ïóñòü ÷èñëèòåëè ïàðàìåòðîâ, òàê æå êàê è â ïðåäûäóùåì ñëó÷àå, ïðèíèìàþò çíà÷åíèÿ èç ìíîæåñòâà f􀀀50; :::; 50g à çíàìåíàòå-ëè èç ìíîæåñòâà f1; :::; 50g. Ïðè âû÷èñëåíèè âåðîÿòíîñòè ïðèíèìàåòñÿ âî âíèìà-íèå, ÷òî íåñêîëüêî ñïîñîáîâ ïðåäñòàâèòü äðîáü íà çàäàííûõ ìíîæåñòâàõ. Íàïðèìåð, c = 􀀀1=11 = 􀀀2=22 = 􀀀3=33 = 􀀀4=44. Âåðîÿòíîñòü P(DjHc) ðàâíà P(DjHc) = 1 1014 101 1 504 101 1 502 101 1 50= 0:0000000000025 = 2:5 10􀀀12: 3
Îòíîøåíèå ïðàâäîïîäîáèÿ äâóõ ìîäåëåé (à çíà÷èò è èõ àïîñòåðèîðíûõ âåðîÿòíî-ñòåé ïðè óñëîâèè ðàâåíñòâà àïðèîðíûõ ïðåäïî÷òåíèé), P(DjHa) = 0:00010 è P(DjHa) = 2:510􀀀12 ñîñòàâëÿåò îäíó ñîðîêàìèëëèîííóþ. Ðèñ. 2. Èñïîëüçîâàíèå Áàéåñîâñêîãî âûâîäà äëÿ ïîèñêà ìîäåëåé Äâà óðîâíÿ Áàéåñîâñêîãî âûâîäà Ïðè ñîçäàíèè ìîäåëåé ðàçëè÷àþò äâà óðîâíÿ Áàéåñîâñêîãî âûâîäà. Íà ïåðâîì óðîâíå ïðåäïîëàãàåòñÿ, ÷òî ðàññìàòðèâàåìàÿ ìîäåëü àäåêâàòíà. Ïðîèçâîäèòñÿ íàñòðîéêà ïà-ðàìåòðîâ ìîäåëè ïî äàííûì. Â ðåçóëüòàòå ïîëó÷àþòñÿ íàèáîëåå ïðàâäîïîäîáíûå çíà-÷åíèÿ ïàðàìåòðîâ è çíà÷åíèÿ îøèáîê ìîäåëåé ïðè ýòèõ ïàðàìåòðàõ. Ýòà ïðîöåäóðà ïîâòîðÿåòñÿ äëÿ êàæäîé ìîäåëè. Çàäà÷à, ðåøàåìàÿ íà âòîðîì óðîâíå âûâîäà ñðàâ-íåíèå ìîäåëåé. Ðåçóëüòàòîì ÿâëÿåòñÿ óïîðÿäî÷åííîå ìíîæåñòâî ìîäåëåé. Íà ðèñóí-êå 3 ïåðâûé è âòîðîé óðîâåíü âûâîäà îáâåäåíû äâîéíîé ëèíèåé. Êàæäàÿ ìîäåëü Hi èìååò âåêòîð ïàðàìåòðîâ w. Çàäà÷à ïåðâîãî óðîâíÿ ïîëó÷èòü îöåíêó ïàðàìåòðîâ w ìîäåëè ïðè ïîëó÷åííûõ äàííûõ D. Ñîãëàñíî òåîðåìå Áàéåñà, àïîñòåðèîðíàÿ âåðîÿòíîñòü ïàðàìåòðîâ w ðàâíà P(wjD;Hi) = P(Djw;Hi)P(wjHi) P(DjHi) ; (3) Íîðìèðóþùàÿ êîíñòàíòà P(DjHi) îáû÷íî íå ïðèíèìàåòñÿ âî âíèìàíèå íà ïåðâîì óðîâíå âûâîäà. Îäíàêî îíà ñòàíîâèòñÿ âåñüìà âàæíîé íà âòîðîì óðîâíå âûâîäà. Ýòà êîíñòàíòà íàçûâàåòñÿ â àíãëîÿçû÷íîé ëèòåðàòóðå evidenve òî åñòü äîñòîâåðíîñòü ìîäåëè. Ïðè îòûñêàíèè ïàðàìåòðîâ íà ïðàêòèêå îáû÷íî ïðèìåíÿþò îïòèìèçàöèîííûå ìå-òîäû òèïà ìåòîäà ñîïðÿæåííûõ ãðàäèåíòîâ, ÷òîáû ïîëó÷èòü íàèáîëåå âåðîÿòíûå2 ïàðàìåòðû wMP. Îøèáêà (èíîãäà íàçûâàåìàÿ ïðîãíîñòè÷åñêîé ñïîñîáíîñòüþ) ìîäåëè H îöåíèâàåò-ñÿ ÷åðåç êðèâóþ àïîñòåðèîðíîãî ðàñïðåäåëåíèÿ. Äëÿ îöåíêè îòûñêèâàåòñÿ çíà÷åíèå ãåññèàíà ïðè çíà÷åíèè âåñîâ ìàêñèìàëüíîãî ïðàâäîïîäîáèÿ wMP â îêðåñíîñòè wMP: A = 􀀀r2lnP(wjD;Hi)jwMP è âû÷èñëÿåòñÿ ïðèáëèæåíèå ðÿäîì Òåéëîðà ëîãàðèôìà àïîñòåðèîðíîãî ðàñïðåäåëå-íèÿ ôóíêöèè P(wjD;Hi) P(wjD;Hi)tP(wMPjD;Hi) exp(􀀀12wTAw)); 2Ðàçëè÷àþò íàèáîëåå âåðîÿòíûå ïàðàìåòðû wMP âûâîäÿòñÿ íà ïåðâîì óðîâíå êàê àðãóìåíò ôóíê-öèè âåðîÿòíîñòè è íàèáîëåå ïðàâäîïîäîáíûå ïàðàìåòðû wML , êîòîðûå îòûñêèâàþòñÿ êàê àðãóìåíò ôóíêöèè íàèáîëüøåãî ïðàâäîïîäîáèÿ. 4
Ïîëó÷åíèå äàííûõ Ñîçäàíèå àëüòåðíàòèâíûõ ìîäåëåé @􀀀 Íàñòðîèòü êàæäóþ ìîäåëü ïî äàííûì @􀀀 Íàçíà÷èòü ïðåäïî÷òåíèÿ àëüòåðíàòèâíûì ìîäåëÿì Âûáðàòü êàêèå äàííûå íóæíû äîïîëíèòåëüíî Ïîëó÷èòü íîâûå äàííûå Ðåøèòü åñòü ëè íåîáõîäèìîñòü â íîâûõ ìîäåëÿõ Ñîçäàòü íîâûå ìîäåëè Âûáðàòü ñëåäóþùèå äåéñòâèÿ 6- 6@@@R 􀀀 􀀀􀀀 ? Ðèñ. 3. Èñïîëüçîâàíèå Áàéåñîâñêîãî âûâîäà ïðè ñîçäàíèè ìîäåëåé w = w􀀀wMP. Òàêèì îáðàçîì, ôóíêöèÿ àïîñòåðèîðíîãî ðàñïðåäåëåíèÿ ìîæåò áûòü ëîêàëüíî ïðèáëèæåíà, ñ ïîìîùüþ ìàòðèöû A􀀀1, êîòîðàÿ ÿâëÿåòñÿ ìàòðèöåé êîâàðè-àöèè ïàðàìåòðîâ ìîäåëè Hi â îêðåñíîñòè çíà÷åíèÿ ïàðàìåòðîâ wMP. Íà âòîðîì óðîâíå âûâîäà òðåáóåòñÿ îïðåäåëèòü, êàêàÿ ìîäåëü íàèáîëåå àäåêâàòíî îïèñûâàåò äàííûå. Àïîñòåðèîðíàÿ âåðîÿòíîñòü i-é ìîäåëè çàäàíà êàê P(HijD)/P(DjHi)P(Hi): (4) Ñëåäóåò îòìåòèòü, ÷òî ñîìíîæèòåëü P(DjHi), âêëþ÷àþùèé äàííûå D, åñòü ïðàâ-äîïîäîáèå ìîäåëè Hi, êîòîðàÿ áûëà íàçâàíà ðàíåå, â âûðàæåíèè (3), íîðìèðóþùåé êîíñòàíòîé. Âòîðîé ñîìíîæèòåëü P(Hi) àïðèîðíàÿ âåðîÿòíîñòü íàä ïðîñòðàíñòâîì ìîäåëåé, îïðåäåëÿåò, íàñêîëüêî àäåêâàòíîé3 ÿâëÿåòñÿ ìîäåëü äî òîãî, êàê ïîÿâèëèñü äàííûå. Îñíîâíîé ïðîáëåìîé Áàéåñîâñêîãî âûâîäà ÿâëÿåòñÿ îòñóòñòâèå îáúåêòèâ-íûõ ìåòîäîâ íàçíà÷åíèÿ àïðèîðíîé âåðîÿòíîñòè P(Hi). Ïóòü àïðèîðíûå âåðîÿòíî-ñòè P(Hi) âñåõ ìîäåëåé ðàâíû. Òîãäà ìîäåëè ðàíæèðóþòñÿ ïî çíà÷åíèÿì ïðàâäîïî-äîáèÿ P(DjHi). 3Ñîîòâåòñòâóþùèé àíãëèéñêèé òåðìèí plausible) 5
Ïðàâäîïîäîáèå ìîäåëè4 íîðìèðóþùàÿ êîíñòàíòà â âûðàæåíèè (3) P(DjHi) = Z P(Djw;Hi)P(wjHi)dw: ×ðåçâû÷àéíî âàæíîå ïðåäïîëîæåíèå, êîòîðîå íåîáõîäèìî ñäåëàòü äëÿ ðåøåíèÿ çàäà÷è âû÷èñëåíèÿ ïðàâäîïîäîáèÿ, ïðåäïîëîæåíèå î òîì, ÷òî ðàñïðåäåëåíèå P(wjD;Hi)/P(Djw;Hi)P(wjHi) èìååò âûðàæåííûé ïèê â îêðåñòíîñòè íàèáîëåå âå-ðîÿòíîãî çíà÷åíèÿ wMP. Íà ðèñ. 4 ïîêàçàíî, êàê âû÷èñëÿåòñÿ ìíîæèòåëü Îêêàìà äëÿ ìîäåëè Hi ñ åäèíñòâåííûì ïàðàìåòðîì w íà îñè àáñöèññ. Ñïëîøíîé ëèíèåé ïîêàçàíî àïðèîðíîå ðàñïðåäåëåíèå ïàðàìåòðà ñ äèñïåðñèåé w. Àïîñòåðèîðíîå ðàñïðåäåëåíèå ïîêàçàíî ïóíêòèðíîé ëèíèåé èìååò åäèíñòâåííûé ìàêñèìóì â òî÷êå wMP è èìååò äèñïåðñèþ wjD. wMP wjD w w P(wjHi) P(wjD;Hi) Ðèñ. 4. Ìíîæèòåëü Îêêàìà îòíîøåíèå wjDP(wMPjHi) = wjD w Ôóíêöèþ ðàñïðåäåëåíèÿ âåðîÿòíîñòè ïàðàìåòðîâ ìîäåëè ïðèáëèæàþò ãàóññèàíîé, îïðåäåëåííîé â ïðîñòðàíñòâå ïàðàìåòðîâ. Äëÿ ýòîãî èñïîëüçóþò ìåòîä Ëàïëàñà, êîòî-ðûé îïèñàí íèæå. Ñîãëàñíî ìåòîäó, ýòà ôóíêöèÿ ðàâíà âûñîòå ïèêà ïîäûíòåãðàëüíîãî âûðàæåíèÿ P(Djw;Hi)P(wjHi) óìíîæåííîé íà øèðèíó ïèêà, wjD. P(DjHi) t P| (Djw{Mz P;Hi}) P(wMPjHi) wjD | {z }; äîñòîâåðíîñòü t íàèáîëüøåå ïðàâäîïîäîáèå ìíîæèòåëü Îêêàìà: (5) Òàêèì îáðàçîì, äîñòîâåðíîñòü ìîäåëè íàõîäèòñÿ ñ ïîìîùüþ îöåíîê íàèáîëüøåãî ïðàâäîïîäîáèÿ ïàðàìåòðîâ ìîäåëè è ìíîæèòåëÿ Îêêàìà, ïðèíèìàþùåãî çíà÷åíèÿ íà îòðåçêå [0; 1], êîòîðûé øòðàôóåò ìîäåëü Hi çà åå ïàðàìåòðû w. ×åì òî÷íåå áûëà àïðèîðíàÿ îöåíêà ïàðàìåòðîâ, òåì ìåíüøå øòðàô. Ïðè àïïðîêñèìàöèè Ëàïëàñà ìíîæèòåëü Îêêàìà ìîæåò áûòü ïîëó÷åí ñ ïîìîùüþ îïðåäåëèòåëÿ êîâàðèàöèîííîé ìàòðèöû âåñîâ P(DjHi) t P(DjwMP;Hi)P(wMPjHi)det􀀀12 (A=2); 4Íåêîòîðûå àâòîðû ïåðåâîäÿò òåðìèí ïðàâäîïîäîáèå ìîäåëè êàê äîñòîâåðíîñòü. Ýòîò òåðìèí áîëåå òî÷íî ïåðåäàåò ïðÿìîå çíà÷åíèå ñëîâà evidnece, íî ïðè ýòîì îïóñêàåò ðîëü ïðèíöèïà íàè-ìåíüøåãî ïðàâäîïîäîáèÿ, êîòîðûé èñïîëüçóåòñÿ ïðè âûâîäå ñîìíîæèòåëåé P(Djw;Hi) è P(DjHi) íà ïåðâîì è âòîðîì óðîâíå âûâîäà. 6
ãäå A = 􀀀r2lnP(wjD;Hi) ãåññèàí êîâàðèàöèîííîé ìàòðèöû âåñîâ, âû÷èñëåííûé â òî÷êå wMP. Àãëîðèòìè÷åñêè, Áàéåñîâñêèé ìåòîä ñðàâíåíèÿ ìîäåëåé ïîñðåäñòâîì âû÷èñëåíèÿ äîñòîâåðíîñòè íå ñëîæíåå, ÷åì çàäà÷à íàñòðîéêè ïàðàìåòðîâ êàæäîé ìî-äåëè è îöåíêè ìàòðèöû Ãåññå. Èòàê, äëÿ òîãî, ÷òîáû îòðàíæèðîâàòü àëüòåðíàòèâíûå ìîäåëè Hi ïî ïðåäïî-÷òåíèþ íåîáõîäèìî, âîñïîëüçîâàâøèñü Áàéåñîâñêèì âûâîäîì, âû÷èñëèòü äîñòîâåð-íîñòü P(DjHi). Áàéåñîâñêîå ñðàâíåíèå ìîäåëåé ýòî ðàñøèðåíèå ìåòîäà âûáîðà ìî-äåëåé ïî ìåòîäó íàèáîëüøåãî ïðàâäîïîäîáèÿ. Ñëåäóåò îòìåòèòü, ÷òî äîñòîâåðíîñòü âîçìîæíî âû÷èñëèòü êàê äëÿ ïàðàìåòðè÷åñêèõ, òàê è äëÿ íåïàðàìåòè÷åñêèõ ìîäåëåé, à òàêæå ïðè ðåøåíèè ðàçëè÷íûõ çàäà÷ êëàññèôèêàöèè, ðåãðåññèè, îöåíêå ôóíêöèè ïëîòíîñòè ðàñïðåäåëåíèÿ. Ïðèìåð èíòåïðåòàöèè ìíîæèòåëÿ Îêêàìà Ïåðåìåííàÿ wjD ÿâëÿåòñÿ àïîñòåðèîðíîé íåîïðåäåëåííîñòüþ âåêòîðà ïàðàìåòðîâ w. Ïóñòü àïðèîðíîå ðàñïðåäåëåíèå P(wjHi) ÿâëÿåòñÿ ðàâíîìåðíûì íà íåêîòîðîì áîëü-øîì èíòåðâàëå w è îòðàæàåò ìíîæåñòâî çíà÷åíèé, êîòîðûå áûëè âîçìîæíû àïðèîðè, ñîãëàñíî ìîäåëè Hi. Òîãäà P(wMPjHi) = 1=w è ìíîæèòåëü Îêêàìà = wjD w : Ìíîæèòåëü Îêêàìà åñòü ñòåïåíü ñæàòèÿ ïðîñòðàíñòâà ïàðàìåòðîâ ìîäåëè ïðè ïî-ÿâëåíèè äàííûõ. Ìîäåëü Hi ìîæåò áûòü ïðåäñòàâëåíà ñåìåéñòâî ïàðàìåòðè÷åñêèõ ôóíêöèé, èç êîòîðûõ îñòàåòñÿ òîëüêî îäíà, êàê òîëüêî ïîÿâëÿþòñÿ äàííûå. Ìíîæè-òåëü åñòü ÷èñëî, îáðàòíîå êîëè÷åñòâó òàêèõ ôóíêöèé. Ëîãàðèôì ìíîæèòåëÿ Îêêàìà åñòü åñòü ìåðà êîëè÷åñòâà èíôîðìàöèè î ïàðàìåòðàõ ìîäåëè, êîòîðàÿ áóäåò ïîëó÷åíà ïðè ïîÿâëåíèè äàííûõ. Íà ðèñóíêå 5 ïîêàçàíû òðè ìîäåëè, H1;H2 è H3, êîòîðûå èìåþò ðàâíûå àïðè-îðíûå âåðîÿòíîñòè. Êàæäàÿ ìîäåëü èìååò îäèí ïàðàìåòð w (ïîêàçàí íà îñÿõ àáñ-öèññ), ïðè÷åì ïàðàìåòðàì íàçíà÷åíû ðàçëè÷íûå àïðèîðíûå îáëàñòè îïðåäåëåíèÿ W. Ìîäåëü H3 íàèáîëåå ãèáêàÿ, èëè ñëîæíàÿ, ñ íàèáîëüøåé àïðèîðíîé îáëàñòüþ îïðåäåëåíèÿ. Îäíîìåðíîå ïðîñòðàíñòâî äàííûõ ïîêàçàíî íà îñè îðäèíàò. Äëÿ êàæ-äîé ìîäåëè íàçíà÷åíî ñîâìåñòíîå ðàñïðåäåëåíèå âåðîÿòíîñòè P(D;wjHi) äëÿ äàííûõ è äëÿ ïàðàìåòðîâ. Ðàñïðåäåëåíèå ïîêàçàíî îáëàêàìè òî÷åê ñëó÷àéíûõ çíà÷åíèé ýòîé ôóíêöèè. ×èñëî òî÷åê äëÿ êàæäîé èç òðåõ ìîäåëåé îäèíàêîâî, òàê êàê ìîäåëÿì áûëè íàçíà÷åíû îäèíàêîâûå àïðèîðíûå âåðîÿòíîñòè. Êîãäà ïðèõîäÿò íàáîð äàííûõ D (â äàííîì ïðèìåðå ýòî îäíà åäèíñòâåííàÿ òî÷êà íà îñè îðäèíàò), âûâîäèòñÿ àïîñòåðèîðíîå ðàñïðåäåëåíèå ïàðàìåòðîâ ìîäåëåé. Àïî-ñòåðèîðíîå ðàñïðåäåëåíèå P(wjD;Hi) ïîêàçàíî ïóíêòèðíîé ëèíèåé âíèçó. Ñïëîøíîé ëèíèåé ïîêàçàíî àïðèîðíîå ðàñïðåäåëåíèå ïàðàìåòðîâ P(wjH3). Äëÿ íàáîðà äàííûõ D, ïîêàçàííûõ ïóíêòèðíîé ãîðèçîíòàëüíîé ëèíèåé, äîñòîâåð-íîñòü P(DjH3) íàèáîëåå ãèáêîé ìîäåëè H3 èìååò ìåíüøåå çíà÷åíèå, ÷åì äîñòîâåð-íîñòü ìîäåëè H2. Ýòî ïðîèñõîäèò èç-çà òîãî, ÷òî ìîäåëü H3 èìååò (ìåíüøåå êîëè÷å-7
w wjD P(wjH3) P(wjD;H3) P(wjH2) P(wjD;H2) P(wjH1) P(wjD;H1) P(DjH1) P(DjH2) P(DjH3) DD w w w Ðèñ. 5. Ïðîñòðàíñòâî äàííûõ è ïðîñòðàíñòâî ïàðàìåòðîâ òðåõ ìîäåëè ðàçëè÷íîé ñëîæíîñòè ñòâî òî÷åê) íà ýòîé ëèíèè. Â òåðìèíàõ ðàñïðåäåëåíèÿ ïàðàìåòðîâ, ìîäåëü H3 èìååò ìåíüøóþ äîñòîâåðíîñòü, òàê êàê ìíîæèòåëü Îêêàìà wjD=w äëÿ ìîäåëè H3 ìåíüøå, ÷åì äëÿ ìîäåëè H2. Ñàìàÿ ïðîñòàÿ ìîäåëü H1 èìååò ñàìóþ ìàëóþ äîñòîâåðíîñòü, òàê êàê õóæå âñåãî ïðèáëèæàåò äàííûå D. Ìîäåëü H3 ñëèøêîì óíèâåðñàëüíà, ìíîæè-òåëü Îêêàìà øòðàô çà óíèâåðñàëüíîñòü ìîäåëè âåëèê è ïîýòîìó îíà íå ÿâëÿåòñÿ ëó÷øåé. Äëÿ ïîëó÷åííîãî íàáîðà äàííûõ íàèáîëåå âåðîÿòíà ìîäåëü H2. Àïïðîêñèìàöèÿ Ëàïëàñà see Ïóñòü íåíîðìèðîâàííàÿ ôóíêöèÿ ïëîòíîñòè ðàñïðåäåëåíèÿ P (x), ñ íîðìèðóþùåé êîíñòàíòîé ZP Z P(x)x. èìååò ïèê (ëîêàëüíûé ìàêñèìóì) â òî÷êå x0. Ðÿä Òåéëîðà ëîãàðèôìà P(x) â îêðåñò-íîñòè ýòîãî ìàêñèìóìà èìååò âèä lnP(x) = ln P(x0) 􀀀 c2(x 􀀀 x0)2 + ; (6) 8
ãäå c = 􀀀 @2 @x2 ln P(x)x=x0 : Àïïðîêñèìàöèÿ P(x) íåíîðìèðîâàííûì ãàóññèàíîì èìååò âèä Q(x) P(x0) exp h􀀀c2(x 􀀀 x0)2i ; Àïïðîêñèìàöèÿ íîðìèðóþùåé êîíñòàíòû ZP ïîñðåäñòâîì íîðìèðóþùåé êîíñòàíòû ýòîãî ãàóññèàíà èìååò âèä ZQ = P(x0)r2c : Ýòîò (êàêîé) èíòåãðàë ìîæåò áûòü îáîáùåí äëÿ àïïðîêñèìàöè ZP äëÿ ïëîòíî-ñòè P(x) â K-ìåðíîì ïðîñòðàíñòâå x. Åñëè ìàòðèöà A âòîðûõ ïðîèçâîäíûõ ôóíêöèè 􀀀ln P(x) â ìàêñèìóìå x0 îïðåäå-ëåíà êàê Aij = 􀀀 @2 @xi@xj lnP(x)x=x0 ; òàê ÷òî ðàçëîæåíèå (6) îáîáùàåòñÿ êàê lnP(x) = lnP(x0) 􀀀 12(x 􀀀 x0)TA(x 􀀀 x0) + : Òîãäà íîðìèðóþùàÿ êîíñòàíòà àïïðîêñèìèðóåòñÿ êàê ZP ' ZQ = P(x0) 1 qdet 1 2A = P(x0)r(2)K detA: Äàëåå äëÿ îöåíêè P(x) èñïîëüçóåòñÿ ïðèáëèæåíèå Q(x) Òî, ÷òî íîðìèðóþùàÿ êîíñòàíòà Ãàóññèàíà, îïðåäåëåíà êàê Z dKx exp 􀀀12xTAx= r(2)K detA ìîæåò áûòü äîêàçàíî ïîñðåäñòâîì îðòîãîíàëüíîãî ïðåîáðàçîâàíèÿ â áàçèñ u, â êîòîðîì A ïðåîáðà-çóåòñÿ â äèàãîíàëüíóþ ìàòðèöó. Èíòåãðàë òîãäà ïðåäñòàâëÿåòñÿ â âèäå ïðîèçâåäåíèÿ èíòåãðàëîâ îò îäíîé ïåðåìåííîé, êàæäûé èç êîòîðûõ ïðåäñòàâëåí â âèäå Z dui exp 􀀀12iu2i = r2i : 9
Ïðîèçâåäåíèå ñîáñòâåííûõ çíà÷åíèé i åñòü äåòåðìèíàíò A. Àïïðîêñèìàöèÿ Ëàïëàñà çàâèñèò îò âûáîðà áàçèñà: åñëè âìåñòî ïåðåìåííîé x ïîä-ñòàâèòü íåëèíåéíóþ ôóíêöèþ u(x) è ôóíêöèþ ïëîòíîñòè ðàñïðåäåëåíèÿ ïðåîáðàçî-âàòü â P(u) = P(x) jdx=duj,òî, â îáùåì ñëó÷àå, àïïðîêñèìàöèÿ íîðìèðóþùèõ êîí-ñòàíò áóäåò ðàçëè÷íîé. Òàêîå ñâîéñòâî àïïðîêñèìàöèè Ëàïëàñà ìîæíî ñ÷èòàòü íåäî-ñòàòêîì, òàê êàê èñòèííîå çíà÷åíèå ZP çàâèñèìî îò áàçèñà, èëè ïðåèìóùåñòâîì, òàê êàê ïîÿâëÿåòñÿ âîçìîæíîñòü îòûñêèâàòü áàçèñ äëÿ áîëåå òî÷íîé àïïðîêñèìàöèè. 10