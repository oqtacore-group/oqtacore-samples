 Математические методы распознавания образов
Курс лекций
МГУ, ВМиК, кафедра "Математические методы прогнозирования"
c Местецкий Леонид Моисеевич, 2002-2004

1	Задача распознавания образов	4
1.1	Предмет распознавания образов	4
1.2	Признаки и классификаторы	4
1.3	Классификация с обучением и без обучения	6
1.4	Формальная постановка задачи классификации	7
2	Классификация на основе байесовской теории решений	8
2.1	Байесовский подход	8
2.2	Ошибка классификации	9
2.3	Минимизация среднего риска	10
2.4	Дискриминантные функции и поверхности решения	13
2.5	Байесовский классификатор для нормального распределения	13
2.5.1	Квадратичная поверхность решения	14
2.5.2	Линейная поверхность решения	15
2.5.3	Линейная поверхность решения с диагональной матрицей ковариации	16
2.5.4	Линейная поверхность решения с недиагональной матрицей ковариации	17
2.5.5	Классификаторы по минимуму расстояния	17
3	Линейный классификатор. Алгоритм персептрона	19
3.1	Линейная дискриминантная функция	19
3.2	Алгоритм персептрона	20
3.2.1	Математическая модель нейрона	20
3.2.2	Алгоритм персептрона	21
3.2.3	Сходимость алгоритма персептрона	21
3.2.4	Оптимизационная интерпретация	22
3.2.5	Схема Кеслера	23
4	Оптимальная разделяющая гиперплоскость	24
4.1	Существование и единственность	24
4.2	Построение оптимальной разделяющей гиперплоскости	25
4.3	Алгоритм Гаусса-Зейделя	27
5	Нелинейный классификатор. Многослойный персептрон	28
5.1	Задача исключающего ИЛИ	28
5.2	Классификационные способности двухслойного персептрона	29
5.3	Трехслойный персептрон	30
5.4	Построение нейронной сети	32
5.4.1	Алгоритм, основанные на точной классификации множества прецедентов.	32
5.4.2	Алгоритм ближайших соседей	33
5.4.3	Алгоритм, основанный на подборе весов для сети с заданной архитектурой	33
5.4.4	Алгоритм обратной волны	34
6	Метод потенциальных функций	37
6.1	Общая рекуррентная процедура	38
6.2	Выбор системы функций	40
6.3	Сходимость общей рекуррентной процедуры	41
6.4	Функции Эрмита	42
7	КОМИТЕТНЫЕ МЕТОДЫ РЕШЕНИЯ ЗАДАЧ РАСПОЗНАВАНИЯ	43
7.1	Теоретико-множественная постановка задачи выбора алгоритма.	43
7.2	Комитеты	43
7.3	Комитеты линейных функционалов	45
7.4	Функция Шеннона	47
8	Классификация на основе сравнения с эталоном.	50
8.1	Мера близости, основанная на поиске оптимального пути на графе	50
8.2	Задача сравнения контуров	51
8.3	Задача сравнения речевых команд	52
8.4	Динамическое программирование	53
9	КОНТЕКСТНО-ЗАВИСИМАЯ КЛАССИФИКАКЦИЯ	54
9.1	Постановка задачи	54
9.2	Байесовский классификатор	54
9.3	Модель Марковской цепи	54
9.4	Алгоритм Витерби (Viterbi)	55
9.5	Скрытые Марковские модели	56
10	СЕЛЕКЦИЯ ПРИЗНАКОВ	58
10.1	Задача селекции признаков	58
10.1.1	Постановка задачи селекции признаков.	58
10.1.2	Общность классификатора.	58
10.2	Предобработка векторов признаков	59
10.3	Селекция на основе проверки статистических гипотез	59
10.3.1	Постановка задачи	59
10.3.2	Общая теория проверки гипотез	60
10.3.3	Приложение к селекции признаков	61
10.3.4	Мера различия плотностей признаков	61
10.4	Векторная селекция признаков. Мера отделимости классов	63
10.4.1	Дивергенция	63
10.4.2	Мера на основе матриц рассеивания	64
10.4.3	Стратегия наращивания вектора признаков	65
10.4.4	Стратегия сокращения вектора признаков	65
10.4.5	Выбор стратегии	65
10.4.6	Алгоритм плавающего поиска	65
10.5	Оптимальная селекция признаков	66
10.6	Оптимальная селекция признаков с помощь нейронной сети	68
11	МЕТОДЫ ГЕНЕРАЦИИ ПРИЗНАКОВ	69
11.1	Генерация признаков на основе линейных преобразований	69
11.1.1	Базисные вектора	69
11.1.2	Случай двумерных образов	69
11.2	Преобразование Карунена-Лоева	70
11.2.1	Свойства преобразования Карунена-Лоева	70
11.2.2	Применение преобразования Карунена-Лоева к задаче классификации	71
11.2.3	Декомпозиция сингулярных значений	71
11.3	Дискретное преобразование Фурье (ДПФ)	72
11.3.1	Одномерное дискретное преобразование Фурье	72
11.3.2	Двумерные ДПФ	73
11.3.3	Дискретное косинусное преобразование (ДКП)	73
11.3.4	Дискретное синусное преобразования (ДСП)	74
11.4	Преобразования Адамара и Хаара	74
11.4.1	Преобразование Адамара	74
11.4.2	Преобразование Хаара	75
11.5	Генерация признаков на основе нелинейных преобразований. Выделение текстуры изображений.	75
11.5.1	Региональные признаки. Признаки для описания текстуры	76
11.5.2	Признаки, основанные на статистиках первого порядка	76
11.5.3	Признаки, основанные на статистиках второго порядка. Матрицы сочетаний.	77
11.6	Признаки формы и размера	78
11.6.1	Признаки Фурье	78
11.6.2	Цепной код	79
11.6.3	Геометрические свойства фигуры	79
11.6.4	Скелетизация	80
12	Обучение по прецедентам (по Вапнику, Червоненкису)	81
12.1	Задача построения классификатора	81
12.2	Качество обучения классификатора	81
12.3	Вероятностная модель	81
12.4	Задача поиска наилучшего классификатора	82
12.5	Сходимость эмпирического риска к среднему. Случай конечного числа решающих правил.	83
12.6	Случай бесконечного числа решающих правил	83
12.6.1	Критерий равномерной сходимости  к вероятностям 	84
12.6.2	Достаточное условие равномерной сходимости	84
12.6.3	Скорость сходимости	85
12.6.4	Случай класса линейных решающих функций	85

Задача распознавания образов
Предмет распознавания образов
Распознавание образов - это научная дисциплина, целью которой является классификация объектов  по нескольким категориям или классам. Объекты называются образами. 
Классификация основывается на прецедентах. 
Прецедент - это образ, правильная классификация которого известна. 
Прецедент - ранее классифицированный объект, принимаемый как образец при решении задач классификации. Идея принятия решений на основе прецедентности - основополагающая в естественно-научном мировоззрении.
Будем считать, что все объекты или явления разбиты на конечное число классов. Для каждого класса известно и изучено конечное число объектов - прецедентов. Задача распознавания образов состоит в том, чтобы отнести новый распознаваемый объект к какому-либо классу.
Задача распознавания образов является основной в большинстве интеллектуальных систем. Рассмотрим примеры интеллектуальных компьютерных систем.
Машинное зрение. Это системы, назначение которых состоит в получении изображения через камеру и составление его описания в символьном виде (какие объекты присутствуют, в каком взаимном отношении находятся и т.д.).
Символьное распознавание - это распознавание букв или цифр.
 Optical Character Recognition (OCR); 
Ввод и хранение документов ; 
 Pen Computer; 
Обработка чеков в банках ; 
Обработка почты.
Диагностика в медицине.
Маммография, рентгенография ; 
Постановка диагноза по истории болезни;
Электрокардиограмма.
Геология.
Распознавание речи.
Распознавание в дактилоскопии (отпечатки пальцев), распознавание лица, подписи, жестов.
Признаки и классификаторы
Измерения, используемые для классификации образов, называются признаками. Признак - это некоторое количественное измерение объекта произвольной природы. Совокупность признаков, относящихся к одному образу, называется вектором признаков. Вектора признаков принимают значения в пространстве признаков. В рамках задачи распознавания считается, что каждому образу ставится в соответствие единственное значение вектора признаков и наоборот: каждому значению вектора признаков соответствует единственный образ.
Классификатором или решающим правилом называется правило отнесения образа к одному из классов на основании его  вектора признаков.
Пример 1. Иллюстрация понятий признаков и классификатора и идеи распознавания (классификации). Рассмотрим задачу диагностики печени по результатам инструментального исследования. Доброкачественные (левый рисунок - класс  A ) и злокачественные (правый рисунок - класс  B ) изменения дают разную картину. Предположим, что имеется несколько препаратов в базе данных, про которые известна их принадлежность к классам  A  и  B  (правильная классификация). Очевидно, что образцы отличаются интенсивностью точек изображения. В качестве вектора признаков выберем пару: среднее значение (() и среднеквадратичное отклонение (() интенсивности в изображении. На рис.1 представлены изображения этих образов в пространстве признаков. Точки, соответствующие прецедентам разных классов, разделяются прямой линией. Классификация неизвестного образа (соответствующая точка изображена звездочкой) состоит в проверке положения точки относительно этой разделяющей прямой. 
Практическая разработка системы классификации осуществляется по следующей схеме (рис.2). В процессе разработки необходимо решить следующие вопросы.
Как выбрать вектора признаков? Задача генерации признаков - это выбор тех признаков, которые с достаточной полнотой (в разумных пределах) описывают образ.
Какие признаки наиболее существенны для разделения  объектов разных классов? Задача селекции признаков - отбор наиболее информативных признаков для классификации.
Как построить классификатор? Задача построения классификатора - выбор решающего правила, по которому на основании вектора признаков осуществляется отнесение объекта к тому или иному классу.
Как оценить качество построенной системы классификации?Задача количественной оценки системы (выбранные признаки + классификатор) с точки зрения правильности или ошибочности классификации.
Классификация с обучением и без обучения
В зависимости от наличия или отсутствия прецедентной информации различают задачи распознавания с обучением и без обучения.  Задача распознавания на основе имеющегося множества прецедентов называется классификацией с обучением (или с учителем). 
В том случае, если имеется множество векторов признаков, полученных для некоторого набора образов, но правильная классификация этих образов неизвестна, возникает задача разделения этих образов на классы по сходству соответствующих векторов признаков. Эта задача называется кластеризацией  или распознаванием без обучения. 
Пример 2. Рассмотрим съемку со спутника и классификацию поверхности по отраженной энергии (рис.3). На рисунке изображены снимок из космоса (слева) и результат кластеризации векторов признаков, рассчитанных для различных элементов изображения (справа). Распределение образов, изображенных точками ( x 1, x 2) по классам осуществляется на основе анализа "скоплений" этих точек в пространстве признаков. 
Пример 3. Рассмотрим другой пример распознавания образов -  в общественных (социальных) науках. Целью задачи является построение системы классификации государств для определения необходимости гуманитарной поддержки со стороны международных организаций. Необходимо выявить закономерности связей между различными, объективно измеряемыми параметрами, например, связь между ВНП, уровнем грамотности и уровнем детской смертности. В данном случае страны можно представить трехмерными векторами, а задача заключается в построении меры сходства этих векторов и дальнейшем построении схемы кластеризации (выбора групп) по этой мере.
Формальная постановка задачи классификации 
Будем использовать следующую модель задачи классификации.
 - множество объектов распознавания (пространство образов).
:  - объект распознавания (образ).
:   ,    - индикаторная функция, разбивающая пространство образов на  на  непересекающихся классов . Индикаторная функция неизвестна наблюдателю.
 - пространство наблюдений, воспринимаемых наблюдателем (пространство признаков). 
:    - функция, ставящая в соответствие каждому объекту  точку в пространстве признаков. Вектор  - это образ объекта, воспринимаемый наблюдателем. В пространстве признаков определены непересекающиеся множества точек  Ki(X , , соответствующих образам одного класса.  
:  - решающее правило - оценка для  на основании , т.е. .
Пусть ,  - доступная наблюдателю информация о функциях  и , но сами эти функции наблюдателю неизвестны. Тогда ,  - есть множество прецедентов.
Задача заключается в построении такого решающего правила , чтобы распознавание проводилось с минимальным числом ошибок. 
Обычный случай - считать пространство признаков евклидовым, т.е. . Качество решающего правила измеряют частотой появления правильных решений. Обычно его оценивают, наделяя множество объектов  некоторой вероятностной мерой. Тогда задача записывается в виде .

Классификация на основе байесовской теории решений
Байесовский подход
Байесовский подход исходит из статистической природы наблюдений. За основу берется предположение о существовании вероятностной меры на пространстве образов, которая либо известна, либо может быть оценена. Цель состоит в разработке такого классификатора, который будет правильно определять наиболее вероятный класс для пробного образа. Тогда задача состоит в определении "наиболее вероятного"  класса.
Задано  классов , а также ,  - вероятность того, что неизвестный образ, представляемый вектором признаков , принадлежит классу . 
 называется апостериорной вероятностью, поскольку задает распределение индекса класса после эксперимента ( a posteriori  - т.е. после того, как значение вектора признаков  x  было получено).
Рассмотрим случай двух классов  и . Естественно выбрать решающее правило таким образом: объект относим к тому классу, для которого апостериорная вероятность выше. Такое правило классификации по максимуму апостериорной вероятности называется Байесовским: если , то  классифицируется в , иначе в . Таким образом, для Байесовского решающего правила необходимо получить апостериорные вероятности, . Это можно сделать с помощью формулы Байеса. 
Формула Байеса, полученная Т. Байесом в 1763 году, позволяет вычислить апостериорные вероятности событий через априорные вероятности и функции правдоподобия.
Пусть  - полная группа несовместных событий. . , при . Тогда апостериорная вероятность имеет вид:
,
где  - априорная вероятность события ,  - условная вероятность события  при условии, что произошло событие . 
Рассмотрим получение апостериорной вероятности , зная  и . 
,   


Если  и  описываются плотностями  и , то
  .
При проверке классификации сравнение  и  эквивалентно сравнению  и .  В случае, когда , считается, что мера множества  равна нулю.
Таким образом, задача сравнения по апостериорной вероятности  сводится к вычислению величин , , , . Будем считать, что у нас достаточно данных для определения вероятности принадлежности объекта каждому из классов, . Такие вероятности называются априорными вероятностями классов. А также будем считать, что известны функции распределения вектора признаков для каждого класса , . Они называются функциями правдоподобия  по отношению к . Если априорные вероятности и функции правдоподобия неизвестны, то их можно оценить методами математической статистики на множестве прецедентов. Например, , где  - число прецедентов из , .  - общее число прецедентов.  может быть приближено гистограммой  распределения вектора признаков для прецедентов из класса . 
Итак, Байесовский подход к статистическим задачам основывается на предположении о существовании некоторого распределения вероятностей для каждого параметра. Недостатком этого метода является необходимость постулирования как существования априорного распределения для неизвестного параметра, так и знание его формы.
Ошибка классификации
Определение. Вероятность  называется ошибкой классификации, ,  - области решения ().
Теорема. Байесовский классификатор является оптимальным по отношению к минимизации вероятности ошибки классификации.
Доказательство. Рассмотрим ошибку классификации :
  

 
  
Учитывая формулу Байеса :  ,  получим : 
  
  
  
Таким образом, минимум достигается, когда   .  выбирается из остальных точек.
ч.т.д.
Данная теорема была доказана для двух классов  и . Обобщим ее на  классов. 
Пусть вектор признаков  относится к классу , если , при , , . Соответственно необходимо доказать, что данное правило минимизирует вероятность ошибки классификации. Для доказательства следует воспользоваться формулой правильной классификации .
Доказательство. Воспользуемся формулой правильной классификации .





Учитывая формулу Байеса :  ,  получим : 




Таким образом, максимум достигается, когда . Аналогично для всех  максимум достигается, когда . 
ч.т.д.
Минимизация среднего риска
Вероятность ошибки классификации - не всегда лучший критерий проверки классификатора. В том случае, когда цена ошибок различного типа существенно различается, лучше использовать другой критерий качества классификации - минимум среднего риска. 
Рассмотрим задачу классификации по  классам. ,  - области предпочтения классов . Предположим, что вектор  из класса  лежит в , , т.е. классификация происходит с ошибкой. Свяжем с этой ошибкой штраф  называемый потерями в результате того, что объект из класса  был принят за объект из класса . Обозначим через  матрицу потерь.
Определение. Выражение  называется риском при классификации объекта класса .
Определение. Выражение  называется общим средним риском.
Теперь мы можем поставить задачу о выборе классификатора, минимизирующего этот риск. Преобразуем выражение общего среднего риска:



Из этого выражения видно, что риск минимален, когда каждый из интегралов в данной сумме минимален, т.е. , если , при , где , .
Пример. Рассмотрим ситуацию радиолокационной разведки. На экране радара отражаются не только цели, но и помехи. Такой помехой может служить стая птиц, которую можно принять за небольшой самолет. В данном случае это двухклассовая задача. 
Рассмотрим матрицу штрафов:   , ,   .  - это штраф за принятие объекта из класса  за объект класса . Тогда


Пусть  относится у классу , если , т.е.


Т.к.  и , то

Стоящее в левой части неравенства отношение  называется отношением правдоподобия. Неравенство описывает условие предпочтения класса  классу .
Пример. Рассмотрим двухклассовую задачу, в которой для единственного признака  известна плотность распределения:


Пусть, также, априорные вероятности .
Задача - вычислить пороги для
минимальной вероятности ошибки
минимального риска при матрице риска   .
Решение задачи  a):
  
 
  
 
 Решение задачи  b):
 




Пример. Рассмотрим двухклассовую задачу с Гауссовскими плотностями распределения  и  и матрицей потерь .
Задача - вычислить порог для проверки отношения правдоподобия.
Решение. С учетом матрицы потерь отношение правдоподобия

запишется в виде

Запишем плотности распределения 
  ;   
 
  
  
Пример. Рассмотрим двух классовую задачу с матрицей потерь , , . Пусть  - вероятность ошибки, соответствующая вектору из класса  и  - вероятность ошибки, соответствующая вектору из класса . Задача - найти средний риск.
Решение.



 
 Пример. Доказать, что в задаче классификации по  классам, вероятность ошибки классификации ограничена: . 
Указание: показать, что .
Дискриминантные функции и поверхности решения
Минимизация риска и вероятности ошибки эквивалентны разделению пространства признаков на  областей. Если области  и  смежные, то они разделены поверхностью решения в многомерном пространстве. Для случая минимизации вероятности ошибки поверхность решения задается уравнением:

В данном уравнении приходится оперировать с вероятностями. Иногда вместо вероятностей удобнее работать с функцией от вероятности:
,
где функция  монотонно возрастает.
Определение. Функция  называется дискриминантной функцией.
Таким образом, поверхность решения будет задаваться уравнением:
, , , .
Для задачи классификации по вероятности ошибки или риску не всегда удается вычислить вероятности. В этом случае бывает более предпочтительно вычислить разделяющую поверхность на основе другой функции стоимости. Такие подходы дают решения, субоптимальные по отношению к Байесовской классификации.
Байесовский классификатор для нормального распределения
Распределение Гаусса очень широко используется по причине вычислительного удобства и адекватности во многих случаях. Рассмотрим многомерную плотность нормального распределения :
, 
где  - математическое ожидание случайной величины  x  в классе ,
 - матрица ковариации размерности  для класса , ,
 - определитель матрицы ковариации.
Здесь  x ,  (i  - это вектора столбцы, а  xT ,  (iT   - вектора-строки.
Квадратичная поверхность решения 
 На основе этих данных необходимо построить байесовский классификатор. Рассмотрим логарифмическую дискриминантную функцию:
 



 
, где 
Эта функция представляет собой квадратичную форму. Следовательно, разделяющая поверхность  является гиперповерхностью второго порядка. Поэтому Байесовский классификатор является квадратичным классификатором.
Пример. Пусть , . Тогда .
 
Разделяющей поверхностью является коническое сечение.
Пример. Пусть , , , , . Тогда , . Найдем поверхность решения.






Т.к. , то 


 
- эллипс центром в точке .
Пример. Пусть , , , , . Тогда , . Найдем поверхность решения.
Из предыдущего примера : 





Т.к. , то . 
 - гипербола с центром в точке .
Линейная поверхность решения 
 Условие остается тем же:   ,   .
В предыдущем пункте мы получили квадратичную форму:
 

 , где   .
Пусть   , тогда
 


 , где  ; ; 
 
 При    можно сравнивать только    и   . Таким образом, при    мы получили линейную поверхность решения.
Линейная поверхность решения с диагональной матрицей ковариации
Рассмотрим случай, когда матрица  диагональная с одинаковыми элементами: . Тогда  имеет вид:   ;
  ,
где   ,    В данном случае под нормой понимается евклидова норма. Поверхностью решения является гиперплоскость, проходящая  через точку .
Если   , то  - это середина вектора   .
Т.к.   , то   . Следовательно, поверхность решения ортогональна   .
Пример. Рассмотрим пример разделяющей поверхности решения для двухклассовой задачи с нормальным распределением. Поверхность решения лежит ближе к , если   . Соответственно, поверхность решения лежит ближе к , если   . Также, если  мало по отношению к , то положение поверхности решения не очень чувствительно к изменению    и   . Последнее справедливо, т.к. вектора лежат в малых окрестностях  и , поэтому изменение гиперплоскости их затрагивает не сильно. В центре изображен случай малого, а справа случай большого .
Линейная поверхность решения с недиагональной матрицей ковариации
В этом случае уравнение :
 
будет иметь несколько иные параметры: 
   и   
В данном случае под нормой понимается так называемая  норма , которая имеет вид:   . Для такой нормы поверхность решения не ортогональна вектору   , Но она ортогональна его образу при преобразовании .
Классификаторы по минимуму расстояния
Будем рассматривать равновероятные классы с одинаковой матрицей ковариации. Тогда     и выражение
  
примет вид
 
 (т.к. логарифм и константа сократятся).
Классификатор по минимуму расстояния с диагональной матрицей ковариации. Рассмотрим случай, когда матрица  диагональная с одинаковыми элементами: . Тогда максимизация  влечет минимизацию евклидового расстояния, определяемое выражением   . В данном случае будет считаться, что объект относится к данному классу, если он близок в смысле евклидового расстояния.
Классификатор по минимуму расстояния с недиагональной матрицей ковариации. В   этом случае максимизация  влечет минимизацию расстояния Махалонобиса, определяемого выражением   .
Т.к. матрица ковариации является симметрической, ее можно представить в виде:
  ,
где , а  - диагональная матрица с собственными значениями матрицы  на диагонали. Матрица  имеет столбцы, соответствующие собственным векторам матрицы :
 
 Таким образом, получаем линию равноудаленных точек :
 
 Пусть . Тогда координатами  являются , , т.е. проекции  на собственные вектора. Другими словами, мы получили координаты в новой системе, у которой оси определяются собственными векторами , . Тогда последнее уравнение преобразуется в уравнение эллипсоида в новой системе координат:
 
 При  центр эллипса находится в точке , а главные оси лежат по собственным векторам и имеют длины  и  соответственно.
Пример. Рассмотрим двумерный двухклассовый случай классификации двух нормально распределенных векторов с ковариационной матрицей  и средними значениями  и .
Найдем  :


 Классифицируем вектор . Для этого посчитаем расстояние Махалонобиса:
 







 Таким образом, хотя сама точка  по евклидову расстоянию ближе к точке , чем к точке , но по расстоянию Махалонобиса она ближе к .
Теперь вычислим главные оси эллипса с центром в точке . Для этого найдем собственные значения:
 
 ,   .
Тогда собственные вектора (и направление главных осей эллипса) будут иметь вид:
, .
Линейный классификатор. Алгоритм персептрона
Линейная дискриминантная функция
Рассмотрим задачу построения линейной разделяющей гиперповерхности. Главным достоинством линейного классификатора является его простота и вычислительная эффективность.
Рассмотрим линейную дискриминантную функцию:   , где  - весовой вектор,  - порог. Поведение решения задается уравнением . Пусть  и  - два конечных множества векторов признаков в евклидовом пространстве, относящихся к классу  и  соответственно, т.е  принадлежит классу  при , а  принадлежит классу  при .
Задача состоит в том, чтобы:
установить разделимость этих множеств;
найти разделяющую гиперплоскость.
Рассмотрим сначала в качестве примера двумерную задачу, когда образы представляются точками на плоскости.
Определение. Множество, содержащее отрезок, соединяющий две произвольные внутренние точки, называется выпуклым.
Определение. Выпуклая оболочка - это минимальное выпуклое множество, содержащее данное.
Утверждение 3.1. Два множества на плоскости линейно разделимы тогда и только тогда, когда их выпуклые оболочки не пересекаются.	
Из этого утверждения получаем следующее правило проверки разделимости множеств на плоскости:
1)   Построить выпуклые оболочки.
2)   Проверить пересечение выпуклых оболочек. Если они не пересекаются, то множества разделимы.
Очевидно и правило, по которому можно найти разделяющую прямую:
1)   Найти ближайшую пару точек в выпуклых оболочках обоих множеств. 
2)   Построить срединный перпендикуляр к отрезку, соединяющему эти точки. Этот перпендикуляр и будет разделяющей прямой.
Пусть размерность вектора признаков  X  и вектора коэффициентов  W  равна  l . Рассмотрим "пополненные" вектораследующего вида:  - пополненный весовой вектор,  - пополненный вектор признаков. Рассмотрим также в -мерном пространстве однородную линейную функцию . 
Очевидно следующее 
Утверждение 3.2. Множества  и  линейно разделимы в пространстве  Rl  дискриминантной функцией    тогда и только тогда, когда они разделимы в пополненном пространстве  Rl +1  однородной дискриминантной функцией . 
Далее будем рассматривать дискриминантные функции и вектора в пополненном пространстве.
Определение. Множество  называется симметричным множеством к множеству .
Утверждение 3.3. Два замкнутых множества  и  разделимы тогда и только тогда, когда выпуклая оболочка множества  не содержит начала координат.
Доказательство. Пусть множества  и  разделимы. Тогда существует линейная функция  такая, что  при  и  при . Рассмотрим множество , тогда  при . Следовательно,  для выпуклой линейной комбинации из , а это означает, что , т.к.  - замкнутое. Здесь  обозначает начало координат.
Пусть , и пусть  - ближайшая к началу координат  точка из . Плоскость с направляющим вектором  не пересекает , а, значит,  на . Следовательно,  на .
ч. т. д.
Алгоритм персептрона
Математическая модель нейрона 
 В алгоритме персептрона в основу положен принцип действия нейрона. Обобщенная схема нейрона представлена на рисунке. Здесь  - компоненты вектора признаков ;    - сумматор;    - синоптические веса;  - функция активации;  - порог. Выходом сумматора является величина , которая является входом (аргументом) функции активации. Значение функции активации вычисляется на основе определения знака суммы :
.
Таким образом, нейрон представляет собой линейный классификатор с дискриминантная функцией .
Тогда задача построения линейного классификатора для заданного множества прецедентов сводится к задаче обучения нейрона, т.е. подбора соответствующих весов     и порога  W 0. Обучение состоит в коррекции синоптических весов и порога.
Алгоритм персептрона 
 Алгоритм персептрона представляет собой последовательную итерационную процедуру. Каждый шаг состоит в предъявлении нейрону очередного вектора-прецедента и коррекции весов  по результатам классификации. При этом прецеденты предъявляются циклически, т.е. после предъявления последнего снова предъявляется первый. Процесс обучения заканчивается, когда нейрон правильно классифицирует все прецеденты.
Обозначим  Wt  весовой вектор после  t -й итерации, а  xt  - прецедент, предъявляемый на  t -й итерации. 
Основной шаг алгоритма состоит в предъявлении прецедента очередного прецедента :
Если  и , то ;
Если  и , то ;
Если  и , то ;
Если  и , то .
На данном рисунке  - дискриминантная функция после  t -го шага алгоритма;  - весовой вектор после  t -го шага алгоритма.
Сходимость алгоритма персептрона
Основной вопрос, связанный с алгоритмом персептрона связан с его сходимостью. Конечен ли построенный итерационный процесс обучения? 
Теорема Новикова. Пусть  - бесконечная последовательность векторов из двух непересекающихся замкнутых множеств  и ; и пусть существует гиперплоскость, проходящая через начало координат и разделяющая  и  (не имеет с ними общих точек). Тогда при использовании алгоритма персептрона число коррекций весового вектора конечно.
Доказательство. Пусть - направляющий вектор разделяющей гиперплоскости (которая существует по условию). Не нарушая общности, будем считать, что он является единичным. 
Пусть , в - симметричное к   множество; , где  - евклидово расстояние. Согласно утверждению 3.3   . 
Оценим .
Пусть  - еденичный вектор нормали, разделяющий  и .
 при 
 при 
Пусть  - весовой вектор после предъявления вектора ;  - начальная итерация весового вектора (). Тогда, если , то коррекции не происходит. Иначе, если , то коррекция: 
, т.к.  и 
Таким образом, к моменту  происходит  коррекций, то
, т.к.  			
В начальный момент времени . Если в момент  произошла коррекция, то

Если коррекция не происходит, то 

Если к моменту  произошло  коррекций, то

С другой стороны

Поэтому 			
 			
Из неравенств  и  следует: 
    
Таким образом, число коррекций  не превосходит .
ч. т. д.
Оптимизационная интерпретация 
 Рассмотрим непрерывную кусочно-линейную функцию :
, где ;
 - множество векторов неправильно классифицированных гиперплоскостью . Тогда  и   . Задача состоит в минимизации этой функции :
 
Построим минимизацию по схеме градиентного спуска:
 
 Т.к. , то 
Таким образом, алгоритм персептрона представляет собой вариант алгоритма градиентного спуска. Выбор последовательности величин для обычно осуществляется так, чтобы:
 и 
Схема Кеслера
Идея построения линейного классификатора естественно обобщается на случай классификации с числом классов больше двух. Рассмотрим задачу классификации по  классам. Для каждого класса необходимо определить линейную дискримринантную функцию , . Пусть  - -мерный вектор в расширенном пространстве. Вектор  относится к классу , если
, 
Схема Кеслера позволяет применить алгоритм персептрона для решения этой задачи.
Для каждого вектора-прецедента из  строим  векторов  размерности :
и вектор , где  - весовой вектор -ой дискриминантной функции.
Пусть , тогда вектор  можно записать в виде:

Если  относится к классу , то  , , т.к. и .
Таким образом, задача заключается в построении линейного классификатора в -мерном пространстве так, чтобы каждый из  векторов-прецедентов лежал в положительном полупространстве. Если вектора в исходной задаче разделимы, то это можно сделать с помощью алгоритма персептрона.
Оптимальная разделяющая гиперплоскость
Существование и единственность
Пусть   и   - конечные множества точек в евклидовом пространстве .
Определение.   и   разделимы гиперплоскостью, если существует единичный вектор и число , что при , при .
Обозначим  , . Тогда  при , при . Если , то гиперплоскость 
		(4.1)
разделяет   и   .
В силу непрерывности  и  существует множество разделяющих гиперплоскостей, если существует (4.1).
Определение. Оптимальной называется разделяющая гиперплоскость (4.1), соответствующая вектору , при котором достигается максимум .
Теорема. Если два множества   и   разделимы гиперплоскостью, то оптимальная разделяющая гиперплоскость существует и единственна.
Доказательство. Функция  непрерывна на сфере . Значит, существует и достигается при некотором значении . Предположим, что он достигается внутри сферы, т.е. . Тогда для  получаем


,
что противоречит предположению о том, что  - точка максимума . Следовательно, максимум достигается на границе сферы, т.е. .
Докажем единственность максимума. Предположим, что это не так и существуют различные  и  такие, что . Рассмотрим значение , , не совпадающее ни с , ни с . 



.
Аналогично . 
Тогда



и - тоже значение, на котором достигается максимум.
,
т.к. ,  и при .
Но  лежит внутри сферы  и поэтому не может быть точкой максимума. Следовательно, предположение о существовании двух максимумов неверно и максимум единственный.
ч.т.д.
Таким образом, если максимум функции  достигается при значении , то гиперплоскость  максимально удалена от   и   и разделяет их.
Построение оптимальной разделяющей гиперплоскости
Теорема. Если два множества   и   разделимы гиперплоскостью,   и    - выпуклые оболочки этих множеств, а   и    - пара ближайших точек в выпуклых оболочках, то
,
где  - обозначает евклидово расстояние между точками   и   .
Доказательство. Положим . Из условий ,  следует, что ,  и, следовательно, 
 		 (4.2)
Следовательно  и для доказательства теоремы нужно показать, что справедливо неравенство
			(4.3)
Пусть точки  и  такие, что  и .
Тогда 



.
Теперь покажем, что , а , или, что то же самое:
, 			(4.4)
Пусть ,  - точка в . Очевидно, что она лежит в выпуклой оболочке , т.е.   . Тогда имеем


		(4.5)
Поскольку точки   и    - ближайшие в выпуклых оболочках  и   , получаем, что .  
Тогда из (4.5) следует, что 
,
или  , что возможно лишь при . Таким образом, первое из неравенств  (4.4) доказано. Второе неравенство (4.4) доказывается аналогично. 
Тем самым доказано неравенство (4.3), а из него (4.2) и утверждение теоремы.
ч.т.д. 
Оптимальная разделяющая гиперплоскость ортогональна отрезку, соединяющему ближайшие точки выпуклых оболочек множеств   и   , и проходит через середину этого отрезка. Задача поиска пары ближайших точек сводится к задаче квадратичного программирования следующим образом.
Каждая точка  y , лежащая в выпуклой оболочке   ,  представима в виде
, , . Аналогично, точка  представима в виде , , . Нужно найти пару точек  и , обеспечивающих минимум выражения:
 		 (4.6)
при условиях:
, , 			(4.7)
, . 			(4.8)
Задача математического программирования (4.6-4.8) имеет два ограничения и квадратичную целевую функцию.
Алгоритм Гаусса-Зейделя
Задача состоит в нахождении наименьшего расстояния между множествами и .
1. В качестве начальных значений берем произвольную пару  и . Другими словами в начальный момент  и .
2. Необходимо найти точку  ближайшую к  на отрезке . Обозначаем . Напишем условие ортогональности векторов  и :
.
Т.к. , то


Следовательно, .
Если , то . Если , то . Если , то .
3. Далее необходимо найти точку  ближайшую к  на отрезке . Обозначаем .
Данную процедуру необходимо повторять, пока не найдутся две ближайшие точки множеств    и   .
Нелинейный классификатор. Многослойный персептрон
Задача исключающего ИЛИ
Рассмотрим булеву функцию  как некий классификатор. Вектор признаков имеет вид . В данном случае имеется четыре прецедента и два класса. Напомним таблицу значений функции .
№ прецедента				Класс																										Как видно из рисунка тут нельзя построить разделяющую прямую, поскольку выпуклые оболочки точек, относящихся к первому классу и ко второму классу, пересекаются. Следовательно, и линейный классификатор построить нельзя. Попытаемся построить необходимый нелинейный классификатор как суперпозицию несколько линейных. 
Рассмотрим две вспомогательные булевы функции  и . Напомним таблицы значений этих функций:
№ прецедента																														
Построение линейного классификатора функции . Очевидно, что разделяющей прямой является линия: . Соответствующий персептрон имеет вид:

Построение линейного классификатора функции . Здесь также можно построить разделяющую прямую: . Соответствующий персептрон имеет вид:

Построение нелинейного классификатора функции .  Пусть на выходе персептрона для функции  - , а на выходе персептрона для функции  - . Посмотрим, какие значения принимает вектор .
Исходные вектора	 OR 	 AND 	 XOR	 							Класс						 1	 						 0	 						 0	 						 1	 		Обозначив классы как показано в таблице, получаем разделяющую прямую, изображенную на рисунке и соответствующий линейный классификатор:

Учитывая вышеизложенное, получаем нелинейный классификатор, который задается через два линейных классификатора, как показано на рисунке слева:
 и 
Соответствующий двухслойный персептрон изображен на рисунке справа.
 
 Классификационные способности двухслойного персептрона
Рассмотрим общий случай двухслойного персептрона. Пусть  и в скрытом слое  нейронов. Скрытый слой нейронов отображает  в , где  - гиперкуб. Другими словами, каждый нейрон задает гиперплоскость, которая разделяет пространство пополам, т.е.  скрытый слой нейронов делит пространство  на полиэдры. Все вектора из каждого полиэдра отображаются в вершину -мерного единичного куба. Выходной нейрон разделяет вектора в классах, описанных полиэдрами, т.е. производит сечение гиперкуба, полученного в скрытом слое.
Пример. Рассмотрим нейронную сеть с двумя входами () и тремя нейронами (). Тогда пространство . Пусть первый слой нейронов задает разбиение признакового пространства (плоскости) как показано на рисунке. В каждом многоугольнике (возможно, бесконечном) все точки соответствуют одному классу ( A  или  B ). При этом в каждом многоугольнике знаки линейных функционалов  g 1,  g 2,  g 3 остаются постоянными. Следовательно, с каждым многоугольником связано определенное значение вектора выходов нейронов первого слоя, причем для разных многоугольников эти значения различны. Поскольку значениями компонент этого вектора являются 0 либо 1, получаем, что каждому многоугольнику соответствует некоторая вершина единичного куба  в пространстве . При этом каждой вершине куба сопоставлен один класс  A  или  B . На рисунке изображен единичный куб , у которого закрашенные вершины относятся к классу , а не закрашенные - к классу . Задача нейрона второго слоя состоит в разделении вершин этого куба. Нетрудно видеть, что в нашем примере плоскость  является разделяющей для куба . Она и задает параметры нейрона второго слоя. Заметим, что вершина  в кубе не загружена, т.е. в нее не отображается ни один многоугольник. 
Трехслойный персептрон
Внешний (выходной) нейрон реализует лишь одну гиперплоскость. Очевидно, что одна разделяющая гиперплоскость не всегда может обеспечить желаемое разделение вершин гиперкуба. Например, если два конца одной его главной диагонали относятся к классу  A , а два конца другой диагонали - к классу  B . С аналогичной ситуацией мы уже сталкивались в задаче исключающего или. Попробуем ввести еще один слой нейронов.

	Утверждение. Трехслойная нейронная сеть позволяет описать любые разделения объединений полиэдров.
Доказательство. Рассмотрим первый слой из  p  нейронов. На первом формируются гиперплоскости, т.к. строится полиэдральное разбиение пространства гиперплоскостями. Очевидно, что для заданного конечного множества прецедентов всегда можно построить разбиение пространства признаков на полиэдры такое, что ни в каком полиэдре не окажется пары точек из разных классов. Как было показано выше, первый слой отображает полиэдры в вершины  p -мерного единичного гиперкуба. Поскольку с каждым полиэдром связаны образы одного класса, то и с каждой вершиной гиперкуба связан лишь один класс.
Каждый нейрон второго слоя описывает сечение полученного гиперкуба. Выберем в качестве таких сечений гиперплоскости, отсекающие ровно одну вершину гиперкуба. Поскольку число вершин в гиперкубе равно 2 p , число нейронов второго слоя также равно 2 p . Таким образом, выход нейронов второго слоя имеет следующий вид. Это вектор размерности 2 p , у которого всегда лишь одно значение равно 1, а остальные равны нулю. Назовем нейроны второго слоя нейронами класса  A  или  B  в соответствии с классом вершины гиперкуба, которую отсекает этот нейрон. Теперь становится понятно, каким образом строить третий слой нейронной сети. Нужно в выходном нейроне третьего слоя реализовать оператор логического сложения выходов нейронов второго слоя, относящихся к классу  A . Таким образом разделяющая гиперплоскость выходного нейрона задается уравнением:
, где  k =2 p , а 

Таким образом, можно построить трехслойный персептрон следующим образом. Нейроны первого слоя разделяют пространство признаков на полиэдры одного класса и отображают их в вершины гиперкуба. Нейроны второго слоя отсекают вершины гиперкуба. Нейрон третьего слоя собственно осуществляет классификацию через оператор логического сложения. Тем самым утверждение доказано. 
ч.т.д.
Рассмотрим, как строится уравнение гиперплоскости, отсекающей вершину -мерного единичного гиперкуба. Диагональ куба имеет длину . Длины диагоналей -мерных единичных гиперкубов, являющихся боковыми гранями -мерного куба, равны .  Центр куба находится в точке . Расстояние от центра куба до любой вершины равно . Плоскость проводим перпендикулярно главной диагонали куба, инцидентной вершине, которую надо отсечь,  так, чтобы расстояние от этой вершины до секущей плоскости было равно , причем данная точка должна находиться на диагонали куба, проведенной к отсекаемой вершине.
Пусть  - отделяемая вершина,  - диагонально противоположная вершина (, где  E  обозначает -мерный вектор, состоящий из единиц). Следовательно,  - направляющий вектор разделяющей гиперплоскости. Тогда гиперплоскость проходит через точку:

Обозначим : 

Тогда 
  
и уравнение гиперплоскости запишется в виде: .
Построение нейронной сети 
Существует два подхода к задаче построения нейронной сети-классификатора. Первый подход заключается в построении сети, варьируя архитектуру. Данный метод основан на точной классификации прецедентов. Второй подход состоит в подборке параметров (весов и порогов) для сети с заданной архитектурой.
Алгоритм, основанные на точной классификации множества прецедентов. 
Опишем общую идею метода. За основу берется один нейрон. Далее наращиваем нейрон, пока не получим правильную классификацию всех прецедентов.
Рассмотрим более подробно алгоритм. Начинаем с одного нейрона , называемого мастером. После его тренировки получаем разделение множества  на  и . Если  содержит вектора из двух классов, то вводим новый узел , называемый последователем.
Таким образом, на первом слое нейронов находится один мастер и несколько последователей. Никакие вектора из разных классов не имеют одинакового выхода из первого слоя.
  ,
где  - отображение, задаваемое первым слоем.
Аналогичным образом строим второй слой, третий слой и т.д.
Утверждение. При правильном выборе весов каждый очередной слой правильно классифицирует все вектора, которые правильно классифицировал мастер и еще хотя бы один вектор.
Таким образом, получаем архитектуру, имеющую конечное число слоев, правильно классифицирующие все прецеденты.
Алгоритм ближайших соседей 
 Нейроны первого слоя - это биссекторы, разделяющие пары. Второй слой - нейроны , определяющие полиэдры. Третий слой - нейроны , определяющие классы.
Основным недостатком данного метода является слишком большое количество нейронов. Уменьшить количество нейронов можно путем удаления внутренних ячеек:
.
Алгоритм, основанный на подборе весов для сети с заданной архитектурой
Идея данного метода состоит в том, чтобы ввести критерий в виде функции стоимости, которую необходимо минимизировать.
Пусть 
 - число слоев в сети; 
 - число нейронов в слое , где ; 
 - число выходных нейронов; 
 - размер входа;
   - входной вектор признаков;
 а - выходной вектор, который должен быть правильно классифицирован.
Текущем состоянии сеть при обучении дает результат  не совпадающий с . Обозначим:
  ,
где  - число прецедентов;  - ошибка на -ом прецеденте;
,
где .  - функция всех синоптических весов и порогов. Таким образом, целью обучения является решение оптимизационной задачи:
,
где  - множество синоптических весов.

Пусть  - выход -ого нейрона -ого слоя;  - весовой вектор (включая порог) -ого нейрона в -ом слое, т.е. , где  а - число нейронов в -ом слое. Таким образом,  - разрывная функция  переменных, где

 разрывна, т.к. разрывна функция активации :

Алгоритм обратной волны 
 Суть - аппроксимация  непрерывной дифференцируемой функцией за счет замены функции активации "сигмовидной" функцией:

Вычислим производную функции : 

При данном чисто формальном приеме вектора признаков уже могут отображаться не только в вершины, но и внутрь гиперкуба. Необходимо решить задачу минимизации : 

Метод градиентного спуска решения задачи минимизации. 
Пусть . Тогда метод градиентного спуска выглядит так:
,
где  а - шаг градиентного спуска. Очевидно, для его реализации необходимо уметь градиент .
Вычисление градиента. Аргумент функции активации -ого нейрона -ого слоя

принимает различные значения в зависимости от индекса прецедента. В данном случае .
Во входном слое, при  , . В выходном слое, при  , .
Рассмотрим выходной слой .


 - не зависит от -ого номера нейрона в слое, т.е. имеем одинаковый вектор производных для всех нейронов -ого слоя.

Следовательно, для последнего слоя 
Рассмотрим скрытый слой . Имеется зависимость: 


,
но , следовательно : 


Сумма, заключенная в квадратных скобках, известна из предыдущего шага.
Описание алгоритма.
0. Начальное приближение. Случайно выбираются веса небольших значений:   , , , .
1. Прямой проход. Для каждого вектора прецедента ,  вычисляются все , , , . Вычисляется текущее значение ценовой функции :
Цикл по  (по прецедентам):
Вычислить: 
  , .
.
Цикл по  (по слоям):
	Цикл по  (по нейронам в слое):
		 
		
	 Конец цикла по .
Конец цикла по .
Конец цикла по .

2. Обратный проход. Для каждого значения  и  вычисляется . Затем последовательно необходимо вычислить  для всех  и :
Цикл по  (по нейронам в слое):
Вычислить : 


Цикл по  (по слоям):
	Цикл по  (по нейронам в слое):
		
		
	Конец цикла по .
Конец цикла по .
Конец цикла по .
3. Пересчет весов. Для всех  и  , где .
Останов алгоритма может происходить по двум критериям: либо  стала меньше порога, либо градиент стал очень мал.
От выбора  зависит скорость сходимости. Если  мало, то скорость сходимости также мала. Если  велико, то и скорость сходимости высока, но при такой скорости можно пропустить .
В силу много экстремальности существует возможность спустить в локальный минимум. Если данный минимум по каким-то причинам не подходит, надо начинать алгоритм с другой случайной точки.
Данный алгоритм быстрее, чем алгоритм с обучением.
Метод потенциальных функций
Рассмотрим множество прецедентов. Пусть каждый из  них  имеет поле притяжения. Берем новый объект и смотрим, каким классом притягивается.
Пусть  - число классов. Обозначим эти классы через  и  соответственно. Рассмотрим обучающую последовательность . Без ограничения общности будем считать, что  и .
Каждая точка образует в пространстве признаков  некоторое поле притяжения. Например, можно рассматривать каждую точку как единичный заряд. Поле описывается потенциалом, создаваемым системой зарядов во всем пространстве.
В пространстве задана потенциальная метрика:    - потенциальная функция,  такая, что
, при ,
, 
где  - монотонно убывающая функция и  - ее максимальное значение. 
Пример. Пусть  - расстояние в . Рассмотрим функцию . Пусть  - параметр функции. Рассмотрим два примера функций :
 (рис. слева),
 (рис. справа). 

Пусть  и  - прецеденты первого и второго класса соответственно,  - пробный образ. Тогда потенциалы, создаваемые в пространстве точками из классов  и  будут иметь вид:
, 
соответственно.
Тогда правило классификации можно записать следующим образом: Если  то пробный образ  относится к классу , иначе к классу , при равенстве выдавать ответ "не знаю" (отказ от распознавания).
Если рассмотреть дискриминантную функцию , то задача сводится к поиску этой функции по обучающей последовательности.
Рассмотрим вариант метода потенциальных функций называется "наивным". Он имеет следующие недостатки. Если, например, в первом классе точек много больше, чем в остальных, то голоса первого класса подавят голоса других классов, то есть потенциал   больше потенциала  (рис. слева). Но даже,  если множества соизмеримы, могут возникнуть проблемы другого характера, например, погружение одних точек в другие (рис. справа). Поэтому наивный метод подлежит усовершенствованию.

Общая рекуррентная процедура 
 Пусть  - конечная или бесконечная система функций на . Будем искать дискриминантную функцию в виде 
.
Требования к рассматриваемому ряду:
Для бесконечного ряда требуем поточечную сходимость. 
Также желательно, чтобы  убывали быстро с ростом . Это необходимо для обеспечения хорошего совпадения "обрезанного" бесконечного ряда с .
Итак, пусть  -  базовая система функций. В качестве потенциальной функции будем рассматривать функцию вида 
,
где  удовлетворяет условиям:  и . Обозначим . Тогда 
.
Предположим, что
,
Тогда 
.
Для приближения предлагается рекуррентная процедура, называемая общей рекуррентной процедурой:
, .
Пусть
 - обучающая последовательность прецедентов;
 - некоторые числовые последовательности, которые должны задаваться так, чтобы обеспечить сходимость  к  при  в том или ином смысле.
Зададим начальное приближение . Как уже отмечалось, мы ищем функцию  в виде:
.
Мы сделали достаточно сильное допущение, сказав, что наше решение будем выражать через базовую систему функций. Т.е. мы априорно предполагаем, что  разложимо по системе функций :
 и .
Тогда, учитывая, что , получаем:
.
Обозначим  через
, 
Тогда
.
Откуда получаем вторую форму общей рекуррентной процедуры:
.
Для нахождения связи коэффициентов  и  воспользуемся второй формой для формулы общей рекуррентной процедуры и соотношением
, 
Получим соотношение, связывающее коэффициенты  и :
, где .
Для возможности итерационных вычислений необходимо понять, как вычислять параметры  и , а также начальное приближение .
Зададим функцию
,
где
 и   .
Тогда процесс перехода от  к  суть процесс подсчета коэффициентов. Обычно ,  вычисляется по следующему правилу : 
.
Возьмем следующее начальное приближение : 

Таким образом, при правильном определении  получаем, что ; а в случае ошибки

Данный процесс напоминает обучение в алгоритме персептрона.
Возникают следующие естественные вопросы:
Есть ли поточечная сходимость функции  к ?
Где взять базисные функции  в многомерном пространстве?
Попробуем ответить на эти вопросы.
Рассмотрим аналогию данного алгоритма с алгоритмом персептрона. Для функции 
произведем замену  и ,  - это вектор в бесконечномерном пространстве, тогда
,где  - спрямляющее пространство. Таким образом, если  или , то  или  соответственно. Пусть , тогда  и .
Выбор системы функций
Система функций  задается априорно. Обычно используют некую полную систему функций, например, на конечном отрезке можно взять систему тригонометрических функций. Эта система к тому же ортогональна. 
Утверждение. Если задана полная ортогональная система функций одной переменной, то можно построить полную ортогональную систему функций любого числа переменных.
Доказательство. Пусть  - полная ортогональная система функций на конечном интервале . Рассмотрим  систему 
, 
Эта система полна и ортогональна на декартовом произведении  экземпляров , то есть на . 
Проверим ортогональность. В скалярном произведении двух различных функций  и :
всегда найдется такое , что  и, в силу ортогональности системы , имеем:
.
Далее, пусть  - произвольная функция  переменных. Фиксируем все переменные, кроме , и получаем разложение функции :

Повторяем это рассуждение для  последовательности  раз:
, что и доказывает полноту системы
, 
ч.т.д.
Сходимость общей рекуррентной процедуры 
 Предположим, что обучающая последовательность есть выборка конечного объема из пространства  ( - пространство признаков). Тогда последовательность  есть последовательность случайных функций, и последовательность  - последовательность случайных чисел. Поэтому будем говорить о сходимости  в вероятностном смысле, то есть либо по вероятности, либо с вероятностью равной 1, либо в среднем.
Пусть  - случайные величины из , а  - выборка для конечного объекта.
Теорема. Пусть заданы два множества  и  и выполнены следующие условия.
1) Существует функция  такая, что 
,
,
где константа . 
2) Задана система функций ,  такая, что
,
,
.
3) Точки из обучающей последовательности независимые случайные величины, с одной и той же плотностью .
Тогда общая рекуррентная процедура, определяемая формулой
,
где ,  и 

сходится в следующем смысле: , при .
Теорема. Пусть выполнены все условия предыдущей теоремы. Пусть также на каждом -ом шаге работы общей рекуррентной процедуры существует строго положительная вероятность исправления ошибки, если функция  к -ому шагу еще не разделила классы и  . Пусть с вероятностью единица для каждой реализации процедуры существует конечное число  такое, что 
 - правильно разделяет  и , 
 - конечный интервал на прямой (), 
 - полная ортогональная система функций, ,
 при .
Тогда система функций

полна и ортогональна на пространстве .
Доказательство. Ортогональность очевидна. Докажем полноту. Пусть  - произвольная функция в  такая, что . Фиксируем переменные начиная с , тогда
, где .
ч.т.д.
Функции Эрмита 
 Если в качестве системы функций  взять функции вида
,
где  - полином Эрмита.
Тогда
.
Обозначим , где , тогда
.
КОМИТЕТНЫЕ МЕТОДЫ РЕШЕНИЯ ЗАДАЧ РАСПОЗНАВАНИЯ
Теоретико-множественная постановка задачи выбора алгоритма.
Байесовский подход исходит из статистической природы наблюдений. За основу берется предположение о существовании вероятностной меры на пространстве образов, которая либо известна, либо может быть оценена. Цель состоит в разработке такого классификатора, который будет правильно определять наиболее вероятный класс для пробного образа. Тогда задача состоит в определении "наиболее вероятного"  класса.
Пусть  - индексное множество;   ,  - подмножество некоторого множества (например, множества алгоритмов);  - система подмножеств. Пусть  - множество, в котором необходимо найти решение. Задача заключается в нахождении такого элемента  такое, что  .
Пример. Пусть , , , .
   так, что 
Тогда  - множество алгоритмов, дающих правильную классификацию :
, 
Определение. Пусть , . Тогда система подмножеств  называется совместной, если .
В примере условием совместности является не пересекаемость множеств  и . Тогда, очевидно, что в пересечении  лежит , где

Тогда возникает вопрос: что делать, если ? Существует два способа решения данной проблемы:
Смягчить условия, описывающие , т.е. построить .
Решить задачу поиска максимальных совместных подсистем системы , 
Определение. Теоретико-множественная задача называется разрешимой в классе , если , где .
Комитеты
Нас интересует случай, когда теоретико-множественная задача не разрешима. Идея комитетного метода распознавания состоит в использовании нескольких классификаторов, каждый из которых дает свой результат. Далее по какому-либо общему правилу голосования на основе полученных результатов от каждого классификатора выдается итоговый результат. 
Определение. Для исходной системы  и числа :  конечное подмножество  называется -комитетом в классе , если для всех  выполнено неравенство  (относительная доля , лежащая в , превосходит ). Если , то  -комитет называется просто комитетом.
Пример комитета для несовместной системы. Рассмотрим задачу исключающего или. , , , . Пусть  а - множество линейных классификаторов. Опишем множество :   ,   ,   ,   , . Пусть . Построим комитет :
 
 
 
			Класс						0	0	 B(0)	 0	0	1			1	1	 B(0)	 0	0	0			0	1	 A(1)	 1	0	1			1	0	 A(1)	 0	1	1		, , , . 
 .
Следовательно,  есть комитет в классе линейных классификаторов.
Определение. Пусть  (подмножества, возможно, бесконечные) и  - класс функционалов. Набор функционалов  называется разделяющим комитетом для множеств  и , если
, 
, 
Утверждение. Чтобы набор  был разделяющим комитетом для  и  необходимо, чтобы для каждой пары  и  нашелся такой , что  и .
Доказательство. Если  - число функционалов ,  - число функционалов , то 

И, т.к. найдется функционал, обладающий обоими свойствами, утверждение доказано.
ч.т.д.
Теорема. Пусть , ;   , , . И пусть ,  (нет нулевой точки);   , ,  (не коллинеарны). Тогда для таких  и  существует разделяющий комитет в классе аффинных функционалов: .
Доказательство. Построим комитет из  элементов (функционалов):

Для каждого функционала необходимо найти  и  в - пару, которая определяет функционал , причем , т.е.  и ,  , т.е.  не ортогонален остальным . Другими словами каждая гиперплоскость должна иметь направляющий вектор, ортогональный своему прецеденту и не ортогональный всем остальным.
Пусть . Выберем  следующим образом : 



Покажем, что построенное множество функционалов является комитетом для  и . Рассмотрим


 и  правильно классифицируют . Посмотрим, как будет работать каждй такой функционал на остальных :

Т.к. , то знак  определяется знаком .
Рассмотрим .   и  голосуют правильно, т.е.  соответствует правильное положение гиперплоскостей.  и  имеют разные знаки. Следовательно, каждая пара  и  правильно классифицирует на всех  и дает одну правильную классификацию на остальных . Таким образом, количество правильно голосующих за  равно .
ч.т.д.
Комитеты линейных функционалов
Пусть   , ,  в - конечные множества в пространстве признаков;  - точки общего положения.
Определение. Точки  пространства  называются точками общего положения, если никакая  точка не лежит в гиперплоскости размерности .
Пример. Пусть , т.е. рассматривается пространство  (плоскость). Тогда точки  - точки общего положения, если никакие три из них не лежат на одной прямой.
Теорема. Существует разделяющий комитет аффинных функционалов, состоящий из не более, чем  членов при нечетном  и не более, чем  при четном .
Доказательство. Рассмотрим случай , т.е. пространство .
Пусть , . Тогда возможны два случая.
	
Для первого случая (рис. слева) функционал имеет вид:
 
 Для второго случая (рис. справа) функционал имеет вид:

   - количество функционалов для худшего случая.
Пусть , . Тогда возможны следующие варианты.

Все случаи вида показанного на рис. слева сводятся к предыдущему (, ). Во всех остальных случаях функционалы надо располагать аналогично рис. справа. Для худшего случая .
Пусть  (четное количество точек). Рассмотрим худший из возможных вариантов.

В данном случае функционалы надо располагать как показано на рис. .
Пусть  (нечетное количество точек). Рассмотрим худший из возможных вариантов.

В данном случае функционалы надо располагать как показано на рис. . Все остальные случаи можно свести либо к этим двум, либо к предыдущим.
Таким образом, по методу математической индукции существует разделяющий комитет аффинных функционалов из не более, чем  членов при нечетном  и не более, чем  при четном  в пространстве .
Многомерный случай сводится к одномерному следующим образом. Ищем  подпространство  такое, что , при . Проектируем все  на соответствующие подпространства, пока не получим одномерную задачу. В многомерном случае для разделения  и  служит гиперплоскость : 

 ч.т.д.
Функция Шеннона
Пусть  - это число гиперплоскостей, достаточное для разделения любых точечных множеств  и  точек общего положения в пространстве .
Лемма 1. Если , то

Доказательство. Если , то добавим точки общего положения до . Через  точек из  проводим гиперплоскость:

Для  такого, что  . 
Выберем  и возьмем гиперплоскости  и .  и  отделяют точки  от всех остальных.
Аналогичным образом из оставшихся  точек выделяем еще  и строим еще пару гиперплоскостей. Далее из оставшихся  точек выделяем еще  и строим еще пару гиперплоскостей и т.д. В конце получим точек. Следовательно: 
 
 ч.т.д.
Утверждение 1. Если  разделяют множества  и , и  - непрерывная кривая в  такая, что , а , то существует  и  такие, что .
Утверждение 2. Любая гиперплоскость пересекает кривую  не более, чем в  точках.
Доказательство. Рассмотрим линейный функционал . Запишем условие пересечения гиперплоскости и кривой : 
.
Кривая  задана многочленом степени . Следовательно,  - то же многочлен степени . Значит, уравнение  является уравнением степени . Следовательно, т.к. корни могут быть кратными, данное уравнение имеет не более  корней.
ч.т.д.
Лемма 2. .
Доказательство. Построим . Рассмотрим последовательность точек :

 Пусть , где , . Тогда  - точки в .
	Без ограничения общности положим , при  нечетном, и , при  четном. Тогда получим непрерывную кривую (см. рис). 
Каждая гиперплоскость дает не более, чем  пересечений. Кривая должна иметь  разделение, т.е. должно быть  гиперплоскостей. Следовательно, всего гиперплоскостей должно быть не менее, чем , т.е. 
Т.к. , то .
Следовательно, 
, при нечетном ,
, при четном .
Окончательно получаем: , .
ч.т.д.
Пример. Пусть , , . Обозначим  и . Тогда
 и

:5. Метод построения комитета.
Пусть  - множество прецедентов;    в - размерность пространства признаков;  и  - количество прецедентов в каждом классе.
Построим  - линейный функционал такой, что, если , то объект из класса  (), и, если , то объект из класса  (). Если данный функционал правильно классифицирует меньше половины объектов, то возьмем его со знаком минус.
Итак, пусть линейный функционал  правильно классифицирует больше половины объектов. Разобьем множество прецедентов  на множество правильно классифицированных объектов  и множество неправильно классифицированных объектов , т.е. .
Далее строим последовательно пары функционалов  и :

Делаем очередной шаг. . Пусть на  -  правильно классифицированных объектов, а на  -  правильно классифицированных объектов. Строим пару , . В  выделяем  точек одного класса. Эти точки можно перевести в , т.е. , а .
На каждом шаге множество неправильно классифицированных объектов уменьшается на , следовательно, процесс сходится.
Общее число функционалов:   .
Теорема. Существует комитет линейных функционалов, в котором число членов не превосходит .
Классификация на основе сравнения с эталоном.
Пусть задано множество образов (эталонов). Задача состоит в том, чтобы для тестируемого объекта выяснить, какой эталон ближе на основе меры сходства (расстояния между объектами). Данная задача и получила название "сравнение с эталонами".
В качестве эталонов могут рассматриваться следующие объекты: 
1) Буквы в словах рукописного текста (применительно к распознаванию рукописного текста); 
2) Силуэты объектов в сцене (применительно к машинному зрению);
3) Слова (команды), произносимые человеком (применительно к распознаванию речи).
В этих примерах признаки не выделены, но можно измерить сходство. Например, сравнение слов: кошка ~ мошка ~ кора ~ норка и.т.д. Или силуэт объекта в сцене, чье положение и ориентация заранее не известны (применительно к машинному зрению, робототехнике).
Мера близости, основанная на поиске оптимального пути на графе 
Рассмотрим строчный образ (слово). В данном случае можно выделить два критерия, на основе которых можно строить меру близости:
совпадение букв,
монотонность (совпадение порядка букв).
Пусть  - эталон,  - пробный образ, причем . Построим соответствие между эталоном и пробным образом по следующему правилу: каждому символу в первом слове должен соответствовать хотя бы один символ во втором слове и каждому символу во втором слове должен соответствовать хотя бы один символ в первом слове, (но соответствие между символами не взаимнооднозначное, в частности, поскольку ).
Введем меру следующим образом :
 
В качестве меры сходства двух слов принимаем соответствие, при котором суммарный вес всех дуг (изображенных на рисунках) минимален:
  , где   .
Через    далее будем обозначать меру близости двух слов  и .
Соответствие  должно быть двудольным графом без изолированных вершин с непересекающимися ребрами. Рассмотрим задачу сравнения цепочек упорядоченных символов. В данной задаче могут возникать следующие ошибки:
неправильно определенный символ (кошка - корка),
ошибка вставки (кошка - кошрка),
ошибка потери (кошка - кшка).
Определение. Редакторским расстоянием называется минимальное общее число изменений, вставок и потерь, требуемое для изменения образа  в образ :
,где минимизация происходит по всем возможным комбинациям символьных преобразований таких, чтобы получить  из .
Пусть
.
Тогда 
.
Построим таблицу, в которой столбцы - это символы образа, строки - символы эталона. Количество точек в матрице есть . 
По данной таблице построим граф по следующему правилу. Если отображается точка , то далее выбираем ,  или  (т.е. возможны три варианта). Соответствие слов реализуется в виде маршрута в графе. Этот маршрут обязательно начинается с точки  (иначе появится изолированная точка) и заканчивается  в .
																																																Таким образом, получили задачу выбора кратчайшего пути на графе от точки  до точки , где каждая вершина имеет свою стоимость: 0 или 1.
Задача сравнения контуров 
В качестве примера рассмотрим задачу сравнения контуров. Контура изображаются ломаными линиями, вершины которых будем называть узлами. Пусть заданы две линии - эталон и тестируемый объект. Используем следующую модель для сравнения объектов. Будем считать, что они изготовлены из проволоки и будем сравнивать близость этих ломаных путем оценки величины механической работы, которую нужно выполнить, чтобы преобразовать один объект в другой. Определим элементарную работу, которую надо совершить для перевода отдельных прямолинейных элементов ломаных. Достаточно рассмотреть два основных вида деформаций: растяжение (сжатие) и изгиб в узлах.
Каждой такой деформации припишем элементарную работу:
 - работа по изменению длины при растяжении и сжатии,
 - работа по изменению угла при изгибе.
Задача состоит в поиске такого преобразования, чтобы затраченная работа была минимальной, т.е. надо найти 
.
Эта задача сводится к установлению соответствия узлов одной ломаной узлам другой. При этом не требуется взаимно-однозначное соответствие, но требуется сохранение монотонности. Задача установления такого соответствия, которое минимизирует общую работу по деформации ломаных, также сводится к поиску минимального пути на графе такого же типа, как и рассмотренный в предыдущем пункте. В графе каждая дуга получает вес  - работу по сжатию или растяжению, а для каждой вершина - вес  - работу по изменению угла.
Задача сравнения речевых команд

В обработке речи можно выделить следующие основные направления:
Распознавание отдельных слов ( IWR  -  Isolated Word Recognition ),
Распознавание слитной речи  (CSR - Continuous Speech Recognition).
CDR - Speaker Dependent Recognition,
SIR - Speaker Independent Recognition.
 Ядром  IWR -систем является совокупность эталонов и мера. Отрезок сигнала (см. рис.)  разбивается на сегменты, т.е. сигнал квантуется (с перекрытием). С каждым сегментом связывается вектор коэффициентов Фурье.
Обработка звука происходит в два этапа.
Первый этап. Строим цепочку ,  - разговорные сегменты. Далее строим преобразование Фурье с разбиением на  отрезков. Обозначим через,  - отчеты для -ого сегмента, . Тогда
, .
Рассмотрим первые ,  (пусть ), коэффициентов Фурье в качестве вектора признаков:
  , .
Второй этап. Определяем ограничения в графе соответствия сегментов эталонной и тестируемой команд.
Глобальные ограничения - ограничения поля для оптимального маршрута, например,  (рис. слева).
Локальные ограничения - монотонность на сети маршрутов (рис. справа),
Ограничения конечной точки,
Стоимость  - Евклидово расстояние между : .

Таким образом, и эта задача также сводится к поиску кратчайшего пути на графе.

Динамическое программирование
Задача поиска кратчайшего пути на графе может быть решены методом динамического программирования. Пусть  - начальный узел (отправной город),  - конечный узел (город - пункт назначения). Тогда задача состоит в поиске оптимального маршрута через промежуточные узлы (города):
.
Пусть  - промежуточный узел. Тогда по принципу оптимальности Беллмана имеем
,
причем .
КОНТЕКСТНО-ЗАВИСИМАЯ КЛАССИФИКАКЦИЯ
Постановка задачи
Рассмотренные ранее задачи предполагали, что нет зависимости между различными классами, т.е. имея вектор  из класса , мы могли получить следующий вектор из любого класса. Далее мы будем предполагать зависимость классов, т.е. классификация каждого нового вектора осуществляется в зависимости от классификации предыдущих векторов. Выбор класса, к которому следует отнести вектор, зависит от его собственного значения, значений других векторов, существующих отношений между различными классами. 
Такие задачи возникают во многих приложения: распознавание речи, обработка изображений и др.
Эта классификация называется контекстно-зависимой. 
Отправной точкой является Байесовский классификатор. Но зависимость между различными классами требует более общей формулировки проблемы. Общая информация, которая присутствует в векторах, требует, чтобы классификация была выполнена с использованием всех векторов одновременно и также была организованна в той же последовательности, в которой получена в экспериментах. Поэтому мы будем называть вектор признаков наблюдением, выстроенным в последовательность  из  наблюдений.
Байесовский классификатор
Пусть  - последовательность  наблюдений и ,  - классы, в которые эти вектора можно классифицировать. Пусть также  - одна из возможных последовательностей соответствия классов последовательности наблюдений, где , . Общее число таких последовательностей классов  есть . Задача заключается в том, чтобы решить, к какой последовательности классов отнести последовательность наблюдений. Это эквивалентно отнесению  к ,  к  и т.д.
Подходом к решению проблемы является рассмотрение каждой конкретной последовательности  как расширенного вектора признаков на ,  как на возможных классах. В данном случае Байесовское правило , при  эквивалентно , при .
Рассмотрим, как это правило выглядит для некоторого типичного класса контекстно-зависимых моделей.
Модель Марковской цепи
Одна из наиболее используемых моделей, описывающих зависимость классов, является правило Марковской цепи. Если  есть последовательность классов, то Марковская модель предполагает, что

Тогда зависимость классов ограничивается только внутри двух последовательных классов. Такой класс моделей называется Марковской моделью первого порядка. Возможны обобщения на второй, третий и т.д. порядок. 
Другими словами, даны наблюдения , принадлежащие классам  соответственно. Вероятность того, что наблюдение  на шаге  принадлежит классу , зависит только от того класса, к которому принадлежит наблюдение  на шаге .

или
 
Сделаем два общих предположения:
1) в последовательности классов наблюдения статистически независимы;
2) функция плотности вероятностей в одном классе не зависит от других классов.
Это означает, что зависимость существует только на последовательности, в которой классы встречаются, но внутри классов наблюдений "подчиняются" собственным правилам. Таким образом, получаем, что
 
Комбинируя  и , получаем Байесовское правило в виде следующего утверждения.
Байесовское правило: для последовательности наблюдений векторов  проводим их классификацию в соответствующие последовательности классов  так, чтобы величина
 
была максимальной.
Поиск требует вычисления последнего выражения для каждого , , что, в свою очередь, требует  умножений, а это очень много. Но существуют пути экономии вычислений. Если в  и  отличаются только последние классы, т.е. , при  и , то большая часть вычислений дублируется.
Алгоритм Витерби ( Viterbi )
Пусть задано  столбцов; каждая точка в столбце соответствует одному из  возможных классов ; столбцы соответствуют наблюдениям , . Стрелками обозначены переходы от одного класса к другому в последовательности получения наблюдений. Каждая последовательность классов  соответствует конкретному маршруту последовательных переходов. Каждый переход от  i -го класса к  j -му  характеризуется вероятностью , которая предполагается известной. Предположим, что эти вероятности одинаковы для всех . Далее предположим, что условные вероятности - плотности , ,  - также известны. Тогда задача максимизации  ставится как поиск последовательности переходов.
Пусть  - цена, связанная с переходом . Начальное условие при  есть . Учитывая данные предположения, получаем общую формулу, которую нужно оптимизировать:
 
 или, логарифмируя, имеем

Используем принцип Беллмана:
, при .
Обозначим через
.
Получаем обратный ход для вычисления . Получаем число операций , что существенней меньше . Данная процедура динамического программирования известна как алгоритм Витерби.
Скрытые Марковские модели
Теперь рассмотрим системы, в которых состояния напрямую не наблюдаются и могут быть лишь оценены из последовательности наблюдений с помощью некоторой оптимизационной техники. Этот тип Марковских моделей известен как скрытые Марковские модели (НММ). НММ - это тип стохастической аппроксимации нестационарных стохастических последовательностей со статистическими свойствами, которые подвергаются различным случайным переходам среди множества различных стационарных процессов. Иными словами, НММ моделирует последовательность наблюдений как кусочно-стационарный процесс. 
Такие модели широко используются в распознавании речи. Рассматриваются так называемые высказывания - это может быть слово, часть слова, даже предложение или параграф. Статистические свойства речевого сигнала внутри высказывания подвергаются серии переходов. Например, слово содержит порцию гласных и согласных звуков. Они характеризуются различными статистическими свойствами, которые в свою очередь отражены в переходах в речевых сигналах от одной к другой. Такие примеры дает распознавание рукописного текста, распознавание текстур, где успешно применяется НММ.
НММ есть в основе своей конечный автомат, который генерирует строку наблюдений - последовательность векторов наблюдений . Таким образом, НММ содержит  состояний, и строка наблюдений получается как результат последовательных переходов из одного состояния  в другое состояние . Нам подходит так называемая модель "машины Моора", в соответствии с которой наблюдения получаются как результаты (выходы) из состояний на прибытие (по переходу) в каждом состоянии.
Пример. НММ с тремя состояниями. Стрелки обозначают переходы. Такая модель может соответствовать короткому слову с тремя различными стационарными частями, например, для слова "оса".
Модель предоставляет информацию о последовательных переходах между состояниями , . Такой тип НММ известен как "слева-направо", поскольку индекс состояний определяется выделенным числом фонем в одном слове. В действительности, несколько состояний (обычно 3 или 4) используется для каждой фонемы.
СЕЛЕКЦИЯ ПРИЗНАКОВ
Задача селекции признаков
Рассмотрим этапы решения задачи распознавания образов:
Генерация признаков - выявление признаков, которые наиболее полно описывают объект.
Селекция признаков - выявление признаков, которые имеют наилучшие классификационные свойства для конкретной задачи.
Построение классификатора.
Оценка классификатора.
Пусть 
 - множество признаков, 
 - множество признаков, которые нужно отобрать в процессе селекции, причем . 
Тогда задача селекции задается следующим образом: .
Постановка задачи селекции признаков. 
Пусть задан вектор признаков . Среди них необходимо выбрать наиболее информативные, т.е. получить новый вектор признаков , причем .
Определение. Процедура выделения из множества признаков меньшего подмножества с наилучшим сохранением информативности для классификации называется селекцией признаков.
Суть выбора признаков - это выделение признаков, которые приводят к большим расстояниям между классами и к малым внутри классов.
Зачем нужна селекция признаков?
Основной мотивацией для сокращения числа признаков является уменьшение вычислительной сложности. Наряду с признаками, имеющими низкие классификационные способности весьма вероятна ситуация двух хороших признаков (с почти равными классифицирующими способностями), сильно коррелированных между собой.
Вторая причина для уменьшения числа признаков - повышение общности классификатора.
Общность классификатора.  
 Пусть
 - число прецедентов,
 - число степеней свободы классификатора (для нейронной сети - это количество синоптических весов).
Ясно, что чем больше степеней свободы, тем легче настроить классификатор. Обозначим через  характеристику общности. Тогда получаем, что, чем больше , чем выше общность классификатора.
Чем больше признаков, тем больше . Поэтому при ограниченном   уменьшение числа признаков согласуется с уменьшением , т.е. с усложнением настройки классификатора.
Различают скалярную и векторную селекцию признаков. При скалярной селекции рассматривается отдельно один признак из данного множества. Таким образом, получили одномерную задачу. При векторной селекции одновременно исследуются свойства группы признаков.
Предобработка векторов признаков
Пусть задано множество признаков. 
Селекции признаков предшествует предобработка, позволяющая привести их в единый масштаб измерений и произвести некоторые дополнительные улучшения.. 
Основные операции предобработки описываются следующими тремя пунктами.
2.1. Удаление выбросов - точек, лежащих "очень далеко" от среднего значения. Обычно измеряется расстояние в средних отклонениях, например, ,  для нормального распределения.
2.2. Нормализация. Признаки, имеющие большие значения, могут влиять на классификатор сильнее остальных, что искажает правильность классификатора. Поэтому необходимо уменьшить их влияние путем, который носит название нормализации. Пусть
 - прецедент,
 - признаки.
Тогда
, 
есть усреднение признака (фактически его математическое ожидание). 
Обозначим через 

оценку разброса. Тогда нормализованные признаки задаются следующим образом.
.
2.3. Пропуск данных (потери). По многим прецедентам могут быть известны не все признаки. В таком случае, если данных много, то можно отобрать те у которых набор признаков одинаковый. Если же отбрасывать признаки нельзя, то их можно дополнить, например, с помощью эвристик.
Селекция на основе проверки статистических гипотез
Этот метод относится к скалярной селекции признаков.
Рассмотрим значение признаков как реализацию случайных величин. Методами математической статистики можно выяснить их распределение. Если распределение совпадает для разных классов, то признак не различает эти классы; если распределения различны, то признак их различает. Такова суть метода селекции на основе проверки статистических гипотез.
Таким образом, задача скалярно селекции на основе проверки статистических гипотез решается путем оценивания дискриминантной способности каждого отдельного признака.
Постановка задачи
Пусть  признак. Пусть также известны его значения для разных классов  и . Тогда задача состоит в оценке, существенно ли различаются распределения признака для разных классов.
Примем следующие соглашения. Обозначим через  и  две гипотезы:
 - значения признаков отличаются существенно - нуль-гипотеза.
 - значения признаков отличаются несущественно - альтернативная гипотеза.
Общая теория проверки гипотез
Пусть
 - случайная величина с известной плотностью и неизвестным параметром ,
 - экспериментальные значения ,
 - статистика, где плотность есть .
Тогда гипотезы примут вид: :  и : . Задача состоит в построении интервала  такого, что в  высокая вероятность выполнения гипотезы .
Пусть  - дополнение к . Тогда, если  попадает в , то принимается , иначе отвергается.
Назовем вероятностью ошибки решения следующую величину:
,
причем  выбирается заранее и называется уровнем значимости:
.
Случай известной дисперсии. 
Пусть
 - неизвестное среднее,
 - известная дисперсия.
У нормализованных признаков дисперсия равна единице, следовательно, дисперсия известна. 
Оценка  задается следующим образом:
,
причем , , . Тогда гипотезы примут вид: :  и : .
В данном случае статистика имеет вид:
,
где  - среднеквадратичное отклонение для .
По центральной предельной теореме имеем:
.
Далее, . Следовательно, находим доверительный интервал  по : т.к. , то . Для уровня значимости  интервал принятия гипотезы  выбирается как интервал, в котором  q  лежит с вероятностью 1-. 
Случай неизвестной дисперсии. Если дисперсия неизвестна, то оценка есть несмещенная оценка дисперсии и  есть статистика (не гауссова величина).
Если  гауссова величина, то имеет -распределение Стьюдента с  степенями свободы. Тогда доверительный интервал  вычисляется по таблицам. 
Приложение к селекции признаков
Наша основная забота теперь - проверить отличие и  между средними значениями признака в двух классах.
Пусть 
 - значение признака в первом классе со средним . Соответственно, 
 - значение признака во втором классе со средним.
Предположим, что дисперсии одинаковы в обоих классах. Пусть  и  - средние для значений признаков в первом и втором классе соответственно. Тогда соответствующие гипотезы имеют вид: 
: ,
: .
Для решения о близости двух классов мы проверим эти гипотезы.
Пусть .
Гипотеза о равенстве параметров распределения говорит о попадании в этот интервал величины , где  и  - случайные величины, причем  и 
Для случая неизвестной дисперсии статистика имеет вид:

и несмещенная оценка дисперсии записывается следующим образом:
 
  имеет  распределение с  степенями свободы. 
Если  x ,  y  - нормально распределенные с одинаковыми дисперсиями, тогда случайная величина имеет -распределение Стьюдента с  степенями свободы.
Если числа прецедентов в обоих классах не совпадают, то формулы модифицируются.
Мера различия плотностей признаков
Если средние значения различаются, и дисперсии очень большие, то признак может не обладать хорошими разделительными свойствами. Средние значения могут не совпадать и хорошо разделяться, но при больших дисперсиях признак становиться неудовлетворительным. Поэтому нужна информация о перекрытиях между классами. Рассмотрим способ анализа информации о перекрытии плотностей распределения признаков. 
Принимать решение, к какому классу отнести объект будем по значению . Пусть  и  - ошибки при пороге классификации .
Идеальным случаем является случай, когда , т.е. у признака нет селективных способностей: . Рассмотрим параметрическую кривую: . Тогда в качестве меры различия распределений можно использовать площадь разности между кривой реального случая и идеального случая, которая выражается следующим интегралом .


Векторная селекция признаков. Мера отделимости классов
Ранее обсуждались дискриминантные свойства отдельных признаков. Теперь рассмотрим дискриминантные способности векторов признаков.
Пусть
 - множество признаков,
 - подмножество из  признаков,
 - мера отделимости классов на множестве признаков .
Тогда задача выглядит следующим образом:
.
Существует различные подходы к описанию меры отделимости. Мы рассмотрим два таких подхода: дивергенцию и матрицу рассеивания.
Дивергенция
Будем рассматривать Байесовское правило:
,
по которому выбирается . Ошибка классификации задается следующим интегралом:
.
Пусть
 - область решения по классу ; если , то класс ;
 - все пространство признаков,
 - очень важный показатель разделимости классов. От этой разности зависит ошибка классификации;
 - информация о разделяющих свойствах вектора признаков (другая форма этого показателя).
Информацию о разделяющих свойствах вектора признаков можно записать следующим образом:
.
Если 
,
то
,
где  - характеристика отделимости. Аналогично:
.
Обозначим через  дивергенцию разделения классов по вектору признаков . Аналогично для случая многоклассовой задачи  - дивергенция классов  и . Тогда 
.
Дивергенция есть мера расстояния между плотностями. Она имеет следующие свойства:
(0; =0 при  i = j ;  dij = dji . Если компоненты вектора признаков независимы, можно показать, что  dij ( x 1, x 2,., xl )=( dij ( xr ).
Дивергенция учитывает различия и в средних, и в дисперсии. Однако, она очень чувствительна к разности средних, что затрудняет использование.
Мера на основе матриц рассеивания
Главный недостаток многих критериев отделимости классов - сложность вычисления, если не проходит предположение о гауссовых плотностях. Мы рассмотрим простой критерий, не требующий нормальности распределения, построенный на информации, относящейся к тому, как вектора признаков разбросаны в пространстве.
Пусть
 - матрица ковариации, , где  - вектор признаков и  - среднее значение по , принадлежащим данному классу, .
 - матрица внутриклассового рассеивания есть мера дисперсии признаков, где  - априорная вероятность данного класса, .
 - матрица внеклассового рассеивания, где - общее среднее - разброс относительно общего среднего всех классов (центр тяжести).
 - смешанная матрица рассеивания (ковариация относительно общего среднего), .
Определение. Следом (обозначается ) называется сумма диагональных элементов матрицы.
Пример. Пусть задана матрица . Тогда .
Пусть
 - критерий, принимающий большие значения, когда образы хорошо кластеризуются вокруг своих средних в границах каждого класса и кластеры разных классов хорошо разделены. Иногда вместо  используют . Тогда получаем задачу .
Вместо критерия  можно использовать другие критерии: 
,
.
Последний критерий очень удобен на практике для аналитических выкладок.
Стратегия наращивания вектора признаков
Стратегия наращивания вектора признаков заключается в использовании признаков, дающих наибольший прирост меры отделимости.
Рассмотрим алгоритм наращивания вектора признаков. Пусть из  l  признаков нужно отобрать  m . 
Рассмотрим множество признаков . Необходимо найти признак, имеющий наибольшую селективную способность. Это аналогично нахождению . Пусть , где .
Пусть  - построенное множество признаков. Далее, .
Условие остановки: , либо  r = m .
Стратегия сокращения вектора признаков 
Пусть  - множество признаков.
Шаг алгоритма: набор признаков , чтобы выполнялось  и .
Условие остановки: , либо  r = m .
Выбор стратегии 
Пусть  l : 1< l < m . Если , то используем стратегию сокращения вектора признаков. Если , то используем стратегию наращивания вектора признаков.
В качестве альтернативы можно использовать сравнение  с . Если , то используем стратегию сокращения вектора признаков. Если , то используем стратегию наращивания вектора признаков.
Обе стратегии являются жадными.
Определение. Стратегия  называется "жадной", если она не допускает шагов возврата.
Алгоритм плавающего поиска 
Примером нежадной стратегии является метод плавающего поиска. Плавающий поиск базируется на стратегии вставки и исключения.
Пусть все признаки упорядочены по убыванию меры . Пусть также  - первые  k  признаков, имеющие наибольшее . Тогда остальные признаки строятся следующим образом:
,
.
Предположим,  что построены множества . Рассмотрим алгоритм плавающего поиска.
Шаг 1. Вставка. 
Добавление признаков:  и .
Шаг 2. Проверка
, где  - признак дающий наименьший вклад (минимальные потери при выбросе).
Если , то увеличиваем   и переходим на шаг 1.
Если  и , то переходим на шаг 1.
Если , то  и переходим на шаг 1.
Шаг 3. Исключение . 
.
Поиск наименее значительного элемента в новом множестве . 
Если , то  и переходим на шаг 1.
Если , то уменьшаем  на 1.
Если , то ,  и переходим на шаг 1.
Переходим на шаг 3.
Оптимальная селекция признаков
Существуют две формы использования критериев (мер отделимости классов): "пассивная" и "активная". Пассивная селекция - это работа с уже полученными признаками. Активная селекция аналогична процессу генерации признаков: она позволяет построить из исходного набора признаков новый набор меньшего размера, в котором состав признаков, вообще говоря, не является подмножеством исходного набора признаков. Все типы селекции,  рассмотренные в предыдущих разделах - пассивные.
Пусть  и . Рассмотрим конструирование критериев с использованием активной селекции:   или .
Пусть
 и  - вектора столбцы, тогда ,  - строки,
 - исходное пространство признаков,
 - результирующее пространство признаков,
 - матрица преобразования исходного пространства в результирующее,
 - число классов.
Тогда 
,
или
,
следовательно, матрица  имеет размер .
Рассмотрим критерий . Будем максимизировать критерий  путем выбора матрицы . Для вектора признаков  имеем матрицы  и . Для вектора признаков  имеем матрицы  и .
.
Проведем несколько преобразований.


Аналогично: . Тогда  - критерий разделимости вектора признаков.
Теперь необходимо преобразовать  из соображений . Будем искать решение из условия максисума
.
Утверждение о вычислении производной. Пусть  и  - некоторые квадратные матрицы размера . Тогда 
.
Для получения максимума по критерию, необходимо, чтобы

или

или

есть условие того, что
.
Утверждение. Пусть  и  - симметрические, положительно определенные матрицы. Тогда существует преобразование, приводящее одну из них к единичной, а другую к диагональной.
Доказательство. Приведем эти преобразования 
,
,
где  - матрицы размера .
ч.т.д.
Утверждение.  инвариантно относительно преобразований вектора  в .
Доказательство. Рассмотрим
.
Тогда


.
Т.к.  - условие того, что производная равна нулю, то


Используя предыдущее утверждение, подбираем матрицу и получаем:
.
Обозначим  - матрица размера .
ч.т.д.
Утверждение. Если матрица  положительно определенная (положительно полуопределенная), то
все собственные значения  положительны,
если  симметричная, то все собственные вектора, соответствующие разным собственным значениям, ортогональны,
для симметричной матрицы  существует преобразование , где  состоит из собственных векторов этой матрицы или столбцы  - собственные вектора, причем  - диагональная матрица, на диагоналях которой стоят собственные значения.
Т.к. случайные величины ортогональны, то .
Теперь рассмотрим алгоритм оптимальной селекции признаков:
Поиск .
Поиск собственных значений и выбор  наилучших (наибольших).
Формирование матрицы  из собственных векторов,  соответствующих этим собственным значениям
Вычисление .
Оптимальная селекция признаков с помощь нейронной сети
Пусть задано  признаков,  - вектор признаков. Для применения теории нейронных сетей к задаче селекции признаков немного изменим обычное представление о нейронной сети. Теперь будем рассматривать нейронную сеть с линейными функциями активации. Таким образом, теперь вектор признаков, попавший на вход нейронной сети, просто суммируется и подается на выход, т.е. выход нейрона превращается в обычную сумму. 
Рассмотрим так называемую автоассоциативную сеть. Сеть имеет  l  входных и  l   выходных узлов и единственный скрытый слой с  m  узлами и линейными функциями активации. В процессе обучения выходы сети те же, что и входы. Такая сеть имеет единственный максимум и выходы скрытого слоя определяют проекцию  l  -мерного пространства на  m -мерное подпространство.
Интерес представляет выходной слой из  нейронов. Если восстанавливать исходный вектор с целью максимального правдоподобия, то получим задачу квадратичного программирования с одним экстремумом.
МЕТОДЫ ГЕНЕРАЦИИ ПРИЗНАКОВ
Генерация признаков на основе линейных преобразований
В данном разделе рассматриваются способы генерации признаков через линейные  преобразования исходных измерений образов. Целью такой генерации признаков является сокращение информации до "значимой", т.е. надо просто преобразовать исходное множество измерений в новое множество признаков. Обычно задача состоит в выделении низкочастотных компонент, содержащих основную информацию.
Базисные вектора 
Пусть
 - множество исходных измерений,
 - соответствующий вектор столбец.
Рассмотрим унитарную матрицу . Для действительной матрицы  условие унитарности обозначает, что матрица  ортогональная, т.е.  . Для комплексной матрицы  условие унитарности обозначает, что , где матрица  - транспонированная (сопряженная).
Пусть
,
где  - строки из транспонированных столбцов  и . Тогда 
.
Вектора  называются базисными векторами. Таким образом, в силу ортогональности  между собой,  - это проекция вектора  на базисные вектора.
Случай двумерных образов
Пусть ,  - двумерные измерения. Очевидно, что представление его в виде вектора размерности  неэффективно. Альтернативой является преобразование  через базисные матрицы.
Пусть  и  - унитарные матрицы. Определим матрицу преобразования  в :
.
Учитывая, что  и , имеем
.
Следовательно
 
Пусть 
, где  - вектор-столбец, 
, где  - вектор-строка.
Тогда 
.
Таким образом  есть выражение  в терминах  базисных матриц. Если  - диагональная,  то  - это разложение по базисным матрицам или образам.
Также возможна следующая запись:
.
Тогда 
.
Преобразование Карунена-Лоева 
Пусть  - вектор измерений образа. Целью преобразования является построение такого вектора признаков, что
 при .
т.е. чтобы признаки были взаимно некоррелированны.
Пусть
 - матрица базисных векторов,
 и  - вектора-столбцы.
Будем считать, что
.
Обозначим , тогда
,
где  - симметричная матрица и ее собственные вектора ортогональны.
Выберем в качестве  собственные вектора матрицы . Тогда  - диагональная матрица, у которой на диагонали стоят собственные значения : ,   . Таким образом
.
Если  положительно определенная матрица, то собственные значения , .
Описанное преобразование называется преобразованием Карунена-Лоева. Оно имеет фундаментальное значение, т.к. оно приводит к построению некоррелированных признаков.
Свойства преобразования Карунена-Лоева
Пусть
 или  - разложение по базисным векторам.
Определим новый -мерный вектор () : 

где  - проекция  на подпространство. Если мы аппроксимируем  с помощью, то ошибка есть (выбираем те векторов,  для которых ошибка минимальна):

.
Тогда очевидно, что выбирать нужно  базисных векторов с максимальными собственными значениями.
Отметим еще раз соотношение преобразования Карунена-Лоева с методом селекции признаков. В методе селекции признаков в качестве критерия выступали дискриминантные свойства полученного вектора признаков. В преобразовании Карунера-Лоева в качестве критерия выступает наилучшее приближение исходных измерений.
Применение преобразования Карунена-Лоева к задаче классификации
В данном случае основная концепция заключается в том, что подпространство главных собственных значений может быть использовано для классификации.
Алгоритм:
для каждого класса  строим корреляционную матрицу ,
выбираем  главных собственных значений и собственных векторов,
строим соответствующие матрицы , у которых столбцы - значения собственных векторов.
неизвестный (пробный) вектор  классифицируем по правилу  при , т.е. в ближайшее подпространство.
Если все подпространства одинаковой размерности, то разделяющие поверхности - это гиперплоскости, иначе гиперповерхности второго порядка. Такой классификатор интегрирует все: генерация, селекция, классификация.
Декомпозиция сингулярных значений 
Пусть задана матрица  ранга . Покажем, что существуют такие унитарные матрицы  и , что
, ,
где  - диагональная матрица с элементами  и  -  ненулевых собственных значений матрицы . Иначе существуют такие унитарные матрицы  и , что преобразованная  путем  есть диагональная матрица. Следовательно
 
где  и  - первые  столбцов матриц  и  соответственно, т.е.  и  - собственные вектора матриц  и  соответственно.
Собственные значения  называются сингулярными значениями матрицы . Преобразование  - преобразование сингулярных значений или спектральное представление .
Если  аппроксимировать следующим образом 
 ,
то  есть сумма  одноранговых матриц и имеет ранг равный . Можно показать, что квадратичная ошибка 

является минимальной для всех -ранговых матриц. Ошибка аппроксимации есть
,
следовательно, и в данном случае нужно выбирать максимальное . 
Таким образом,  есть наилучшая аппроксимация в смысле нормы Фробениуса. Данная аппроксимация напоминает преобразование Карунена-Лоева.
Дискретное преобразование Фурье (ДПФ)
Преобразования типа Карунена-Лоева есть результат специальной обработки (оптимизации) применительно к конкретной выборке требует больших вычислительных затрат. Если разложить по некоторому заданному базису, то можно снизить затраты, правда снизив требования к разложению.
Одномерное дискретное преобразование Фурье 
Пусть  -  исходных измерений. Тогда ДПФ определяется следующим образом:
,
где    и   .
Обратное преобразование есть:
,
где .
Определим
.
Тогда
.
Пусть
,
тогда
,
.
Утверждается, что  - унитарная симметрическая матрица. Пусть  - сопряженная матрица: . Тогда базисные вектора - это столбцы матрицы . Таким образом, имеет место разложение по заданному базису (по определению  - разложение по базисным векторам).
Прямое вычисление
 или 
имеет сложность , однако, специфика структуры матрицы  позволяет строить алгоритмы сложности .
ДПФ можно рассматривать как разложение последовательности  в множество  базисных последовательностей :
,
где 
 - коэффициенты разложения,
а последовательности  ортогональные:

Двумерные ДПФ 
Пусть ,  - двумерные измерения. Тогда двумерное ДПФ есть:
.
Обратное преобразование:
.
Данную запись компактно можно переписать в следующем виде:
, .
Данное преобразование - это преобразование с базисными матрицами или образами, . Число требуемых операций "в лоб" равно . Учитывая специфическую структуру , существуют методы сложности .
Дискретное косинусное преобразование (ДКП)
Данное преобразование имеет вид:
, ,
где
, ,
где 
Его можно переписать в векторной форме:
,
где 
и  - действительная матрица, причем .
Двумерное ДПФ определяется так 
 и .
Дискретное синусное преобразования (ДСП)
Данное преобразование вычисляется аналогично косинусному через матрицу:
, .
Вычислительная сложность затрат на ДКП и ДСП есть .
ДКП и ДСП обладают хорошими "упаковочными" свойствами для большинства изображений в том смысле, что концентрируют основную информацию в небольшом числе коэффициентов. Объясняется это тем, что оба они дают хорошее приближение для большого класса реальных образов, моделируемых случайных сигналов, известные как Марковский процесс 1-ого порядка.
Преобразования Адамара и Хаара
Преобразование Адамара и Хаара имеют такие же вычислительные достоинства, как и ДПФ, ДКП, ДСП. Их матрицы состоят из , поэтому они вычисляются через сложения и вычитания без умножений.
Преобразование Адамара 
Определение. Унитарная матрица Адамара порядка  - это  матрица , где , сгенерированная по следующему итерационному правилу
  ,
где
,
и  обозначает кронекерово произведение двух матриц:
.
Распишем :
.
По аналогии можно выписать все , . Нетрудно установить ортогональность , :
  .
Для вектора  из  образцов пара преобразований есть:
, .
Преобразование Адамара имеет очень хорошие "упаковочные" свойства. Алгоритм для вычисления выделений и сложений достаточно быстрый:   .
Преобразование Хаара
Начальной точкой для определения преобразования Хаара являются функции Хаара, которые являются непрерывными и определенными на замкнутом сегменте .
Порядок  функций Хаара единственным образом раскладывается через два целых числа  и :
  , , ,
где ,  для  при  или  при .
Определение. Функции Хаара :
 ,  ;
 
Генерация признаков на основе нелинейных преобразований. Выделение текстуры изображений.
Пусть дано изображение или его часть (область). Задача состоит в генерации признаков, которые впоследствии будут использоваться при классификации.
Определение. Цифровое изображение (монохромное) есть результат процесса дискретизации непрерывной функции  в виде двумерного массива , где , . Значение функции  - интенсивность, число градаций  - глубина изображения.
Определение. Генерацией признаков называется эффективное кодирование необходимой для классификации информации, содержащейся в оригинальных (исходных) данных.
Региональные признаки. Признаки для описания текстуры
Дадим не точное определение текстуры.
Определение. Текстурой называется распределение оттенков серого цвета среди пикселов в регионе.
Рассмотрим основные типы характеристик:
тонкие - грубые,
гладкие - резкие (нерегулярные),
однородные - неоднородные.
Отметим, что в основе подхода лежит гипотеза о том, что внутри региона значения интенсивностей описываются одинаково, т.е. одним и тем же распределением вероятностей. 
Пусть интенсивность внутри региона есть случайная величина. Тогда, при условии, что внутри региона характеристики одинаковы, данная случайная величина внутри региона одинаково распределенная, чем обеспечивается свойство однородности в регионе.
Нашей целью является генерация признаков, которые как-то квантуют свойства фрагментов изображения (регионов).
Данные признаки появляются при анализе пространственных соотношений по распределению серых цветов.
Признаки, основанные на статистиках первого порядка
Пусть  - интенсивность случайной величины, представляющая собой значение (уровень интенсивности) серого цвета в регионе. Пусть также  - вероятность, того что интенсивность в регионе равна .
Определение. Гистограммой первого порядка называется величина , равная отношению числа пикселов с уровнем интенсивности  к общему числу пикселов в регионе и обозначается .
Рассмотрим центральный момент:
,
где  - среднее значение интенсивности - первый момент, который в общем случае определяется из формулы:
 
 при .
Среди центральных моментов наиболее часто используются
 - дисперсия  ,
 - ассиметрия,
 - эксцесс.
В качестве признаков, основанных на статистиках первого порядка, также может использоваться абсолютный момент:
 
 и энтропия:
,
которая определяет меру равномерности распределения. Чем энтропия выше, тем распределение равномернее.
Признаки, основанные на статистиках второго порядка. Матрицы сочетаний. 
Пусть  - относительное расстояние между пикселами,  - ориентация. Тогда можем ввести метрику следующим образом:
,
причем пикселы рассматриваются в парах.
Рассмотрим соседство для четырех пикселей. Пусть , т.е у нас имеется горизонтальное, вертикальное, диагональное и антидиагональное соседство.
Обозначим через  совместную плоскость. Рассмотрим .  - вероятность того, что точки, расположенная на горизонтали  имеют интенсивности  и , равные отношению числа пар пикселов с расстоянием  и значением и  к общему числу пикселов в регионе.
Аналогично считается  для ;  для ;  для . Каждый такой массив называют матрицей сочетаний или матрицей пространственной зависимости.
Рассмотрим конкретный пример матрицы . Пусть , т.е. уровни интенсивности изменяются от 0 до 3. Пусть также матрица  задана следующим образом:
.
Т.к. просмотр происходит в обе стороны, то общее количество пар равно 24.
Рассмотрим  и . . Очевидно, что матрица  является симметрической.

Для  и  матрица  выглядит следующим образом:

Существуют следующие основные виды признаков, основанные на статистиках второго порядка:
Угловой момент второго порядка:  - мера гладкости изображения. При малой вариации , а при больших вариациях (например при  увеличении) контраста .
Контраст (по заданной паре):  - мера локальной дисперсии серого.
Момент обратной разности: . Момент обратной разности имеет большое значение для слабоконтрастных изображений.
Энтропия:  - мера равномерности. Энтропия связана с фиксированной ориентацией и фиксированным расстоянием.
Признаки формы и размера 
Рассмотрим методы генерации признаков, описывающих структуру. Существует два основных пути описания формы:
Полное описание формы в регенеративной манере (например, признаки Фурье). По такому описанию полностью можно восстановить образ.
Не восстановительное описание формы (дескриптивные признаки). По такому описанию можно отличить заданную форму от других, но не полностью восстановить образ.
Признаки Фурье
Отметим, что полное описание позволяет восстанавливать границу образа. Частичное же описание дает признаки для распознавания. Нас интересует вопрос о зависимости изменения признаков от преобразований.
Пусть , где , - координаты последовательных точек границы;  - комплексные числа. Для  точек  определим ДФП ( DFT ):
, ,
где  - Фурье-описание границы.
Рассмотрим, как изменяется  при сдвиге, повороте, масштабировании и сдвиге начальной точки.
Сдвиг описывается следующим образом: ,  и . Тогда 
, где .
При  , т.к.
.
При  , т.к. 

Поворот описывается следующим соотношением: . Следовательно, , т.е. поворот не меняет модулей, а именно .
Масштабирование описывается следующим соотношением: . Следовательно, . Т.к.
 и ,
то масштабирование не меняет соотношения
.
Сдвиг начальной точки определяется следующим образом: . Следовательно
,
т.е. сдвиг начальной точки сохраняет модули: .
Цепной код
Определение. Цепным кодом называется кодирование (запоминание) последовательности поворота вектора по пикселям на границе описываемой области - маршрута обхода.
Из построенного цепного кода конструируются следующие признаки:
относительная доля каждого направления,
относительная доля разных сочетаний кривизны.
Недостатком представления изображения цепным кодом является появления шума. Способом борьбы с данным недостатком является использование более мелкой (точной) сетки.
Геометрические свойства фигуры
Пусть  - периметр фигуры,  - площадь фигуры. Рассмотрим следующие свойства: некруглость фигуры и энергию изгиба.
Некруглость фигуры определяется по следующей формуле:
.
Рассмотрим два крайних значения для данного свойства. Наиболее лучшее (наибольшая "круглость") значение должно быть для круга, оно равно 
.
Наиболее худший вариант (наименьшая "круглость") наблюдается у квадрата. Соответствующее значение равно
.
Энергия изгиба. Пусть задано  точек фигуры. Тогда Энергия изгиба описывается следующей формулой:
,
где  и .  характеризует изменение угла в вершине.
Скелетизация
Определение. Скелетизацией называется построение скелета, описывающего форму фигуры.
Определение. Скелетом называется множество всех центров вписанных в фигуру максимальных окружностей.
 MAT  ( Medial Area Transform ) определяется как скелет плюс функция ширины фигуры.
Обучение по прецедентам (по Вапнику, Червоненкису)
Задача построения классификатора
Пусть 
 - пространство образов,
 - признаковое пространство,
,  - индикаторная функция,
 - множество признаков.
Тогда .
Пусть также
,  - множество прецедентов,
 - решающее правило.
Тогда .
Выбор решающего правила исходит из минимизации , где  - метрика, мера близости функций и. Построение  называют задачей обучения.  - это ученик, процедура формирования - это учитель, прецеденты - это обучающая последовательность.
Качество обучения классификатора
Относительная доля несовпадений классификации с учителем для решающего правила есть: , где . Надежность обучения классификатора - это вероятность получения решающего правила с заданным качеством.
Пусть  - класс дискриминантных функций, где ( ( A  - параметр. Число степеней свободы при выборе конкретной функции в классе определяется количеством параметров в векторе ( , т.е. размерностью  A . 
Например, для классов линейных и квадратичных функций имеем:
Линейная дискриминантная функция: . В таком случае имеем  степень свободы.
Квадратичная дискриминантная функция: . В таком случае имеем  + степеней свободы.
С увеличением степеней свободы увеличивается способность классификатора по разделению.
Вероятностная модель
Пусть прецеденты - это результат реализации случайных величин. Рассмотрим величину риска (т.е. ошибки) связанной с классификацией. Определим понятия риск среднего и риска эмпирического.
Пусть на  заданы -алгебра и мера . Пусть также
 - вектор признаков,
 - класс функций, из которых выбирается решающее правило,
 - решающее правило (результат классификации), которое принимает значение 0 или 1 при фиксированном векторе параметра,
 - характеристическая функция множества,
 - множество параметров, описывающие различные функции в .
Тогда  , где  и , .
В данных обозначениях средний риск выглядит следующим образом:
.
Для случая двух классов, при , имеем:

или
,
где  - это вероятностная мера на пространстве .
Задача поиска наилучшего классификатора
Рассмотрим минимизацию функционала:
 
 Задача же поиска наилучшего классификатора состоит в нахождении  такого, что
.
Если же минимума не существует, то надо найти  такое, что
.
Другими словами, необходимо решить задачу минимизации среднего риска.
Поскольку  неизвестно, будем решать задачу минимизации эмпирического риска. Пусть  - число прецедентов. Тогда эмпирический риск задается выражением:
.
Таким образом, задача минимизации эмпирического риска выглядит так:
,
где случайные величины мы минимизируем по параметру  - любой возможный параметр.
В идеале надо получить взаимосвязанные оценки эмпирического и среднего риска.
Отметим, что чем меньше , тем легче построить  такую, что  обращается в ноль, либо очень мало. Но при этом истинное значение  может сильно отличаться от . Необходимо выбрать  такую, чтобы имела место равномерная сходимость по  выражения:
.
Фактически это есть сходимость частот к математическому ожиданию.
В дальнейшем будем считать,  что  в  зависимости  от  конкретного  набора  прецедентов  можем  получить любые . Но необходимо, чтобы полученные эмпирическое решающее хорошо работало (отражало общие свойства) для всех образов. Поэтому в формуле присутствует равномерная сходимость.
Сходимость эмпирического риска к среднему. Случай конечного числа решающих правил. 
Пусть
 - математическое ожидание ошибки классификатора ,
 - событие - ошибка классификатора при решающем правиле ,
 - вероятность,
 - частота в  испытаниях.
Воспользуемся неравенством Бернштейна, тогда

есть оценка - соотношение между частотой и вероятностью при заданном количестве испытаний.
Пусть  - случайная величина. Тогда  - математическое ожидание ,  - дисперсия, причем . Обозначим . Тогда соответствующая оценка имеет вид:
, где .
 и ,
где  - необходимое количество прецедентов для обеспечения близости.
Теорема. Пусть из множества, состоящего из  решающих правил, выбирается правило, частота ошибок которого на прецедентах составляет . Тогда с вероятностью  можно утверждать, что вероятность ошибочной классификации с помощью данного правила  составит величину, меньшую , если длина обучающей последовательности не меньше , где ,  и  заданы и последовательность независима. 
Данная теорема справедлива для случая конечного числа решающих правил. Вапник и Червоненкис смогли обобщить эти оценки на случай бесконечного числа решающих правил.
Случай бесконечного числа решающих правил 
Введем понятие "разнообразия класса функций для бесконечного множества". Пусть  - прецеденты.
Определение. Дихотомией называется разбиение множества на два подмножества.
В нашем случае имеем  дихотомий. Итак, пусть ,  - это класс решающих правил, причем . Пусть  есть количество дихотомий на классе решающих правил. Тогда зададим энтропию следующим образом:
,
где математическое ожидание берется по всем выборкам . Тогда

есть энтропия класса  решающих правил на выборках длины .
Критерий равномерной сходимости  к вероятностям 
Теорема. Для равномерной сходимости  к  по классу  необходимо и достаточно, чтобы .
Суть данного критерия - не пытаться выделить очень точный классификатор, так как это отдаляет от общности.
Сразу же возникает проблема необходимость перехода к бесконечным системам решающих правил. Существенно, что значение имеет лишь конечное подмножество систем решающих правил, необходимое для разделения конечного числа прецедентов.
Достаточное условие равномерной сходимости 
Проверка условия критерия равномерной сходимости по вероятности затрудняется неопределенностью распределения выборки. Поэтому достаточные условия формулируются таким образом, чтобы не зависеть от распределения и при этом гарантировать равномерную сходимость. В таком случае вместо энтропии рассматривается величина:
,
где  - это функция роста класса решающих функций .
Т.к. логарифм максимума равен максимуму логарифмов, что, в свою очередь, не меньше математического ожидания от логарифма, то . Если , то по свойствам пределов . 
Данное условие легко проверятся для различных классов решающих правил.
Другими словами  можно трактовать как максимальное число способов разделения  точек на два класса с помощью решающих правил , .
Теорема. Функция роста либо тождественно равна , либо, мажорируется функцией , где  - минимальное значение , при котором , т.е. либо , либо .
В свою очередь . Значит  , где , и  - степенная функция, мажорирующая .
Существует максимум  точка, которая еще разбивается всеми возможными способами с помощью правила , но никакие  точек этим свойством не обладают.
Определение.  называется емкостью класса решающих функций или мера разнообразия решающих правил в классе  или  VC -размерностью класса - универсальная характеристика класса решающих функций.
Отметим, что если  для всех , то емкость бесконечна.
Теорема. Если емкость класса решающих функций конечна, то всегда имеет место равномерная сходимость частот к вероятностям такое, что

и достаточное условие выполнено.
Скорость сходимости 
Запишем оценку для бесконечного числа решающих правил. Ее вид аналогичен случаю конечного числа решающих правил:
.
Если емкость бесконечна, то оценка тривиальная (не больше единицы). Пусть  - конечная емкость класса решающих функций. Тогда
.
Введем обозначение: ,
Тогда .
Отсюда следует, что.
Значит, с вероятностью, превышающей  качество эмпирического оптимального решающего правила отличается от истинно оптимально решающего правила не более чем на величину .
В следующей таблице представлен некоторый итог наших рассуждений.

	Малая емкость класса решающих функций (бедный)	Большая емкость класса решающих функций (богатый)		Близость эмпирического решающего правила к оптимальному решающему правилу	Хорошая	Плохая		Качество разделения (минимизация ошибки)	Низкое	Высокое		 
 Таким образом, необходимо минимизировать степени свободы.
Случай класса линейных решающих функций 
Пусть  - линейная решающая функция,  - размерность пространства.
Как уже отмечалось выше, имеем  дихотомий, где  - длина выборки. Хотим выяснить, какое количество дихотомий реализуется с помощью гиперплоскостей?
Максимальное число точек в пространстве размерности , которое с помощью гиперплоскостей можно разбить всеми возможными способами на два класса есть . Если ,
то линейный риск будет равномерно сходиться к среднему риску. Емкость класса конечна и равна .




7



(

(

(

Рис.1. Распределение векторов признаков прецедентах класса  A  (кружки) и класса  B  (крестики). Признаки - средние значения и средние отклонения яркости в образах. Прямая линия разделяет вектора из разных классов. 

Сенсор (измеритель)

Генерация признаков

Селекция признаков

Построение классифи-катора

Оценка системы

Образы

Рис.2. Основные элементы построения системы распознавания образов (классификации) 

Рис.3. Изображение различных типов поверхности и кластеризация соответствующих векторов признаков.

 
 
            

x1

x2



