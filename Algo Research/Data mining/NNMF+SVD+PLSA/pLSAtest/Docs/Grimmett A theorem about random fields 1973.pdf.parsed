
A THEOREM ABOUT RANDOM FIELDS G. R. GRIMMETT 1. Introduction Averintsev [1] and Spitzer [2] proved that the class of Markov fields is identical to the class of Gibbs ensembles when the domain is a finite subset of the cubic lattice and each site may be in either of two given states. Hammersley and Clifford [3] proved the same result for the more general case when the domain is the set of sites of an arbitrary finite graph and the number of possible states for each site is finite. In order to show this, they extended the notion of a Gibbs ensemble to embrace more complex interactions than occur on the cubic lattice. Their method was circuitous and showed merely the existence of a potential function for a Markov field with little indication of its form. In [4], Preston gives a more direct approach to the two-state problem and presents an explicit formula for the potential. We show here that the equivalence of Markov fields and Gibbs ensembles follows immediately from a very simple application of the Mobius inversion theorem of [5] which allows us to construct a natural expression for the potential function of a Markov field. We confine our attention to the set of sites of an arbitrary finite graph and allow each site to be in any one of a countable set of states. The two-state solution of Preston emerges as a corollary. 2. Preliminaries Let A be the set of sites (= vertices) of a given arbitrary finite undirected graph G which we suppose has no loops or multiple bonds (= edges). Two sites are called neighbours if they are joined by a bond of G. Capital letters are used to denote subsets of A, while lower case letters represent single sites. We write A + B for the union of A and B, and A-B for their difference. For ease of notation we identify the site x with the set {x} which consists of that site only. A set K of sites is a clique if either K contains only a single site or any two sites in K are neighbours. We proceed to colour the sites of A. If JC is any site of A, we suppose that there is a nonempty countable collection Qx of colours available for colouring x. For each site x, we pick a reference colour from Clx and call this colour black. This procedure is unambiguous since we may independently rename the colours at each individual site. The colours available at different sites need not be the same. We write Q = ILeA^* f'r t n e s e t 'f a^ colourings of A, and & for the collection of all subsets of Q. For each to e Q, we denote by L(co) the set of sites of A which are not coloured black by co. The subset Q' £ Cl is the set of colourings of A which blacken every site of A except the sites of a clique. That is, Q' = {coeQ: L(co) is a clique}. Received 7 October, 1972. [BULL. LONDON MATH. SOC, 5 (1973), 81-84]
82 G. R. GRIMMETT For each coed and A £ A, the expression coA represents the colouring of A which is the same as co at each site in A and is black elsewhere. This notation should not be confused with that used in [3]. The colouring which blackens all the sites of A is denoted by /?. Thus co = ct)L(eo) and /? = co0, where $ is the empty set. 3. Random fields If P is a probability measure on (Q, &), then the triple (Cl, &, P) is called a random field on the domain A. We identify the measure P with its density P(co)(coeCi). We are concerned with two classes of random field on A. The random field (Q, &, P) is a Markov field if it satisfies the following two conditions: (1) P(co)>0, foralloeQ, (2) for any co e Q, A £ A and pair x, y of non-neighbouring sites such that x$A and ye A, P(co(A + x)) P(co(A-y+x)) P((oA) + P(o)(A+x))~ P(co(A-y)) + P((o(A-y + x)) ' Condition (2) is the nearest neighbour condition and requires elucidation. It postulates that the random colour of the site x, given the colours of every other site, depends only upon the colours of the neighbours of x. That is, there is no interaction between two given sites unless they are neighbours. Dobrushin [6] defines a (two-State) Markov field by a cumbersome expression which is clearly equivalent to (2) in the case when exactly two colours are available at each and every site. The conditions (1) and (2) are the same as (6.1) and (7.1) in [3]. The random field (fi, ^, P) is a Gibbs ensemble if there exists a potential function V : Q' -: U such that V(coK)\, foralleoeO, (3) where the summation is over all cliques contained in L(co), and Z is chosen to make P(co) = 1. (4) THEOREM. The random field (Q, ^, P) is a Gibbs ensemble if and only if it is a Markov field. If (Q, ^, P) is a Markov field, then its potential function is given by V(a>)= 2 (-l)|L(ft))-^'logP(ft)X), for all coed', (5) ASL(OJ) where the summation is over all subsets of the clique L(co). Proof of the theorem. For simplicity of notation in the proof, we always use the letter K to represent a typical clique. Thus Y.KZA s u m s over all cliques contained in A, while ZASK s u m s o v e r a^ subsets of the clique K.
A THEOREM ABOUT RANDOM FIELDS 83 Suppose first that (Q, ^, P) is a Markov field, and that V : Q -> U is defined by V(oS) = Z (-1)|L(W)-B| log P(coB), for all coe Q. (6) B£L(w) Let co e Q and A s L(co). Then, by (6), M B | £ ) . (7) We claim that V(coA) = 0 unless A is a clique. For, suppose A contains two sites x, y which are not neighbours. Then, by (7), V(coA) = Z (-l)^-B|logP(<"£)+ Z (-B^A B^A x,y e B Z BSA x,y$B P(co(B + x)) S \ P(co(B+y)) I P(coB) = 0, (8) by the condition (2). The set of subsets of L(co) is partially ordered by inclusion, and its Mobius function fi is given by H(B, A) = ( -1)M~B|, for all A, B c L(o>) such that B ^ A. (9) We write (7) in the form V(coA)= Z KB, A) log P(coB), for all ^ £ L(co), (10) B=A which yields logP(co,4)= Z V(coB), foralMsL(a)), (11) B^A by the Mobius inversion theorem of [5]. Hence, by (8), P(co) = P(P) exp ( Z ^(0)^)), for alia) 6 fi, (12) \KEL(co) /since, by (7), (13) Thus (n, J5", P) is a Gibbs ensemble with potential function given by (5). It is easy to show that this is the unique potential function. Now suppose that (Q, 3?, P) is a Gibbs ensemble with potential function V. Clearly P(co) > 0, for all co e Q. (14) Let co e Q, and let 4 £ A and x, y be a pair of non-neighbouring sites such that x^^4 and y eA It is sufficient to show that (2) holds if A+x £ L(co) (since if x$L(co) then co(^ + x) = &>A, and if zeA + x-L(co) then co(A+x) = co(i4-z+x)
84 A THEOREM ABOUT RANDOM FIELDS and coA = co(A-z)). Then, by (3), A)= £ V(wK)-£ V(coK) = I V(coK) KSA+x xeK = £ V(coK) K £A-y+x xeK = £ V(coK)-£ V(coK) K^A-y + x KSA-y = log P((o(A-y + xj)-\og P(co(A-y)), (15) and we deduce by (2) that (Q, "^", P) is a Markov field. Averintsev, Spitzer and Preston were concerned with the special case of this theorem when only two colours are available at each site of A. We call these colours black and white. In this instance, there is a 1 - 1 correspondence between Q and the set {0,1}A of all subsets of A (associate coeCl with the set L(co) of sites of A which are coloured white by co). If (Q, .F, P) is a random field on A, we may think of P as a probability measure on {0,1}A and P(A) as the probability of the colouring whose white sites are exactly the sites in A. By the above theorem, if (Q, $Fy P) is a Markov field, then its Gibbsian potential function is given by V(K)= £ ( -l ^ -^ ' l o g P ^ ) , for all cliques K, (16) AK where the summation is over all subsets of the clique K. I am grateful to Dr. D. J. A. Welsh for his suggestions. We have just heard of a paper by Besag [7] which contains a result which is very similar to that of Spitzer [2]. References 1. M. B. Averintsev, " On a method of describing complete parameter fields ", Problemy Peredaci Infonnatsii, 6 (1970), 100-109. 2. F. Spitzer, " Markov random fields and Gibbs ensembles ", Amer. Math. Monthly, 78 (1971), 142-154. 3. J. M. Hammersley and P. Clifford, " Markov fields on finite graphs and lattices " (1971), unpublished. 4. C. J. Preston, " Generalized Gibbs states and Markov random fields ", /. App. Prob., to appear. 5. G. C. Rota, " On the foundations of combinatorial theory, I. Theory of Mobius functions ", Z'tschr. WahrscK theorie & verw. Geb., 2 (1964), 340-368. 6. R. L. Dobrushin, " The description of a random field by means of its conditional probabilities, and conditions of its regularity", Th. Prob. & Appl. (English translation of Teoriia Veroiatn.) 13 (1968), 197-224. 7. J. E. Besag, " Nearest-neighbour systems and the auto-logistic model for binary data ", /. Roy., Stat. Soc. (B), 34 (1972), 75-83. Merton College, Oxford.